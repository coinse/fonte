{"sha": "85eeb5d9ae5a2f0c14fd694a61c6e8d88f37815c", "log": "partial impl of [Issue#39]", "commit": "\n--- a/src/main/java/com/fasterxml/jackson/dataformat/xml/ser/ToXmlGenerator.java\n+++ b/src/main/java/com/fasterxml/jackson/dataformat/xml/ser/ToXmlGenerator.java\n      */\n \n     final protected XMLStreamWriter2 _xmlWriter;\n+\n+    final protected XMLStreamWriter _originalXmlWriter;\n+    \n+    /**\n+     * Marker flag set if the underlying stream writer has to emulate\n+     * Stax2 API: this is problematic if trying to use {@link #writeRaw} calls.\n+     */\n+    final protected boolean _stax2Emulation;\n     \n     final protected IOContext _ioContext;\n \n         super(genericGeneratorFeatures, codec);\n         _xmlFeatures = xmlFeatures;\n         _ioContext = ctxt;\n+        _originalXmlWriter = sw;\n         _xmlWriter = Stax2WriterAdapter.wrapIfNecessary(sw);\n+        _stax2Emulation = (_xmlWriter != sw);\n         _xmlPrettyPrinter = (_cfgPrettyPrinter instanceof XmlPrettyPrinter) ?\n         \t\t(XmlPrettyPrinter) _cfgPrettyPrinter : null;\n     }\n     @Override\n     public void writeRaw(String text) throws IOException, JsonGenerationException\n     {\n+        // [Issue#39]\n+        if (_stax2Emulation) {\n+            _reportUnimplementedStax2(\"writeRaw\");\n+        }\n         try {\n             _xmlWriter.writeRaw(text);\n         } catch (XMLStreamException e) {\n     @Override\n     public void writeRaw(String text, int offset, int len) throws IOException, JsonGenerationException\n     {\n+        // [Issue#39]\n+        if (_stax2Emulation) {\n+            _reportUnimplementedStax2(\"writeRaw\");\n+        }\n         try {\n             _xmlWriter.writeRaw(text, offset, len);\n         } catch (XMLStreamException e) {\n     @Override\n     public void writeRaw(char[] text, int offset, int len) throws IOException, JsonGenerationException\n     {\n+        // [Issue#39]\n+        if (_stax2Emulation) {\n+            _reportUnimplementedStax2(\"writeRaw\");\n+        }\n         try {\n             _xmlWriter.writeRaw(text, offset, len);\n         } catch (XMLStreamException e) {\n     {\n         throw new IllegalStateException(\"No element/attribute name specified when trying to output element\");\n     }\n+\n+    /**\n+     * Method called \n+     */\n+    protected void  _reportUnimplementedStax2(String missingMethod) throws IOException\n+    {\n+        throw new JsonGenerationException(\"Underlying Stax XMLStreamWriter (of type \"\n+                +_originalXmlWriter.getClass().getName()\n+                +\") does not implement Stax2 API natively and is missing method '\"\n+                +missingMethod+\"': this breaks functionality such as indentation that relies on it. \"\n+                +\"You need to upgrade to using compliant Stax implementation like Woodstox or Aalto\");\n+    }\n }", "timestamp": 1352413020, "metainfo": ""}