{"sha": "fc008096cfeff9b5fe3836d5ad1ca962aa28e189", "log": ".. and then fix for that one failing test. So, passing, although not necessarily fool-proof", "commit": "\n--- a/src/main/java/com/fasterxml/jackson/dataformat/xml/deser/FromXmlParser.java\n+++ b/src/main/java/com/fasterxml/jackson/dataformat/xml/deser/FromXmlParser.java\n         while (token == XmlTokenStream.XML_START_ELEMENT) {\n             // If we thought we might get leaf, no such luck\n             if (_mayBeLeaf) {\n-//System.out.println(\"In mayBeLeaf (array? \"+_parsingContext.inArray()+\"): add START_OBJECT (\"+_xmlTokens.getLocalName()+\"), append FIELD_NAME\");\n                 // leave _mayBeLeaf set, as we start a new context\n                 _nextToken = JsonToken.FIELD_NAME;\n                 _parsingContext = _parsingContext.createChildObjectContext(-1, -1);\n                 return (_currToken = JsonToken.START_OBJECT);\n             }\n             if (_parsingContext.inArray()) {\n-//System.out.println(\"In ARRAY: skip field '\"+_xmlTokens.getLocalName());\n                 /* Yup: in array, so this element could be verified; but it won't be reported\n                  * anyway, and we need to process following event.\n                  */\n--- a/src/main/java/com/fasterxml/jackson/dataformat/xml/deser/XmlTokenStream.java\n+++ b/src/main/java/com/fasterxml/jackson/dataformat/xml/deser/XmlTokenStream.java\n //System.out.println(\"handleRepeat for END_ELEMENT: \"+_localName+\" (\"+_xmlReader.getLocalName()+\")\");\n             _localName = _xmlReader.getLocalName();\n             _namespaceURI = _xmlReader.getNamespaceURI();\n+            if (_currentWrapper != null) {\n+                _currentWrapper = _currentWrapper.getParent();\n+            }\n             return XML_END_ELEMENT;\n         }\n         if (type == REPLAY_START_DELAYED) {\n                 _repeatElement = REPLAY_END;\n                 _localName = w.getWrapperLocalName();\n                 _namespaceURI = w.getWrapperNamespace();\n-//System.out.println(\" requestRepeat of END_ELEMENT '\"+_localName);\n+                _currentWrapper = _currentWrapper.getParent();\n+//System.out.println(\" IMPLICIT requestRepeat of END_ELEMENT '\"+_localName);\n             } else {\n                 _currentWrapper = _currentWrapper.getParent();\n             }\n--- a/src/test/java/com/fasterxml/jackson/dataformat/xml/unwrapped/TestNestedUnwrappedLists.java\n+++ b/src/test/java/com/fasterxml/jackson/dataformat/xml/unwrapped/TestNestedUnwrappedLists.java\n         assertEquals(2, svc.vehicleMonitoringDelivery.size());\n         VehicleMonitoringDelivery del = svc.vehicleMonitoringDelivery.get(1);\n         assertNotNull(del);\n-        assertNull(del.vehicleActivity);\n+        assertNotNull(del.vehicleActivity);\n+        assertEquals(1, del.vehicleActivity.size());\n+        assertEquals(\"2012-09-12T09:28:07.536-04:00\", del.vehicleActivity.get(0).recordedAtTime);\n     }\n }", "timestamp": 1347914376, "metainfo": ""}