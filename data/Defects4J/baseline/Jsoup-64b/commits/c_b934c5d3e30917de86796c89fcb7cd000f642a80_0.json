{"sha": "b934c5d3e30917de86796c89fcb7cd000f642a80", "log": "Make sure unkown tags close correctly when in insensitive case mode  Fixes #819", "commit": "\n--- a/src/main/java/org/jsoup/parser/HtmlTreeBuilderState.java\n+++ b/src/main/java/org/jsoup/parser/HtmlTreeBuilderState.java\n         }\n \n         boolean anyOtherEndTag(Token t, HtmlTreeBuilder tb) {\n-            String name = t.asEndTag().normalName();\n+            String name = t.asEndTag().name(); // matches with case sensitivity if enabled\n             ArrayList<Element> stack = tb.getStack();\n             for (int pos = stack.size() -1; pos >= 0; pos--) {\n                 Element node = stack.get(pos);\n--- a/src/test/java/org/jsoup/parser/HtmlParserTest.java\n+++ b/src/test/java/org/jsoup/parser/HtmlParserTest.java\n         Document doc = Jsoup.parse(\"<p><a \\06=foo>One</a><a/\\06=bar><a foo\\06=bar>Two</a></p>\");\n         assertEquals(\"<p><a>One</a><a></a><a foo=\\\"bar\\\">Two</a></p>\", doc.body().html());\n     }\n+\n+    @Test public void caseSensitiveParseTree() {\n+        String html = \"<r><X>A</X><y>B</y></r>\";\n+        Parser parser = Parser.htmlParser();\n+        parser.settings(ParseSettings.preserveCase);\n+        Document doc = parser.parseInput(html, \"\");\n+        assertEquals(\"<r> <X> A </X> <y> B </y> </r>\", StringUtil.normaliseWhitespace(doc.body().html()));\n+\n+    }\n }", "timestamp": 1497135105, "metainfo": ""}