{"sha": "ea2d74fab79f1ba140918d4efb6d728fc021a319", "log": "Add a unit test wrt #382", "commit": "\n--- a/src/test/java/com/fasterxml/jackson/databind/deser/TestCyclicTypes.java\n+++ b/src/test/java/com/fasterxml/jackson/databind/deser/TestCyclicTypes.java\n package com.fasterxml.jackson.databind.deser;\n \n+import com.fasterxml.jackson.annotation.JsonIgnoreProperties;\n import com.fasterxml.jackson.databind.*;\n \n /**\n     static class StringLink extends GenericLink<String> {\n     }\n \n+    static class Selfie382 {\n+        public int id;\n+\n+        @JsonIgnoreProperties({ \"parent\", \"ignoredRef\" })\n+        public Selfie382 parent;\n+        \n+        public Selfie382(int id) { this.id = id; }\n+    }\n+    \n     /*\n     /**********************************************************\n     /* Unit tests\n     /**********************************************************\n      */\n \n+    private final ObjectMapper MAPPER = objectMapper();\n+    \n     public void testLinked() throws Exception\n     {\n-        Bean first = new ObjectMapper().readValue\n+        Bean first = MAPPER.readValue\n             (\"{\\\"name\\\":\\\"first\\\", \\\"next\\\": { \"\n              +\" \\\"name\\\":\\\"last\\\", \\\"next\\\" : null }}\",\n              Bean.class);\n \n     public void testLinkedGeneric() throws Exception\n     {\n-        StringLink link = new ObjectMapper().readValue\n-            (\"{\\\"next\\\":null}\", StringLink.class);\n+        StringLink link = MAPPER.readValue(\"{\\\"next\\\":null}\", StringLink.class);\n         assertNotNull(link);\n         assertNull(link.next);\n     }\n \n     public void testCycleWith2Classes() throws Exception\n     {\n-        LinkA a = new ObjectMapper().readValue(\"{\\\"next\\\":{\\\"a\\\":null}}\", LinkA.class);\n+        LinkA a = MAPPER.readValue(\"{\\\"next\\\":{\\\"a\\\":null}}\", LinkA.class);\n         assertNotNull(a.next);\n         LinkB b = a.next;\n         assertNull(b.a);\n     }\n+\n+    // [Issue#382]: Should be possible to ignore cyclic ref\n+    public void testIgnoredCycle() throws Exception\n+    {\n+        Selfie382 self1 = new Selfie382(1);\n+        Selfie382 self2 = new Selfie382(2);\n+        self1.parent = self2;\n+        self2.parent = self1;\n+        String json = MAPPER.writeValueAsString(self1);\n+        assertNotNull(json);\n+        assertEquals(aposToQuotes(\"{'id':1,'parent':{'id':2}}\"), json);\n+    }\n+\n }", "timestamp": 1392336944, "metainfo": ""}