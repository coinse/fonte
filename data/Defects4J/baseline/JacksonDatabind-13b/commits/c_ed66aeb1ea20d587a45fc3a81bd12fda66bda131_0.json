{"sha": "ed66aeb1ea20d587a45fc3a81bd12fda66bda131", "log": "deser test for #631", "commit": "\n--- a/src/test/java/com/fasterxml/jackson/databind/deser/TestCustomDeserializers.java\n+++ b/src/test/java/com/fasterxml/jackson/databind/deser/TestCustomDeserializers.java\n import com.fasterxml.jackson.annotation.JsonProperty;\n import com.fasterxml.jackson.core.*;\n import com.fasterxml.jackson.databind.*;\n-import com.fasterxml.jackson.databind.annotation.JsonDeserialize;\n-import com.fasterxml.jackson.databind.annotation.JsonSerialize;\n-import com.fasterxml.jackson.databind.deser.std.StdDelegatingDeserializer;\n-import com.fasterxml.jackson.databind.deser.std.StdDeserializer;\n-import com.fasterxml.jackson.databind.deser.std.StdNodeBasedDeserializer;\n+import com.fasterxml.jackson.databind.annotation.*;\n+import com.fasterxml.jackson.databind.deser.std.*;\n import com.fasterxml.jackson.databind.module.SimpleModule;\n import com.fasterxml.jackson.databind.util.StdConverter;\n \n         }\n         \n     }\n-    \n+\n+    // for [databind#631]\n+    static class Issue631Bean\n+    {\n+        @JsonDeserialize(using=ParentClassDeserializer.class)\n+        public Object prop;\n+    }\n+    \n+    static class ParentClassDeserializer\n+        extends StdScalarDeserializer<Object>\n+    {\n+        protected ParentClassDeserializer() {\n+            super(Object.class);\n+        }\n+\n+        @Override\n+        public Object deserialize(JsonParser p, DeserializationContext ctxt)\n+                throws IOException {\n+            Object parent = p.getCurrentValue();\n+            String desc = (parent == null) ? \"NULL\" : parent.getClass().getSimpleName();\n+            return \"prop/\"+ desc;\n+        }\n+    }\n+\n     /*\n     /**********************************************************\n     /* Unit tests\n         assertNotNull(w.value.inner);\n         assertEquals(-13, w.value.inner.x);\n     }\n+\n+    // [#631]: \"current value\" access\n+    public void testCurrentValueAccess() throws Exception\n+    {\n+        Issue631Bean bean = MAPPER.readValue(aposToQuotes(\"{'prop':'stuff'}\"),\n+                Issue631Bean.class);\n+        assertNotNull(bean);\n+        assertEquals(\"prop/Issue631Bean\", bean.prop);\n+    }\n }", "timestamp": 1417230136, "metainfo": ""}