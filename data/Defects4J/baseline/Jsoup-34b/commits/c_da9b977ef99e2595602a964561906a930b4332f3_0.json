{"sha": "da9b977ef99e2595602a964561906a930b4332f3", "log": "Support node.outerHtml() method when node has no parent.  Fixes #45", "commit": "\n--- a/src/main/java/org/jsoup/nodes/Node.java\n+++ b/src/main/java/org/jsoup/nodes/Node.java\n     }\n \n     protected void outerHtml(StringBuilder accum) {\n-        new NodeTraversor(new OuterHtmlVisitor(accum, ownerDocument().outputSettings())).traverse(this);\n+        new NodeTraversor(new OuterHtmlVisitor(accum, getOutputSettings())).traverse(this);\n+    }\n+\n+    // if this node has no document (or parent), retrieve the default output settings\n+    private Document.OutputSettings getOutputSettings() {\n+        return ownerDocument() != null ? ownerDocument().outputSettings() : (new Document(\"\")).outputSettings();\n     }\n \n     /**\n--- a/src/test/java/org/jsoup/nodes/ElementTest.java\n+++ b/src/test/java/org/jsoup/nodes/ElementTest.java\n \n     }\n \n+    @Test public void parentlessToString() {\n+        Document doc = Jsoup.parse(\"<img src='foo'>\");\n+        Element img = doc.select(\"img\").first();\n+        assertEquals(\"\\n<img src=\\\"foo\\\" />\", img.toString());\n+\n+        img.remove(); // lost its parent\n+        assertEquals(\"<img src=\\\"foo\\\" />\", img.toString());\n+    }\n+\n \n }", "timestamp": 1309605122, "metainfo": ""}