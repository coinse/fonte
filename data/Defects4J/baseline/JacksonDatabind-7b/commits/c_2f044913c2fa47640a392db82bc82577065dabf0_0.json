{"sha": "2f044913c2fa47640a392db82bc82577065dabf0", "log": "Fixed #337", "commit": "\n--- a/src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java\n+++ b/src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerFactory.java\n          * be done at a later point.\n          */\n         JsonDeserializer<Object> deser = findDeserializerFromAnnotation(ctxt, setter);\n-        if (deser != null) {\n-            return new SettableAnyProperty(property, setter, type, deser);\n-        }\n         /* Otherwise, method may specify more specific (sub-)class for\n          * value (no need to check if explicit deser was specified):\n          */\n         type = modifyTypeByAnnotation(ctxt, setter, type);\n-        return new SettableAnyProperty(property, setter, type, null);\n+        TypeDeserializer typeDeser = type.getTypeHandler();\n+        return new SettableAnyProperty(property, setter, type,\n+                deser, typeDeser);\n     }\n \n     /**\n--- a/src/main/java/com/fasterxml/jackson/databind/deser/SettableAnyProperty.java\n+++ b/src/main/java/com/fasterxml/jackson/databind/deser/SettableAnyProperty.java\n import com.fasterxml.jackson.core.*;\n import com.fasterxml.jackson.databind.*;\n import com.fasterxml.jackson.databind.introspect.AnnotatedMethod;\n+import com.fasterxml.jackson.databind.jsontype.TypeDeserializer;\n \n /**\n  * Class that represents a \"wildcard\" set method which can be used\n \n     protected JsonDeserializer<Object> _valueDeserializer;\n \n+    protected final TypeDeserializer _valueTypeDeserializer;\n+    \n     /*\n     /**********************************************************\n     /* Life-cycle\n     /**********************************************************\n      */\n \n+    @Deprecated // since 2.3\n     public SettableAnyProperty(BeanProperty property, AnnotatedMethod setter, JavaType type,\n             JsonDeserializer<Object> valueDeser) {\n-        this(property, setter.getAnnotated(), type, valueDeser);\n+        this(property, setter, type, valueDeser, null);\n     }\n \n+    public SettableAnyProperty(BeanProperty property, AnnotatedMethod setter, JavaType type,\n+            JsonDeserializer<Object> valueDeser, TypeDeserializer typeDeser)\n+    {\n+        this(property, setter.getAnnotated(), type, valueDeser, typeDeser);\n+    }\n+    \n+    @Deprecated // since 2.3\n     public SettableAnyProperty(BeanProperty property, Method rawSetter, JavaType type,\n             JsonDeserializer<Object> valueDeser) {\n+        this(property, rawSetter, type, valueDeser, null);\n+    }\n+    \n+    public SettableAnyProperty(BeanProperty property, Method rawSetter, JavaType type,\n+            JsonDeserializer<Object> valueDeser, TypeDeserializer typeDeser)\n+    {\n         _property = property;\n         _type = type;\n         _setter = rawSetter;\n         _valueDeserializer = valueDeser;\n+        _valueTypeDeserializer = typeDeser;\n     }\n \n     public SettableAnyProperty withValueDeserializer(JsonDeserializer<Object> deser) {\n-        return new SettableAnyProperty(_property, _setter, _type, deser);\n+        return new SettableAnyProperty(_property, _setter, _type,\n+                deser, _valueTypeDeserializer);\n     }\n     \n     /*\n         JsonToken t = jp.getCurrentToken();\n         if (t == JsonToken.VALUE_NULL) {\n             return null;\n+        }\n+        if (_valueTypeDeserializer != null) {\n+            return _valueDeserializer.deserializeWithType(jp, ctxt, _valueTypeDeserializer);\n         }\n         return _valueDeserializer.deserialize(jp, ctxt);\n     }", "timestamp": 1383447923, "metainfo": ""}