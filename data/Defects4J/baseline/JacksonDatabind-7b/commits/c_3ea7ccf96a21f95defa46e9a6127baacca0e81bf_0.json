{"sha": "3ea7ccf96a21f95defa46e9a6127baacca0e81bf", "log": "Add a (failing) test for #222", "commit": "\n--- a/src/test/java/com/fasterxml/jackson/databind/jsontype/TestExternalId.java\n+++ b/src/test/java/com/fasterxml/jackson/databind/jsontype/TestExternalId.java\n package com.fasterxml.jackson.databind.jsontype;\n \n-import java.util.Date;\n+import java.util.*;\n \n import com.fasterxml.jackson.annotation.*;\n import com.fasterxml.jackson.annotation.JsonTypeInfo.As;\n             return new Date(rawDate);\n         }\n     }\n-    \n+\n     /*\n     /**********************************************************\n     /* Unit tests, serialization\n--- a/src/test/java/com/fasterxml/jackson/failing/TestExternalTypeId.java\n+++ b/src/test/java/com/fasterxml/jackson/failing/TestExternalTypeId.java\n         final String s_date = mapper.writeValueAsString(_date);\n         final String s_integer = mapper.writeValueAsString(_integer);\n \n-System.err.println(\"Int -> \"+s_integer);   \n+//System.err.println(\"Int -> \"+s_integer);   \n     \n         final String s_boolean = mapper.writeValueAsString(_boolean);\n         final String s_long = mapper.writeValueAsString(_long);\n             this.p = p;\n         }\n     }\n+\n+    // [Issue#222]\n+    static class Issue222Bean\n+    {\n+        @JsonTypeInfo(use = JsonTypeInfo.Id.NAME,\n+                property = \"type\",\n+                include = JsonTypeInfo.As.EXTERNAL_PROPERTY)\n+        public Issue222BeanB value;\n+\n+        public String type = \"foo\";\n+        \n+        public Issue222Bean() { }\n+        public Issue222Bean(int v) {\n+            value = new Issue222BeanB(v);\n+        }\n+    }\n+\n+    static class Issue222BeanB\n+    {\n+        public int x;\n+        \n+        public Issue222BeanB() { }\n+        public Issue222BeanB(int value) { x = value; }\n+    }\n+\n+    public void testIssue222() throws Exception\n+    {\n+        final ObjectMapper mapper = new ObjectMapper();\n+        Issue222Bean input = new Issue222Bean(13);\n+        String json = mapper.writeValueAsString(input);\n+        assertEquals(\"{\\\"value\\\":{\\\"x\\\":13},\\\"type\\\":\\\"foo\\\"}\", json);\n+    }\n+    \n+\n }", "timestamp": 1368851958, "metainfo": ""}