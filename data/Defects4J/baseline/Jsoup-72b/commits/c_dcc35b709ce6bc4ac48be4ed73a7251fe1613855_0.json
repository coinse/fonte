{"sha": "dcc35b709ce6bc4ac48be4ed73a7251fe1613855", "log": "Autoenable 'updateMetaCharset' on charset update.", "commit": "\n--- a/src/main/java/org/jsoup/nodes/Document.java\n+++ b/src/main/java/org/jsoup/nodes/Document.java\n      * OutputSettings.charset(Charset)} but in addition it updates the\n      * charset / encoding element within the document.\n      * \n-     * <p>This only applies if {@link #updateMetaCharset(boolean)\n-     * updateMetaCharset} set to <tt>true</tt>; otherwise there are no elements\n-     * changed and the new value is delegated to\n-     * {@link OutputSettings#charset(java.nio.charset.Charset) \n-     * OutputSettings.charset(Charset)} only.</p>\n+     * <p>This enables\n+     * {@link #updateMetaCharset(boolean) meta charset update}.</p>\n      * \n      * <p>If there's no element with charset / encoding information yet it will\n      * be created. Obsolete charset / encoding definitions are removed!</p>\n      * @see OutputSettings#charset(java.nio.charset.Charset) \n      */\n     public void charset(Charset charset) {\n+        updateMetaCharset(true);\n         outputSettings.charset(charset);\n         ensureMetaCharset();\n     }\n--- a/src/test/java/org/jsoup/nodes/DocumentTest.java\n+++ b/src/test/java/org/jsoup/nodes/DocumentTest.java\n import org.jsoup.TextUtil;\n import org.jsoup.integration.ParseTest;\n import org.jsoup.nodes.Document.OutputSettings.Syntax;\n-import static org.junit.Assert.assertEquals;\n-import static org.junit.Assert.assertFalse;\n-import static org.junit.Assert.assertNotNull;\n-import static org.junit.Assert.assertNull;\n+import static org.junit.Assert.*;\n import org.junit.Ignore;\n import org.junit.Test;\n \n     }\n     \n     @Test\n-    public void testMetaCharsetUpdateDisabledNoChangesAfterUpdate() {\n+    public void testMetaCharsetUpdateEnabledAfterCharsetChange() {\n         final Document doc = createHtmlDocument(\"dontTouch\");\n         doc.charset(Charset.forName(charsetUtf8));\n         \n         Element selectedElement = doc.select(\"meta[charset]\").first();\n-        assertEquals(\"dontTouch\", selectedElement.attr(\"charset\"));\n-        \n-        selectedElement = doc.select(\"meta[name=charset]\").first();\n-        assertEquals(\"dontTouch\", selectedElement.attr(\"content\"));\n+        assertEquals(charsetUtf8, selectedElement.attr(\"charset\"));\n+        assertTrue(doc.select(\"meta[name=charset]\").isEmpty());\n     }\n             \n     @Test", "timestamp": 1428514144, "metainfo": ""}