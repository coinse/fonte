{"sha": "6fe6c34a888486b417a913deaca517305b76cc71", "log": "Implemented Element.text(string) method, to set the text of an element, and clear out existing html.", "commit": "\n--- a/src/main/java/org/jsoup/nodes/Document.java\n+++ b/src/main/java/org/jsoup/nodes/Document.java\n     public String outerHtml() {\n         return super.html(); // no outer wrapper tag\n     }\n+\n+    @Override\n+    public Element text(String text) {\n+        getBody().text(text); // overridden to not nuke doc structure\n+        return this;\n+    }\n }\n \n--- a/src/main/java/org/jsoup/nodes/Element.java\n+++ b/src/main/java/org/jsoup/nodes/Element.java\n         return sb.toString();\n     }\n \n+    public Element text(String text) {\n+        Validate.notNull(text);\n+\n+        childNodes.clear();\n+        elementChildren.clear();\n+        TextNode textNode = new TextNode(text);\n+        addChild(textNode);\n+\n+        return this;\n+    }\n+\n     public String data() {\n         StringBuilder sb = new StringBuilder();\n \n--- /dev/null\n+++ b/src/test/java/org/jsoup/nodes/DocumentTest.java\n+package org.jsoup.nodes;\n+\n+import org.jsoup.Jsoup;\n+import org.junit.Test;\n+\n+import static org.junit.Assert.*;\n+\n+/**\n+ Tests for Document.\n+\n+ @author Jonathan Hedley, jonathan@hedley.net */\n+public class DocumentTest {\n+    @Test public void setTextPreservesDocumentStructure() {\n+        Document doc = Jsoup.parse(\"<p>Hello</p>\");\n+        doc.text(\"Replaced\");\n+        assertEquals(\"Replaced\", doc.text());\n+        assertEquals(\"Replaced\", doc.getBody().text());\n+        assertEquals(1, doc.select(\"head\").size());\n+    }\n+}\n--- a/src/test/java/org/jsoup/nodes/ElementTest.java\n+++ b/src/test/java/org/jsoup/nodes/ElementTest.java\n         assertEquals(\"<p>Hello</p>\", doc.getElementsByTag(\"div\").get(0).html());\n     }\n \n+    @Test public void testSetText() {\n+        String h = \"<div id=1>Hello <p>there <b>now</b></p></div>\";\n+        Document doc = Jsoup.parse(h);\n+        assertEquals(\"Hello  there now\", doc.text()); // need to sort out node whitespace\n+        assertEquals(\"there now\", doc.select(\"p\").get(0).text());\n+\n+        Element div = doc.getElementById(\"1\").text(\"Gone\");\n+        assertEquals(\"Gone\", div.text());\n+        assertEquals(0, doc.select(\"p\").size());\n+    }\n+\n \n }", "timestamp": 1309605102, "metainfo": ""}