{"sha": "157be1f6304108ab64e67cdba10b2ed16c73f497", "log": "Tests for github issue #138", "commit": "\n--- /dev/null\n+++ b/src/test/java/com/fasterxml/jackson/failing/TestObjectIdSerialization.java\n+package com.fasterxml.jackson.failing;\n+\n+import com.fasterxml.jackson.annotation.JsonIdentityInfo;\n+import com.fasterxml.jackson.annotation.JsonIdentityReference;\n+import com.fasterxml.jackson.annotation.ObjectIdGenerators;\n+import com.fasterxml.jackson.databind.BaseMapTest;\n+import com.fasterxml.jackson.databind.ObjectMapper;\n+import java.util.LinkedHashSet;\n+import java.util.Set;\n+\n+/**\n+ * Tests for github ussues #138\n+ * https://github.com/FasterXML/jackson-databind/issues/138\n+ */\n+public class TestObjectIdSerialization extends BaseMapTest {\n+\n+    @JsonIdentityInfo(generator = ObjectIdGenerators.PropertyGenerator.class, property = \"id\")\n+    static protected class Obj {\n+\n+        public int id;\n+        @JsonIdentityReference(alwaysAsId = true)\n+        public SetContainer objGroup;\n+\n+        public Obj(int id) {\n+            this.id = id;\n+        }\n+    }\n+\n+    @JsonIdentityInfo(generator = ObjectIdGenerators.PropertyGenerator.class, property = \"id\")\n+    static protected class SetContainer {\n+\n+        public int id;\n+        @JsonIdentityReference(alwaysAsId = true)\n+        public Set<Obj> objs = new LinkedHashSet<Obj>();\n+\n+        public SetContainer(int id) {\n+            this.id = id;\n+        }\n+    }\n+\n+    @JsonIdentityInfo(generator = ObjectIdGenerators.PropertyGenerator.class, property = \"id\")\n+    static protected class ArrContainer {\n+\n+        public int id;\n+        @JsonIdentityReference(alwaysAsId = true)\n+        public Obj[] objs;\n+\n+        public ArrContainer(int id) {\n+            this.id = id;\n+        }\n+    }\n+    private final ObjectMapper MAPPER = new ObjectMapper();\n+    private final static String EXP_ARR_SET = \"{\\\"id\\\":4,\\\"objs\\\":[1,7]}\";\n+\n+    public void testArraySerialization() throws Exception {\n+        Obj o = new Obj(1);\n+        Obj o2 = new Obj(7);\n+        ArrContainer oa = new ArrContainer(4);\n+        oa.objs = new Obj[]{o, o2};\n+        String json = MAPPER.writeValueAsString(oa);\n+        assertEquals(EXP_ARR_SET, json);\n+    }\n+\n+    public void testCollectionSerialization() throws Exception {\n+        Obj o = new Obj(1);\n+        Obj o2 = new Obj(7);\n+        SetContainer os = new SetContainer(4);\n+        os.objs.add(o);\n+        os.objs.add(o2);\n+        String json = MAPPER.writeValueAsString(os);\n+        assertEquals(EXP_ARR_SET, json);\n+    }\n+}", "timestamp": 1357803426, "metainfo": ""}