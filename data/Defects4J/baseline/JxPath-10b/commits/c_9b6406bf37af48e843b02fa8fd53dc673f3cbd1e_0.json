{"sha": "9b6406bf37af48e843b02fa8fd53dc673f3cbd1e", "log": "[JXPATH-94] equality test for multi-valued variables does not conform to spec  ", "commit": "\n--- a/src/java/org/apache/commons/jxpath/ri/compiler/CoreOperationCompare.java\n+++ b/src/java/org/apache/commons/jxpath/ri/compiler/CoreOperationCompare.java\n //            (l == null ? \"null\" : l.getClass().getName()) + \" \" +\n //            (r == null ? \"null\" : r.getClass().getName()));\n \n-        if (l instanceof InitialContext || l instanceof SelfContext) {\n+        if (l instanceof InitialContext) {\n+            ((EvalContext) l).reset();\n+        }\n+\n+        if (l instanceof SelfContext) {\n             l = ((EvalContext) l).getSingleNodePointer();\n         }\n \n-        if (r instanceof InitialContext || r instanceof SelfContext) {\n+        if (r instanceof InitialContext) {\n+            ((EvalContext) r).reset();\n+        }\n+\n+        if (r instanceof SelfContext) {\n             r = ((EvalContext) r).getSingleNodePointer();\n         }\n \n--- a/src/test/org/apache/commons/jxpath/ri/compiler/VariableTest.java\n+++ b/src/test/org/apache/commons/jxpath/ri/compiler/VariableTest.java\n         assertXPathValue(context, \"count($a | /document/vendor/location)\", new Double(3));\n         assertXPathValue(context, \"count($a | /list)\", new Double(7)); //$o + list which contains six discrete values (one is duped, wrapped in a Container)\n     }\n+\n+    public void testIterateVariable() throws Exception {\n+        assertXPathValueIterator(context, \"$d\", list(\"a\", \"b\"));\n+        assertXPathValue(context, \"$d = 'a'\", Boolean.TRUE);\n+        assertXPathValue(context, \"$d = 'b'\", Boolean.TRUE);\n+    }\n }", "timestamp": 1184095774, "metainfo": ""}