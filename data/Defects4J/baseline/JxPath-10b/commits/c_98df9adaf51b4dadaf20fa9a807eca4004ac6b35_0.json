{"sha": "98df9adaf51b4dadaf20fa9a807eca4004ac6b35", "log": "Bug report 25609: Child not created when setting attribute   ", "commit": "\n--- a/src/java/org/apache/commons/jxpath/ri/model/beans/NullPropertyPointer.java\n+++ b/src/java/org/apache/commons/jxpath/ri/model/beans/NullPropertyPointer.java\n /*\n- * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//jxpath/src/java/org/apache/commons/jxpath/ri/model/beans/NullPropertyPointer.java,v 1.15 2004/01/23 01:10:21 dmitri Exp $\n- * $Revision: 1.15 $\n- * $Date: 2004/01/23 01:10:21 $\n+ * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//jxpath/src/java/org/apache/commons/jxpath/ri/model/beans/NullPropertyPointer.java,v 1.16 2004/01/24 01:12:02 dmitri Exp $\n+ * $Revision: 1.16 $\n+ * $Date: 2004/01/24 01:12:02 $\n  *\n  * ====================================================================\n  * The Apache Software License, Version 1.1\n \n /**\n  * @author Dmitri Plotnikov\n- * @version $Revision: 1.15 $ $Date: 2004/01/23 01:10:21 $\n+ * @version $Revision: 1.16 $ $Date: 2004/01/24 01:12:02 $\n  */\n public class NullPropertyPointer extends PropertyPointer {\n \n     }\n \n     public NodePointer createPath(JXPathContext context) {\n+        NodePointer newParent = parent.createPath(context);\n         if (isAttribute()) {\n-            return parent.createAttribute(context, getName());\n+            return newParent.createAttribute(context, getName());\n         }\n         else {\n             // Consider these two use cases:\n             // 2. The parent pointer of NullPropertyPointer is a NullPointer.\n             //    When we call createPath, it may return a PropertyOwnerPointer\n             //    or it may return anything else, like a DOMNodePointer.\n-            //    In the former case we need to exactly what we did in use \n+            //    In the former case we need to do exactly what we did in use \n             //    case 1.  In the latter case, we simply request that the \n             //    non-property pointer expand the collection by itself.\n-\n-            NodePointer newParent = parent.createPath(context);\n             if (newParent instanceof PropertyOwnerPointer) {\n                 PropertyOwnerPointer pop = (PropertyOwnerPointer) newParent;\n                 newParent = pop.getPropertyPointer();\n     }\n \n     public NodePointer createPath(JXPathContext context, Object value) {\n+        NodePointer newParent = parent.createPath(context);\n         if (isAttribute()) {\n-            NodePointer pointer = parent.createAttribute(context, getName());\n+            NodePointer pointer = newParent.createAttribute(context, getName());\n             pointer.setValue(value);\n             return pointer;\n         }\n         else {\n-            NodePointer newParent = parent.createPath(context);\n             if (newParent instanceof PropertyOwnerPointer) {\n                 PropertyOwnerPointer pop = (PropertyOwnerPointer) newParent;\n                 newParent = pop.getPropertyPointer();\n--- a/src/test/org/apache/commons/jxpath/ri/model/XMLModelTestCase.java\n+++ b/src/test/org/apache/commons/jxpath/ri/model/XMLModelTestCase.java\n /*\n- * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//jxpath/src/test/org/apache/commons/jxpath/ri/model/XMLModelTestCase.java,v 1.16 2004/01/19 20:44:52 dmitri Exp $\n- * $Revision: 1.16 $\n- * $Date: 2004/01/19 20:44:52 $\n+ * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//jxpath/src/test/org/apache/commons/jxpath/ri/model/XMLModelTestCase.java,v 1.17 2004/01/24 01:12:01 dmitri Exp $\n+ * $Revision: 1.17 $\n+ * $Date: 2004/01/24 01:12:01 $\n  *\n  * ====================================================================\n  * The Apache Software License, Version 1.1\n  * DOM, JDOM etc.\n  *\n  * @author Dmitri Plotnikov\n- * @version $Revision: 1.16 $ $Date: 2004/01/19 20:44:52 $\n+ * @version $Revision: 1.17 $ $Date: 2004/01/24 01:12:01 $\n  */\n \n public abstract class XMLModelTestCase extends JXPathTestCase {\n             \"/vendor[1]/location[1]/@name\",\n             \"local\",\n             \"/vendor[1]/location[1]/@name\");\n+\n+         assertXPathCreatePathAndSetValue(\n+            context,\n+            \"/vendor[1]/location[4]/@manager\",\n+            \"\",\n+            \"/vendor[1]/location[4]/@manager\");   \n     }\n \n     /**\n             \"vendor/location[1]/@manager\",\n             \"John Doe\",\n             \"/vendor[1]/location[1]/@manager\");\n-\n+        \n+        assertXPathCreatePathAndSetValue(\n+            context,\n+            \"/vendor[1]/location[4]/@manager\",\n+            \"James Dow\",\n+            \"/vendor[1]/location[4]/@manager\");\n+        \n         assertXPathCreatePathAndSetValue(\n             context,\n             \"vendor/product/name/attribute::price:language\",\n             \"priceNS:amount\");\n \n         // name (non-qualified)\n-        assertXPathValue(context, \"name(vendor/location)\", \"location\");\n+        assertXPathValue(\n+            context,\n+            \"name(vendor/location)\",\n+            \"location\");\n \n         // namespace-uri (qualified)\n         assertXPathValue(", "timestamp": 1074906722, "metainfo": ""}