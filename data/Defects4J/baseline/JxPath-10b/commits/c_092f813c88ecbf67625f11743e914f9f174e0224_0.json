{"sha": "092f813c88ecbf67625f11743e914f9f174e0224", "log": "Added some testing for pointer.getNode()   ", "commit": "\n--- a/src/test/org/apache/commons/jxpath/JXPathTestCase.java\n+++ b/src/test/org/apache/commons/jxpath/JXPathTestCase.java\n /*\n- * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//jxpath/src/test/org/apache/commons/jxpath/JXPathTestCase.java,v 1.33 2003/10/09 21:31:42 rdonkin Exp $\n- * $Revision: 1.33 $\n- * $Date: 2003/10/09 21:31:42 $\n+ * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//jxpath/src/test/org/apache/commons/jxpath/JXPathTestCase.java,v 1.34 2004/01/24 02:42:22 dmitri Exp $\n+ * $Revision: 1.34 $\n+ * $Date: 2004/01/24 02:42:22 $\n  *\n  * ====================================================================\n  * The Apache Software License, Version 1.1\n  * Abstract superclass for various JXPath tests.\n  *\n  * @author Dmitri Plotnikov\n- * @version $Revision: 1.33 $ $Date: 2003/10/09 21:31:42 $\n+ * @version $Revision: 1.34 $ $Date: 2004/01/24 02:42:22 $\n  */\n \n public abstract class JXPathTestCase extends TestCase {\n             expected,\n             res);\n     }\n-\n+    \n+    protected void assertXPathValueType(\n+            JXPathContext ctx,\n+            String xpath,\n+            Class clazz) \n+    {\n+        ctx.setLenient(false);\n+        Object actual = ctx.getValue(xpath);\n+        assertTrue(\"Evaluating <\" + xpath + \"> = \" + actual.getClass(), \n+                clazz.isAssignableFrom(actual.getClass()));\n+    }\n+    \n+    protected void assertXPathNodeType(\n+            JXPathContext ctx,\n+            String xpath,\n+            Class clazz) \n+    {\n+        ctx.setLenient(false);\n+        Pointer actual = ctx.getPointer(xpath);\n+        assertTrue(\"Evaluating <\" + xpath + \"> = \" + actual.getNode().getClass(), \n+                clazz.isAssignableFrom(actual.getNode().getClass()));\n+    }\n+    \n     protected static List list() {\n         return Collections.EMPTY_LIST;\n     }\n--- a/src/test/org/apache/commons/jxpath/ri/compiler/ExtensionFunctionTest.java\n+++ b/src/test/org/apache/commons/jxpath/ri/compiler/ExtensionFunctionTest.java\n /*\n- * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//jxpath/src/test/org/apache/commons/jxpath/ri/compiler/ExtensionFunctionTest.java,v 1.12 2004/01/24 02:16:51 dmitri Exp $\n- * $Revision: 1.12 $\n- * $Date: 2004/01/24 02:16:51 $\n+ * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//jxpath/src/test/org/apache/commons/jxpath/ri/compiler/ExtensionFunctionTest.java,v 1.13 2004/01/24 02:42:21 dmitri Exp $\n+ * $Revision: 1.13 $\n+ * $Date: 2004/01/24 02:42:21 $\n  *\n  * ====================================================================\n  * The Apache Software License, Version 1.1\n package org.apache.commons.jxpath.ri.compiler;\n \n import java.util.ArrayList;\n+import java.util.Collection;\n import java.util.List;\n import java.util.Locale;\n \n  * Test extension functions.\n  *\n  * @author Dmitri Plotnikov\n- * @version $Revision: 1.12 $ $Date: 2004/01/24 02:16:51 $\n+ * @version $Revision: 1.13 $ $Date: 2004/01/24 02:42:21 $\n  */\n \n public class ExtensionFunctionTest extends JXPathTestCase {\n         List list = new ArrayList();\n         list.add(\"foo\");\n         list.add(\"bar\");\n-        context.getVariables().declareVariable(\"myList\", list); \n-        Object\n-        values = context.getValue(\"test:items($myList)\");\n-        System.err.println(\"Values: \" + values);\n+        context.getVariables().declareVariable(\"list\", list);\n+        Object values = context.getValue(\"test:items($list)\");\n+        assertTrue(\"Return type: \", values instanceof Collection);\n+        assertEquals(\n+            \"Return values: \",\n+            list,\n+            new ArrayList((Collection) values));\n     }\n \n     public void testNodeSetReturn() {\n--- a/src/test/org/apache/commons/jxpath/ri/model/XMLModelTestCase.java\n+++ b/src/test/org/apache/commons/jxpath/ri/model/XMLModelTestCase.java\n /*\n- * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//jxpath/src/test/org/apache/commons/jxpath/ri/model/XMLModelTestCase.java,v 1.17 2004/01/24 01:12:01 dmitri Exp $\n- * $Revision: 1.17 $\n- * $Date: 2004/01/24 01:12:01 $\n+ * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//jxpath/src/test/org/apache/commons/jxpath/ri/model/XMLModelTestCase.java,v 1.18 2004/01/24 02:42:22 dmitri Exp $\n+ * $Revision: 1.18 $\n+ * $Date: 2004/01/24 02:42:22 $\n  *\n  * ====================================================================\n  * The Apache Software License, Version 1.1\n  * DOM, JDOM etc.\n  *\n  * @author Dmitri Plotnikov\n- * @version $Revision: 1.17 $ $Date: 2004/01/24 01:12:01 $\n+ * @version $Revision: 1.18 $ $Date: 2004/01/24 02:42:22 $\n  */\n \n public abstract class XMLModelTestCase extends JXPathTestCase {\n-    private JXPathContext context;\n+    protected JXPathContext context;\n \n     /**\n      * Construct a new instance of this test case.\n--- a/src/test/org/apache/commons/jxpath/ri/model/dom/DOMModelTest.java\n+++ b/src/test/org/apache/commons/jxpath/ri/model/dom/DOMModelTest.java\n /*\n- * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//jxpath/src/test/org/apache/commons/jxpath/ri/model/dom/DOMModelTest.java,v 1.10 2004/01/19 20:44:52 dmitri Exp $\n- * $Revision: 1.10 $\n- * $Date: 2004/01/19 20:44:52 $\n+ * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//jxpath/src/test/org/apache/commons/jxpath/ri/model/dom/DOMModelTest.java,v 1.11 2004/01/24 02:42:22 dmitri Exp $\n+ * $Revision: 1.11 $\n+ * $Date: 2004/01/24 02:42:22 $\n  *\n  * ====================================================================\n  * The Apache Software License, Version 1.1\n import junit.framework.TestSuite;\n \n import org.apache.commons.jxpath.AbstractFactory;\n+import org.apache.commons.jxpath.JXPathContext;\n import org.apache.commons.jxpath.ri.model.XMLModelTestCase;\n import org.apache.commons.jxpath.xml.DocumentContainer;\n+import org.w3c.dom.Attr;\n+import org.w3c.dom.Document;\n import org.w3c.dom.Element;\n import org.w3c.dom.Node;\n import org.w3c.dom.NodeList;\n  * Tests JXPath with DOM\n  *\n  * @author Dmitri Plotnikov\n- * @version $Revision: 1.10 $ $Date: 2004/01/19 20:44:52 $\n+ * @version $Revision: 1.11 $ $Date: 2004/01/24 02:42:22 $\n  */\n \n public class DOMModelTest extends XMLModelTestCase {\n \n     protected AbstractFactory getAbstractFactory() {\n         return new TestDOMFactory();\n+    }\n+    \n+    public void testGetNode() {\n+        assertXPathNodeType(context, \"/\", Document.class);\n+        assertXPathNodeType(context, \"/vendor/location\", Element.class);\n+        assertXPathNodeType(context, \"//location/@name\", Attr.class);\n     }\n     \n     protected String getXMLSignature(\n--- a/src/test/org/apache/commons/jxpath/ri/model/jdom/JDOMModelTest.java\n+++ b/src/test/org/apache/commons/jxpath/ri/model/jdom/JDOMModelTest.java\n /*\n- * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//jxpath/src/test/org/apache/commons/jxpath/ri/model/jdom/JDOMModelTest.java,v 1.10 2004/01/19 20:44:52 dmitri Exp $\n- * $Revision: 1.10 $\n- * $Date: 2004/01/19 20:44:52 $\n+ * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//jxpath/src/test/org/apache/commons/jxpath/ri/model/jdom/JDOMModelTest.java,v 1.11 2004/01/24 02:42:22 dmitri Exp $\n+ * $Revision: 1.11 $\n+ * $Date: 2004/01/24 02:42:22 $\n  *\n  * ====================================================================\n  * The Apache Software License, Version 1.1\n import org.apache.commons.jxpath.AbstractFactory;\n import org.apache.commons.jxpath.ri.model.XMLModelTestCase;\n import org.apache.commons.jxpath.xml.DocumentContainer;\n+import org.jdom.Attribute;\n import org.jdom.CDATA;\n import org.jdom.Document;\n import org.jdom.Element;\n  * Tests JXPath with JDOM\n  *\n  * @author Dmitri Plotnikov\n- * @version $Revision: 1.10 $ $Date: 2004/01/19 20:44:52 $\n+ * @version $Revision: 1.11 $ $Date: 2004/01/24 02:42:22 $\n  */\n \n public class JDOMModelTest extends XMLModelTestCase {\n     protected String getModel() {\n         return DocumentContainer.MODEL_JDOM;\n     }\n-        \n+    \n+    public void testGetNode() {\n+        assertXPathNodeType(context, \"/\", Document.class);\n+        assertXPathNodeType(context, \"/vendor/location\", Element.class);\n+        assertXPathNodeType(context, \"//location/@name\", Attribute.class);\n+    }    \n+    \n     public void testID() {\n         // id() is not supported by JDOM\n     }", "timestamp": 1074912142, "metainfo": ""}