{"sha": "722d696e1966d1e63a3994170ebff53c8543c4e0", "log": "[CSV-134] Unified parameter validation.  ", "commit": "\n--- a/src/main/java/org/apache/commons/csv/CSVFormat.java\n+++ b/src/main/java/org/apache/commons/csv/CSVFormat.java\n             final boolean ignoreEmptyLines, final String recordSeparator, final String nullString,\n             final Object[] headerComments, final String[] header, final boolean skipHeaderRecord,\n             final boolean allowMissingColumnNames) {\n-        if (isLineBreak(delimiter)) {\n-            throw new IllegalArgumentException(\"The delimiter cannot be a line break\");\n-        }\n         this.delimiter = delimiter;\n         this.quoteCharacter = quoteChar;\n         this.quoteMode = quoteMode;\n         this.recordSeparator = recordSeparator;\n         this.nullString = nullString;\n         this.headerComments = toStringArray(headerComments);\n-        if (header == null) {\n-            this.header = null;\n-        } else {\n-            final Set<String> dupCheck = new HashSet<String>();\n-            for (final String hdr : header) {\n-                if (!dupCheck.add(hdr)) {\n-                    throw new IllegalArgumentException(\"The header contains a duplicate entry: '\" + hdr + \"' in \" +\n-                            Arrays.toString(header));\n-                }\n-            }\n-            this.header = header.clone();\n-        }\n+        this.header = header == null ? null : header.clone();\n         this.skipHeaderRecord = skipHeaderRecord;\n         validate();\n     }\n      * @throws IllegalArgumentException\n      */\n     private void validate() throws IllegalArgumentException {\n+        if (isLineBreak(delimiter)) {\n+            throw new IllegalArgumentException(\"The delimiter cannot be a line break\");\n+        }\n+        \n         if (quoteCharacter != null && delimiter == quoteCharacter.charValue()) {\n             throw new IllegalArgumentException(\"The quoteChar character and the delimiter cannot be the same ('\" +\n                     quoteCharacter + \"')\");\n \n         if (escapeCharacter == null && quoteMode == QuoteMode.NONE) {\n             throw new IllegalArgumentException(\"No quotes mode set but no escape character is set\");\n+        }\n+        \n+        // validate header\n+        if (header != null) {\n+            final Set<String> dupCheck = new HashSet<String>();\n+            for (final String hdr : header) {\n+                if (!dupCheck.add(hdr)) {\n+                    throw new IllegalArgumentException(\"The header contains a duplicate entry: '\" + hdr + \"' in \" +\n+                            Arrays.toString(header));\n+                }\n+            }\n         }\n     }\n ", "timestamp": 1415764171, "metainfo": ""}