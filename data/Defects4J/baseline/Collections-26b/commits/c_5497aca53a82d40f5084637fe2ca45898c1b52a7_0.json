{"sha": "5497aca53a82d40f5084637fe2ca45898c1b52a7", "log": "Merging from -r468106:814127 of collections_jdk5_branch - namely where this code was generified; mostly in r738956.  Also see the following revisions:      ------------------------------------------------------------------------     r593347 | skestle | 2007-11-08 14:49:02 -0800 (Thu, 08 Nov 2007) | 3 lines          Added initial IndexedCollection - still needs quite a bit of work - see TODO comments          JIRA: COLLECTIONS-275     ------------------------------------------------------------------------   ", "commit": "\n--- /dev/null\n+++ b/src/test/org/apache/commons/collections/TestIndexedCollection.java\n+package org.apache.commons.collections;\n+\n+import static java.util.Arrays.asList;\n+import static junit.framework.Assert.assertEquals;\n+import static junit.framework.Assert.assertNull;\n+\n+import org.junit.Before;\n+import org.junit.Test;\n+\n+public class TestIndexedCollection extends AbstractDecoratedCollectionTest<String> {\n+    private IndexedCollection<Integer, String> indexed;\n+\n+    @Before\n+    public void setUp() throws Exception {\n+        indexed = IndexedCollection.uniqueIndexedCollection(original, new Transformer<String, Integer>() {\n+            public Integer transform(String input) {\n+                return Integer.parseInt(input);\n+            }\n+        });\n+        decorated = indexed;\n+    }\n+    \n+    @Test\n+    public void addedObjectsCanBeRetrievedByKey() throws Exception {\n+        decorated.add(\"12\");\n+        decorated.add(\"16\");\n+        decorated.add(\"1\");\n+        decorated.addAll(asList(\"2\",\"3\",\"4\"));\n+        assertEquals(\"12\", indexed.get(12));\n+        assertEquals(\"16\", indexed.get(16));\n+        assertEquals(\"1\", indexed.get(1));\n+        assertEquals(\"2\", indexed.get(2));\n+        assertEquals(\"3\", indexed.get(3));\n+        assertEquals(\"4\", indexed.get(4));\n+    }\n+    \n+    @Test(expected=IllegalArgumentException.class)\n+    public void ensureDuplicateObjectsCauseException() throws Exception {\n+        decorated.add(\"1\");\n+        decorated.add(\"1\");\n+    }\n+    \n+    @Test\n+    public void decoratedCollectionIsIndexedOnCreation() throws Exception {\n+        original.add(\"1\");\n+        original.add(\"2\");\n+        original.add(\"3\");\n+        \n+        indexed = IndexedCollection.uniqueIndexedCollection(original, new Transformer<String, Integer>() {\n+            public Integer transform(String input) {\n+                return Integer.parseInt(input);\n+            }\n+        });\n+        assertEquals(\"1\", indexed.get(1));\n+        assertEquals(\"2\", indexed.get(2));\n+        assertEquals(\"3\", indexed.get(3));\n+    }\n+    \n+    @Test\n+    public void reindexUpdatesIndexWhenTheDecoratedCollectionIsModifiedSeparately() throws Exception {\n+        original.add(\"1\");\n+        original.add(\"2\");\n+        original.add(\"3\");\n+        \n+        assertNull(indexed.get(1));\n+        assertNull(indexed.get(2));\n+        assertNull(indexed.get(3));\n+        indexed.reindex();\n+        assertEquals(\"1\", indexed.get(1));\n+        assertEquals(\"2\", indexed.get(2));\n+        assertEquals(\"3\", indexed.get(3));\n+    }\n+}", "timestamp": 1252994285, "metainfo": ""}