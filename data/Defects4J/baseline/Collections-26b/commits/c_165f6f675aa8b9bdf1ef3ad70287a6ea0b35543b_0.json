{"sha": "165f6f675aa8b9bdf1ef3ad70287a6ea0b35543b", "log": "Improve error messages in verify Fix bug when TreeMap EntrySet used   ", "commit": "\n--- a/src/test/org/apache/commons/collections/AbstractTestCollection.java\n+++ b/src/test/org/apache/commons/collections/AbstractTestCollection.java\n /*\n- * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//collections/src/test/org/apache/commons/collections/Attic/AbstractTestCollection.java,v 1.6 2003/10/19 00:25:11 scolebourne Exp $\n+ * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//collections/src/test/org/apache/commons/collections/Attic/AbstractTestCollection.java,v 1.7 2003/10/31 01:23:10 scolebourne Exp $\n  * ====================================================================\n  *\n  * The Apache Software License, Version 1.1\n import java.util.List;\n import java.util.Map;\n import java.util.NoSuchElementException;\n+\n+import org.apache.commons.collections.pairs.DefaultMapEntry;\n \n /**\n  * Abstract test class for {@link java.util.Collection} methods and contracts.\n  * you may still use this base set of cases.  Simply override the\n  * test case (method) your {@link Collection} fails.\n  *\n- * @version $Revision: 1.6 $ $Date: 2003/10/19 00:25:11 $\n+ * @version $Revision: 1.7 $ $Date: 2003/10/31 01:23:10 $\n  * \n  * @author Rodney Waldhoff\n  * @author Paul Jack\n             // no match found!\n             if(!match) {\n                 fail(\"Collection should not contain a value that the \" +\n-                     \"confirmed collection does not have: \" + o);\n+                     \"confirmed collection does not have: \" + o +\n+                     \"\\nTest: \" + collection + \"\\nReal: \" + confirmed);\n             }\n         }\n         \n         for(int i = 0; i < confirmedSize; i++) {\n             if(!matched[i]) {\n                 // the collection didn't match all the confirmed values\n-                fail(\"Collection should contain all values that are in the \" +\n-                     \"confirmed collection\");\n+                fail(\"Collection should contain all values that are in the confirmed collection\" +\n+                     \"\\nTest: \" + collection + \"\\nReal: \" + confirmed);\n             }\n         }\n     }\n         Iterator iter = collection.iterator();\n         while (iter.hasNext()) {\n             Object o = iter.next();\n+            // TreeMap reuses the Map Entry, so the verify below fails\n+            // Clone it here if necessary\n+            if (o instanceof Map.Entry) {\n+                o = new DefaultMapEntry((Map.Entry) o);\n+            }\n             iter.remove();\n \n             // if the elements aren't distinguishable, we can just remove a", "timestamp": 1067563390, "metainfo": ""}