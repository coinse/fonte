{"sha": "02bc99224205418ff0c43397662eded1cc5cc893", "log": "fixed bubble sort, so that the number of elements in the bubble sort will always equal the size of the LRUMap   ", "commit": "\n--- a/src/java/org/apache/commons/collections/LRUMap.java\n+++ b/src/java/org/apache/commons/collections/LRUMap.java\n /*\n- * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//collections/src/java/org/apache/commons/collections/LRUMap.java,v 1.4 2002/02/13 21:03:20 morgand Exp $\n- * $Revision: 1.4 $\n- * $Date: 2002/02/13 21:03:20 $\n+ * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//collections/src/java/org/apache/commons/collections/LRUMap.java,v 1.5 2002/02/13 23:07:31 morgand Exp $\n+ * $Revision: 1.5 $\n+ * $Date: 2002/02/13 23:07:31 $\n  *\n  * ====================================================================\n  *\n         return pair.value;\n     }\n \n-    public Object put( Object key, Object value ) {\n-        int i = size();\n-        ValuePositionPair pair = new ValuePositionPair( value );\n-        if ( i >= maximumSize ) {\n+    public Object put( Object key, Object value ) {\n+\n+         ValuePositionPair pair = new ValuePositionPair( value );\n+         int mapSize = size();\n+\n+         // check to see if the object already exists in\n+         // our LRUMap, if it does then the position in the\n+         // bubble sort is OK\n+        int keyIndex = bubbleList.indexOf(key);\n+         if (keyIndex != -1) {\n+\n+             pair.position = keyIndex;\n+\n+         } else if ( mapSize >= maximumSize ) {\n             // lets retire the least recently used item in the cache\n             int lastIndex = maximumSize - 1;\n             pair.position = lastIndex;\n             Object oldKey = bubbleList.set( lastIndex, key );\n             super.remove( oldKey );\n-        } \n-        else {\n-            pair.position = i;\n-            bubbleList.add( i, key );\n+        } else {\n+            pair.position = mapSize;\n+            bubbleList.add( mapSize, key );\n         }\n         pair = (ValuePositionPair) putPair( key, pair );\n         return ( pair != null ) ? pair.value : null;", "timestamp": 1013641651, "metainfo": ""}