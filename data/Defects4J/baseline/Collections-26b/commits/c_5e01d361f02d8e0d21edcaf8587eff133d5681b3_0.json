{"sha": "5e01d361f02d8e0d21edcaf8587eff133d5681b3", "log": "[COLLECTIONS-445] Ignore several failing tests when executing with IBM J9 VM 1.6.x due to a faulty TreeMap implementation.  ", "commit": "\n--- a/src/test/java/org/apache/commons/collections4/bidimap/DualTreeBidiMap2Test.java\n+++ b/src/test/java/org/apache/commons/collections4/bidimap/DualTreeBidiMap2Test.java\n      */\n     @Override\n     public String[] ignoredTests() {\n-        return new String[] {\"DualTreeBidiMap2Test.bulkTestInverseMap.bulkTestInverseMap\"};\n+        String recursiveTest = \"DualTreeBidiMap2Test.bulkTestInverseMap.bulkTestInverseMap\";\n+\n+        // there are several bugs in the following JVM:\n+        // IBM J9 VM build 2.4, JRE 1.6.0 IBM J9 2.4 Linux x86-32 jvmxi3260sr12-20121024_126067\n+        // thus disabling tests related to these bugs\n+        \n+        final String vmName = System.getProperty(\"java.vm.name\");\n+        final String version = System.getProperty(\"java.version\");\n+        \n+        if (vmName == null || version == null) {\n+            return new String[] { recursiveTest };\n+        }\n+\n+        if (vmName.equals(\"IBM J9 VM\") && version.equals(\"1.6.0\")) {\n+            final String preSub = \"DualTreeBidiMap2Test.bulkTestSubMap.bulkTestMap\";\n+            final String preTail = \"DualTreeBidiMap2Test.bulkTestTailMap.bulkTestMap\";\n+            return new String[] {\n+                    recursiveTest,\n+                    preSub + \"EntrySet.testCollectionIteratorRemove\",\n+                    preSub + \"Values.testCollectionIteratorRemove\",\n+                    preTail + \"Values.testCollectionClear\",\n+                    preTail + \"Values.testCollectionRemoveAll\",\n+                    preTail + \"Values.testCollectionRetainAll\"\n+            };\n+        } else {\n+            return new String[] { recursiveTest };\n+        }\n     }\n+\n \n //    public void testCreate() throws Exception {\n //        resetEmpty();\n--- a/src/test/java/org/apache/commons/collections4/bidimap/DualTreeBidiMapTest.java\n+++ b/src/test/java/org/apache/commons/collections4/bidimap/DualTreeBidiMapTest.java\n      */\n     @Override\n     public String[] ignoredTests() {\n-        return new String[] {\"DualTreeBidiMapTest.bulkTestInverseMap.bulkTestInverseMap\"};\n+        String recursiveTest = \"DualTreeBidiMapTest.bulkTestInverseMap.bulkTestInverseMap\";\n+\n+        // there are several bugs in the following JVM:\n+        // IBM J9 VM build 2.4, JRE 1.6.0 IBM J9 2.4 Linux x86-32 jvmxi3260sr12-20121024_126067\n+        // thus disabling tests related to these bugs\n+        \n+        final String vmName = System.getProperty(\"java.vm.name\");\n+        final String version = System.getProperty(\"java.version\");\n+        \n+        if (vmName == null || version == null) {\n+            return new String[] { recursiveTest };\n+        }\n+\n+        if (vmName.equals(\"IBM J9 VM\") && version.equals(\"1.6.0\")) {\n+            final String preSub = \"DualTreeBidiMapTest.bulkTestSubMap.bulkTestMap\";\n+            final String preTail = \"DualTreeBidiMapTest.bulkTestTailMap.bulkTestMap\";\n+            return new String[] {\n+                    recursiveTest,\n+                    preSub + \"EntrySet.testCollectionIteratorRemove\",\n+                    preSub + \"Values.testCollectionIteratorRemove\",\n+                    preTail + \"Values.testCollectionClear\",\n+                    preTail + \"Values.testCollectionRemoveAll\",\n+                    preTail + \"Values.testCollectionRetainAll\"\n+            };\n+        } else {\n+            return new String[] { recursiveTest };\n+        }\n     }\n-    \n+\n //    public void testCreate() throws Exception {\n //        resetEmpty();\n //        writeExternalFormToDisk((java.io.Serializable) map, \"src/test/resources/data/test/DualTreeBidiMap.emptyCollection.version4.obj\");\n--- a/src/test/java/org/apache/commons/collections4/map/AbstractMapTest.java\n+++ b/src/test/java/org/apache/commons/collections4/map/AbstractMapTest.java\n         \n         // bug in IBM JDK: IBM J9 VM build 2.4, JRE 1.6.0 IBM J9 2.4 Linux x86-32 jvmxi3260sr12-20121024_126067\n         // a call to values() on an empty map retrieved via TreeMap#headMap or tailMap\n-        // will render the values view unusable: resulting in NullPointExceptions or missing values\n+        // will render the values view unusable: resulting in NullPointerExceptions or missing values\n         // it will also not recover, as the value view is cached internally\n         values = getMap().values();\n         \n--- a/src/test/java/org/apache/commons/collections4/map/TransformedSortedMapTest.java\n+++ b/src/test/java/org/apache/commons/collections4/map/TransformedSortedMapTest.java\n         return BulkTest.makeSuite(TransformedSortedMapTest.class);\n     }\n \n+    @Override\n+    public String[] ignoredTests() {\n+        // there are several bugs in the following JVM:\n+        // IBM J9 VM build 2.4, JRE 1.6.0 IBM J9 2.4 Linux x86-32 jvmxi3260sr12-20121024_126067\n+        // thus disabling tests related to these bugs\n+        \n+        final String vmName = System.getProperty(\"java.vm.name\");\n+        final String version = System.getProperty(\"java.version\");\n+        \n+        if (vmName == null || version == null) {\n+            return null;\n+        }\n+\n+        if (vmName.equals(\"IBM J9 VM\") && version.equals(\"1.6.0\")) {\n+            final String preSubMap = \"TransformedSortedMapTest.bulkTestSubMap.bulkTestMap\";\n+            final String preTailMap = \"TransformedSortedMapTest.bulkTestTailMap.bulkTestMap\";\n+            return new String[] {\n+                    preSubMap + \"EntrySet.testCollectionIteratorRemove\",\n+                    preSubMap + \"KeySet.testCollectionRemove\",\n+                    preSubMap + \"Values.testCollectionIteratorRemove\",\n+                    preTailMap + \"Values.testCollectionClear\",\n+                    preTailMap + \"Values.testCollectionRemoveAll\",\n+                    preTailMap + \"Values.testCollectionRetainAll\"\n+            };\n+        } else {\n+            return null;\n+        }\n+    }\n+\n     //-----------------------------------------------------------------------\n     @Override\n     @SuppressWarnings(\"unchecked\")", "timestamp": 1366566470, "metainfo": ""}