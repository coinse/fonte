{"sha": "25e0dd13fdc98cdab72850e61a54c55b50647158", "log": "If object is not an array, fail on from the constructor or from setArray rather than from hasNext or next.  This gives a more fail-fast behavior.   ", "commit": "\n--- a/src/java/org/apache/commons/collections/ArrayIterator.java\n+++ b/src/java/org/apache/commons/collections/ArrayIterator.java\n /*\n- * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//collections/src/java/org/apache/commons/collections/Attic/ArrayIterator.java,v 1.10 2002/03/19 00:05:10 morgand Exp $\n- * $Revision: 1.10 $\n- * $Date: 2002/03/19 00:05:10 $\n+ * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//collections/src/java/org/apache/commons/collections/Attic/ArrayIterator.java,v 1.11 2002/03/19 00:54:34 mas Exp $\n+ * $Revision: 1.11 $\n+ * $Date: 2002/03/19 00:54:34 $\n  *\n  * ====================================================================\n  *\n   *\n   * @author <a href=\"mailto:jstrachan@apache.org\">James Strachan</a>\n   * @author Mauricio S. Moura\n-  * @version $Revision: 1.10 $\n+  * @author <a href=\"mailto:mas@apache.org\">Michael A. Smith</a>\n+  * @version $Revision: 1.11 $\n   */\n public class ArrayIterator implements Iterator {\n     \n     private Object array;\n+    private int length = 0;\n     private int index = 0;\n   \n     \n     }\n     \n     public ArrayIterator(Object array) {\n-        this.array = array;\n+        setArray( array );\n     }\n \n     // Iterator interface\n     //-------------------------------------------------------------------------\n     public boolean hasNext() {\n-        return  index < Array.getLength( array );\n+        return index < length;\n     }\n \n     public Object next() {\n         return array;\n     }\n     \n+    /**\n+     *  @exception IllegalArgumentException if <code>array</code> is not an\n+     *  array.\n+     **/\n     public void setArray( Object array ) {\n+        // Array.getLength throws IllegalArgumentException if the object is not\n+        // an array.  This call is made before saving the array and resetting\n+        // the index so that the array iterator remains in a consistent state\n+        // if the argument is not an array.\n+        this.length = Array.getLength( array );\n         this.array = array;\n         this.index = 0;\n     }", "timestamp": 1016499274, "metainfo": ""}