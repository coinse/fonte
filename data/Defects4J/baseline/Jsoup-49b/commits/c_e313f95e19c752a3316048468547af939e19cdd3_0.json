{"sha": "e313f95e19c752a3316048468547af939e19cdd3", "log": "In jsoup.connect, fail faster if the return content type is not supported.  Fixes #153.", "commit": "\n--- a/src/main/java/org/jsoup/helper/HttpConnection.java\n+++ b/src/main/java/org/jsoup/helper/HttpConnection.java\n                 return execute(req, res);\n             }\n             res.req = req;\n+\n+            // check that we can handle the returned content type; if not, abort before fetching it\n+            String contentType = res.contentType();\n+            if (!req.ignoreContentType() && (contentType == null || !(contentType.startsWith(\"text/\") || contentType.startsWith(\"application/xml\") || contentType.startsWith(\"application/xhtml+xml\"))))\n+                throw new IOException(String.format(\"Unhandled content type \\\"%s\\\" on URL %s. Must be text/*, application/xml, or application/xhtml+xml\",\n+                    contentType, req.url().toString()));\n \n             InputStream bodyStream = null;\n             InputStream dataStream = null;\n \n         public Document parse() throws IOException {\n             Validate.isTrue(executed, \"Request must be executed (with .execute(), .get(), or .post() before parsing response\");\n-            if (!req.ignoreContentType() && (contentType == null || !(contentType.startsWith(\"text/\") || contentType.startsWith(\"application/xml\") || contentType.startsWith(\"application/xhtml+xml\"))))\n-                throw new IOException(String.format(\"Unhandled content type \\\"%s\\\" on URL %s. Must be text/*, application/xml, or application/xhtml+xml\",\n-                    contentType, url.toString()));\n             Document doc = DataUtil.parseByteData(byteData, charset, url.toExternalForm(), req.parser());\n             byteData.rewind();\n             charset = doc.outputSettings().charset().name(); // update charset from meta-equiv, possibly", "timestamp": 1338232248, "metainfo": ""}