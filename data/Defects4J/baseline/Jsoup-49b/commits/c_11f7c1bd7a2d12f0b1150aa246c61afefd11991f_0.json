{"sha": "11f7c1bd7a2d12f0b1150aa246c61afefd11991f", "log": "Search for element siblings by identity not content  Fixes #554, #561", "commit": "\n--- a/src/main/java/org/jsoup/nodes/Element.java\n+++ b/src/main/java/org/jsoup/nodes/Element.java\n \n         for (int i = 0; i < elements.size(); i++) {\n             E element = elements.get(i);\n-            if (element.equals(search))\n+            if (element == search)\n                 return i;\n         }\n         return null;\n--- a/src/test/java/org/jsoup/nodes/ElementTest.java\n+++ b/src/test/java/org/jsoup/nodes/ElementTest.java\n         assertEquals(\"element\", p.lastElementSibling().text());\n     }\n \n+    @Test public void testGetSiblingsWithDuplicateContent() {\n+        Document doc = Jsoup.parse(\"<div><p>Hello<p id=1>there<p>this<p>this<p>is<p>an<p id=last>element</div>\");\n+        Element p = doc.getElementById(\"1\");\n+        assertEquals(\"there\", p.text());\n+        assertEquals(\"Hello\", p.previousElementSibling().text());\n+        assertEquals(\"this\", p.nextElementSibling().text());\n+        assertEquals(\"this\", p.nextElementSibling().nextElementSibling().text());\n+        assertEquals(\"is\", p.nextElementSibling().nextElementSibling().nextElementSibling().text());\n+        assertEquals(\"Hello\", p.firstElementSibling().text());\n+        assertEquals(\"element\", p.lastElementSibling().text());\n+    }\n+\n     @Test public void testGetParents() {\n         Document doc = Jsoup.parse(\"<div><p>Hello <span>there</span></div>\");\n         Element span = doc.select(\"span\").first();\n     \n     @Test public void testElementSiblingIndex() {\n         Document doc = Jsoup.parse(\"<div><p>One</p>...<p>Two</p>...<p>Three</p>\");\n+        Elements ps = doc.select(\"p\");\n+        assertTrue(0 == ps.get(0).elementSiblingIndex());\n+        assertTrue(1 == ps.get(1).elementSiblingIndex());\n+        assertTrue(2 == ps.get(2).elementSiblingIndex());\n+    }\n+\n+    @Test public void testElementSiblingIndexSameContent() {\n+        Document doc = Jsoup.parse(\"<div><p>One</p>...<p>One</p>...<p>One</p>\");\n         Elements ps = doc.select(\"p\");\n         assertTrue(0 == ps.get(0).elementSiblingIndex());\n         assertTrue(1 == ps.get(1).elementSiblingIndex());", "timestamp": 1429679488, "metainfo": ""}