{"sha": "d8095c72fd5149444be413ba1f1c6529a148bc89", "log": "minor improvements to the test", "commit": "\n--- a/gson/src/test/java/com/google/gson/metrics/PerformanceTest.java\n+++ b/gson/src/test/java/com/google/gson/metrics/PerformanceTest.java\n   \n   public void testDummy() {    \n     // This is here to prevent Junit for complaining when we disable all tests.\n-  }\n+  }  \n \n-  // Last I tested, Gson was able to serialize upto 8MB byte array\n-  public void disable_testByteArraySerialization() {\n-    int size = 8096;\n-    while (true) {\n-      byte[] ba = new byte[size];\n-      for (int i = 0; i < size; ++i) {\n-        ba[i] = 0x32;\n-      }\n-      String json = gson.toJson(ba);\n-      System.out.printf(\"Gson could serialize a byte array of size: %d\\n\", size);\n-      size <<= 2;\n-    }\n-  }\n-  \n-  // Last I tested, Gson was able to deserialize a byte array of 32KB\n-  public void disable_testByteArrayDeserialization() {\n-    int numElements = 8096;\n-    while (true) {\n-      StringBuilder sb = new StringBuilder(numElements*2);\n-      sb.append(\"[\");\n-      boolean first = true;\n-      for (int i = 0; i < numElements; ++i) {\n-        if (first) {\n-          first = false;\n-        } else {\n-          sb.append(\",\");\n-        }\n-        sb.append(\"5\");\n-      }\n-      sb.append(\"]\");\n-      String json = sb.toString();\n-      byte[] ba = gson.fromJson(json, byte[].class);\n-      System.out.printf(\"Gson could handle a byte array of size: %d\\n\", ba.length);\n-      numElements <<= 2;\n-    }\n-  }\n-  \n-\n-  public void disabled_testStringDeserializationPerformance() {    \n+  public void disabled_testStringDeserialization() {    \n     StringBuilder sb = new StringBuilder(8096);\n     sb.append(\"Error Yippie\");\n \n     List<CollectionEntry> list = gson.fromJson(json, collectionType);       \n     assertEquals(count, list.size());\n   }\n+\n+  /**\n+   * Created in response to http://code.google.com/p/google-gson/issues/detail?id=96\n+   */\n+  // Last I tested, Gson was able to serialize upto 14MB byte array\n+  public void disable_testByteArraySerialization() {\n+    for (int size = 4145152; true; size += 1036288) {\n+      byte[] ba = new byte[size];\n+      for (int i = 0; i < size; ++i) {\n+        ba[i] = 0x05;\n+      }\n+      String json = gson.toJson(ba);\n+      System.out.printf(\"Gson could serialize a byte array of size: %d\\n\", size);\n+    }\n+  }\n+  \n+  /**\n+   * Created in response to http://code.google.com/p/google-gson/issues/detail?id=96\n+   */\n+  // Last I tested, Gson was able to deserialize a byte array of 80KB\n+  public void disable_testByteArrayDeserialization() {\n+    for (int numElements = 32768; true; numElements += 4096) {\n+      StringBuilder sb = new StringBuilder(numElements*2);\n+      sb.append(\"[\");\n+      boolean first = true;\n+      for (int i = 0; i < numElements; ++i) {\n+        if (first) {\n+          first = false;\n+        } else {\n+          sb.append(\",\");\n+        }\n+        sb.append(\"5\");\n+      }\n+      sb.append(\"]\");\n+      String json = sb.toString();\n+      byte[] ba = gson.fromJson(json, byte[].class);\n+      System.out.printf(\"Gson could deserialize a byte array of size: %d\\n\", ba.length);\n+    }\n+  }\n }", "timestamp": 1247533684, "metainfo": ""}