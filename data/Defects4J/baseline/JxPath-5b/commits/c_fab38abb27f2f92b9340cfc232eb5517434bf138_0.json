{"sha": "fab38abb27f2f92b9340cfc232eb5517434bf138", "log": "[JXPATH-12] Descendant or self axis does not work correctly at root node. Contributed by Marcin Sarniak.   ", "commit": "\n--- a/src/java/org/apache/commons/jxpath/ri/model/dom/DOMNodePointer.java\n+++ b/src/java/org/apache/commons/jxpath/ri/model/dom/DOMNodePointer.java\n             int nodeType = node.getNodeType();\n             switch (((NodeTypeTest) test).getNodeType()) {\n                 case Compiler.NODE_TYPE_NODE :\n-                    return nodeType == Node.ELEMENT_NODE;\n+                    return nodeType == Node.ELEMENT_NODE\n+                            || nodeType == Node.DOCUMENT_NODE;\n                 case Compiler.NODE_TYPE_TEXT :\n                     return nodeType == Node.CDATA_SECTION_NODE\n                         || nodeType == Node.TEXT_NODE;\n--- a/src/java/org/apache/commons/jxpath/ri/model/jdom/JDOMNodePointer.java\n+++ b/src/java/org/apache/commons/jxpath/ri/model/jdom/JDOMNodePointer.java\n         else if (test instanceof NodeTypeTest) {\n             switch (((NodeTypeTest) test).getNodeType()) {\n                 case Compiler.NODE_TYPE_NODE :\n-                    return node instanceof Element;\n+                    return (node instanceof Element) || (node instanceof Document);\n                 case Compiler.NODE_TYPE_TEXT :\n                     return (node instanceof Text) || (node instanceof CDATA);\n                 case Compiler.NODE_TYPE_COMMENT :\n--- a/src/test/org/apache/commons/jxpath/ri/model/dom/DOMModelTest.java\n+++ b/src/test/org/apache/commons/jxpath/ri/model/dom/DOMModelTest.java\n         assertXPathNodeType(context, \"/\", Document.class);\n         assertXPathNodeType(context, \"/vendor/location\", Element.class);\n         assertXPathNodeType(context, \"//location/@name\", Attr.class);\n+        assertXPathNodeType(context, \"//vendor\", Element.class);\n     }\n     \n     protected String getXMLSignature(\n--- a/src/test/org/apache/commons/jxpath/ri/model/jdom/JDOMModelTest.java\n+++ b/src/test/org/apache/commons/jxpath/ri/model/jdom/JDOMModelTest.java\n         assertXPathNodeType(context, \"/\", Document.class);\n         assertXPathNodeType(context, \"/vendor/location\", Element.class);\n         assertXPathNodeType(context, \"//location/@name\", Attribute.class);\n-    }    \n+        assertXPathNodeType(context, \"//vendor\", Element.class); //bugzilla #38586\n+    }\n     \n     public void testID() {\n         // id() is not supported by JDOM", "timestamp": 1168453640, "metainfo": ""}