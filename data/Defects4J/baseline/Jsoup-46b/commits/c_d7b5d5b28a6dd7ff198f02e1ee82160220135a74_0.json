{"sha": "d7b5d5b28a6dd7ff198f02e1ee82160220135a74", "log": "Check for null body, possible in framesets.  Fixes #154", "commit": "\n--- a/src/main/java/org/jsoup/safety/Cleaner.java\n+++ b/src/main/java/org/jsoup/safety/Cleaner.java\n         Validate.notNull(dirtyDocument);\n \n         Document clean = Document.createShell(dirtyDocument.baseUri());\n-        copySafeNodes(dirtyDocument.body(), clean.body());\n+        if (dirtyDocument.body() != null) // frameset documents won't have a body. the clean doc will have empty body.\n+            copySafeNodes(dirtyDocument.body(), clean.body());\n \n         return clean;\n     }\n--- a/src/test/java/org/jsoup/safety/CleanerTest.java\n+++ b/src/test/java/org/jsoup/safety/CleanerTest.java\n         String customOut2 = Jsoup.clean(html, \"http://foo.com/\", Whitelist.relaxed(), os);\n         assertEquals(\"<div><p>&#8492;</p></div>\", customOut2);\n     }\n+\n+    @Test public void handlesFramesets() {\n+        String dirty = \"<html><head><script></script><noscript></noscript></head><frameset><frame src=\\\"foo\\\" /><frame src=\\\"foo\\\" /></frameset></html>\";\n+        String clean = Jsoup.clean(dirty, Whitelist.basic());\n+        assertEquals(\"\", clean); // nothing good can come out of that\n+\n+        Document dirtyDoc = Jsoup.parse(dirty);\n+        Document cleanDoc = new Cleaner(Whitelist.basic()).clean(dirtyDoc);\n+        assertFalse(cleanDoc == null);\n+        assertEquals(0, cleanDoc.body().childNodes().size());\n+    }\n }", "timestamp": 1338781232, "metainfo": ""}