{"sha": "37d4c1f1d3297fd078dd8d1574b7f7c2357a99b4", "log": "Linked Document title methods with HTML structure", "commit": "\n--- a/src/main/java/org/jsoup/nodes/Document.java\n+++ b/src/main/java/org/jsoup/nodes/Document.java\n \n  @author Jonathan Hedley, jonathan@hedley.net */\n public class Document extends Element {\n-    private String title;\n \n     public Document(String baseUri) {\n         super(Tag.valueOf(\"#root\"), baseUri);\n     }\n \n     public Element head() {\n-        return getElementsByTag(\"head\").get(0);\n+        return getElementsByTag(\"head\").first();\n     }\n \n     public Element body() {\n-        return getElementsByTag(\"body\").get(0);\n+        return getElementsByTag(\"body\").first();\n     }\n \n     public String title() {\n-        return title;\n+        Element titleEl = getElementsByTag(\"title\").first();\n+        return titleEl != null ? titleEl.text().trim() : \"\";\n     }\n \n     public void title(String title) {\n-        this.title = title;\n+        Element titleEl = getElementsByTag(\"title\").first();\n+        if (titleEl == null) { // add to head\n+            head().appendElement(\"title\").text(title);\n+        } else {\n+            titleEl.text(title);\n+        }\n     }\n \n     public Element createElement(Tag tag) {\n--- a/src/main/java/org/jsoup/parser/Parser.java\n+++ b/src/main/java/org/jsoup/parser/Parser.java\n         if (tag.isData()) {\n             String data = tq.chompTo(\"</\" + tagName);\n             tq.chompTo(\">\");\n-            DataNode dataNode = DataNode.createFromEncoded(data, baseUri);\n-            child.appendChild(dataNode);\n-\n-            if (tag.equals(titleTag))\n-                doc.title(child.data());\n+            \n+            Node dataNode;\n+            if (tag.equals(titleTag)) // want to show as text, but not contain inside tags\n+                dataNode = TextNode.createFromEncoded(data, baseUri);\n+            else\n+                dataNode = DataNode.createFromEncoded(data, baseUri);\n+            child.appendChild(dataNode);   \n         }\n \n         // <base href>: update the base uri\n--- a/src/test/java/org/jsoup/nodes/DocumentTest.java\n+++ b/src/test/java/org/jsoup/nodes/DocumentTest.java\n         assertEquals(\"Replaced\", doc.body().text());\n         assertEquals(1, doc.select(\"head\").size());\n     }\n+    \n+    @Test public void testTitles() {\n+        Document noTitle = Jsoup.parse(\"<p>Hello</p>\");\n+        Document withTitle = Jsoup.parse(\"<title>First</title><title>Ignore</title><p>Hello</p>\");\n+        \n+        assertEquals(\"\", noTitle.title());\n+        noTitle.title(\"Hello\");\n+        assertEquals(\"Hello\", noTitle.title());\n+        assertEquals(\"Hello\", noTitle.select(\"title\").first().text());\n+        \n+        assertEquals(\"First\", withTitle.title());\n+        withTitle.title(\"Hello\");\n+        assertEquals(\"Hello\", withTitle.title());\n+        assertEquals(\"Hello\", withTitle.select(\"title\").first().text());\n+    }\n }", "timestamp": 1309605106, "metainfo": ""}