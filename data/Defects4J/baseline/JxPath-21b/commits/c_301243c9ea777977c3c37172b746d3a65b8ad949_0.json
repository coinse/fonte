{"sha": "301243c9ea777977c3c37172b746d3a65b8ad949", "log": "Corrected behavior of chained predicates.   Each predicate is supposed to form its own node set.  ", "commit": "\n--- a/src/java/org/apache/commons/jxpath/ri/axes/UnionContext.java\n+++ b/src/java/org/apache/commons/jxpath/ri/axes/UnionContext.java\n  * @version $Revision$ $Date$\n  */\n public class UnionContext extends NodeSetContext {\n-    private boolean startedSet = false;\n     private EvalContext contexts[];\n     private boolean prepared = false;\n \n--- a/src/java/org/apache/commons/jxpath/ri/compiler/ExpressionPath.java\n+++ b/src/java/org/apache/commons/jxpath/ri/compiler/ExpressionPath.java\n  */\n package org.apache.commons.jxpath.ri.compiler;\n \n+import org.apache.commons.jxpath.BasicNodeSet;\n import org.apache.commons.jxpath.ri.EvalContext;\n import org.apache.commons.jxpath.ri.axes.InitialContext;\n import org.apache.commons.jxpath.ri.axes.NodeSetContext;\n         }\n         if (predicates != null) {\n             for (int j = 0; j < predicates.length; j++) {\n+                if (j != 0) {\n+                    context = new UnionContext(context, new EvalContext[]{context});\n+                }\n                 context = new PredicateContext(context, predicates[j]);\n             }\n         }\n--- a/src/java/org/apache/commons/jxpath/ri/compiler/Path.java\n+++ b/src/java/org/apache/commons/jxpath/ri/compiler/Path.java\n import org.apache.commons.jxpath.ri.axes.PredicateContext;\n import org.apache.commons.jxpath.ri.axes.SelfContext;\n import org.apache.commons.jxpath.ri.axes.SimplePathInterpreter;\n+import org.apache.commons.jxpath.ri.axes.UnionContext;\n import org.apache.commons.jxpath.ri.model.NodePointer;\n \n /**\n             Expression predicates[] = steps[i].getPredicates();\n             if (predicates != null) {\n                 for (int j = 0; j < predicates.length; j++) {\n+                    if (j != 0) {\n+                        context = new UnionContext(context, new EvalContext[]{context});\n+                    }\n                     context = new PredicateContext(context, predicates[j]);\n                 }\n             }", "timestamp": 1130641632, "metainfo": ""}