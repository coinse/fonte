{"sha": "6cf7092809515b6add5f0e83fd837b8e013c5256", "log": "[JXPATH-114] properly implement node()  ", "commit": "\n--- a/src/java/org/apache/commons/jxpath/ri/model/dom/DOMNodePointer.java\n+++ b/src/java/org/apache/commons/jxpath/ri/model/dom/DOMNodePointer.java\n             int nodeType = node.getNodeType();\n             switch (((NodeTypeTest) test).getNodeType()) {\n                 case Compiler.NODE_TYPE_NODE :\n-                    return nodeType == Node.ELEMENT_NODE\n-                            || nodeType == Node.DOCUMENT_NODE;\n+                    return true;\n                 case Compiler.NODE_TYPE_TEXT :\n                     return nodeType == Node.CDATA_SECTION_NODE\n                         || nodeType == Node.TEXT_NODE;\n--- a/src/java/org/apache/commons/jxpath/ri/model/jdom/JDOMNodePointer.java\n+++ b/src/java/org/apache/commons/jxpath/ri/model/jdom/JDOMNodePointer.java\n         if (test instanceof NodeTypeTest) {\n             switch (((NodeTypeTest) test).getNodeType()) {\n                 case Compiler.NODE_TYPE_NODE :\n-                    return (node instanceof Element) || (node instanceof Document);\n+                    return true;\n                 case Compiler.NODE_TYPE_TEXT :\n                     return (node instanceof Text) || (node instanceof CDATA);\n                 case Compiler.NODE_TYPE_COMMENT :\n--- a/src/test/org/apache/commons/jxpath/ri/model/XMLModelTestCase.java\n+++ b/src/test/org/apache/commons/jxpath/ri/model/XMLModelTestCase.java\n                 context,\n                 \"//location[2]/preceding-sibling::location//street\",\n         \"/vendor[1]/location[1]/address[1]/street[1]\");\n-        assertXPathPointer(context, \"//location[2]/preceding::node()[1]\", \"/vendor[1]/location[1]/employeeCount[1]\");\n+        assertXPathPointer(context, \"//location[2]/preceding::*[1]\", \"/vendor[1]/location[1]/employeeCount[1]\");\n+        assertXPathPointer(context, \"//location[2]/preceding::node()[3]\", \"/vendor[1]/location[1]/employeeCount[1]/text()[1]\");\n+        assertXPathPointer(context, \"//location[2]/preceding::node()[4]\", \"/vendor[1]/location[1]/employeeCount[1]\");\n     }\n \n     public void testAxisAttribute() {\n             context,\n             \"//location/following::price:sale/saleEnds\",\n             \"never\");\n-        assertXPathPointer(context, \"//location[2]/following::node()[1]\", \"/vendor[1]/product[1]\");\n+        assertXPathPointer(context, \"//location[2]/following::node()[2]\", \"/vendor[1]/product[1]\");\n     }\n \n     public void testAxisSelf() {", "timestamp": 1201994161, "metainfo": ""}