{"sha": "cd7b5363f4d505070c4438436caf0cdcdae3b5ec", "log": "[JXPATH-111] ClassCastException in PrecedingOrFollowingContext  ", "commit": "\n--- a/src/java/org/apache/commons/jxpath/ri/axes/PrecedingOrFollowingContext.java\n+++ b/src/java/org/apache/commons/jxpath/ri/axes/PrecedingOrFollowingContext.java\n import org.apache.commons.jxpath.ri.compiler.NodeTest;\n import org.apache.commons.jxpath.ri.model.NodeIterator;\n import org.apache.commons.jxpath.ri.model.NodePointer;\n-import org.apache.commons.jxpath.ri.model.beans.PropertyIterator;\n \n /**\n  * EvalContext that walks the \"preceding::\" and \"following::\" axes.\n                     else {\n                         stack.pop();\n                         if (!stack.isEmpty()) {\n-                            it = (PropertyIterator) stack.peek();\n+                            it = (NodeIterator) stack.peek();\n                             currentNodePointer = it.getNodePointer();\n                             if (currentNodePointer.testNode(nodeTest)) {\n                                 super.setPosition(getCurrentPosition() + 1);\n--- a/src/test/org/apache/commons/jxpath/ri/model/XMLModelTestCase.java\n+++ b/src/test/org/apache/commons/jxpath/ri/model/XMLModelTestCase.java\n             \"/vendor[1]/location[1]/address[1]/street[1]\");\n     }\n \n+    public void testAxisPreceding() {\n+        // preceding::\n+        assertXPathPointer(\n+                context,\n+                \"//location[2]/preceding-sibling::location//street\",\n+        \"/vendor[1]/location[1]/address[1]/street[1]\");\n+        assertXPathPointer(context, \"//location[2]/preceding::node()[1]\", \"/vendor[1]/location[1]/employeeCount[1]\");\n+    }\n+\n     public void testAxisAttribute() {\n         // attribute::\n         assertXPathValue(context, \"vendor/location/@id\", \"100\");\n             context,\n             \"//location/following::price:sale/saleEnds\",\n             \"never\");\n+        assertXPathPointer(context, \"//location[2]/following::node()[1]\", \"/vendor[1]/product[1]\");\n     }\n \n     public void testAxisSelf() {", "timestamp": 1198526185, "metainfo": ""}