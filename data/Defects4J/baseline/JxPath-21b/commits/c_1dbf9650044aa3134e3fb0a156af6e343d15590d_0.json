{"sha": "1dbf9650044aa3134e3fb0a156af6e343d15590d", "log": "Changed to a simpler iteration style to avoid stale pointers   ", "commit": "\n--- a/src/java/org/apache/commons/jxpath/ri/compiler/CoreFunction.java\n+++ b/src/java/org/apache/commons/jxpath/ri/compiler/CoreFunction.java\n /*\n- * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//jxpath/src/java/org/apache/commons/jxpath/ri/compiler/CoreFunction.java,v 1.5 2002/06/08 22:47:25 dmitri Exp $\n- * $Revision: 1.5 $\n- * $Date: 2002/06/08 22:47:25 $\n+ * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//jxpath/src/java/org/apache/commons/jxpath/ri/compiler/CoreFunction.java,v 1.6 2002/08/10 01:37:12 dmitri Exp $\n+ * $Revision: 1.6 $\n+ * $Date: 2002/08/10 01:37:12 $\n  *\n  * ====================================================================\n  * The Apache Software License, Version 1.1\n  * like \"position()\" or \"number()\".\n  *\n  * @author Dmitri Plotnikov\n- * @version $Revision: 1.5 $ $Date: 2002/06/08 22:47:25 $\n+ * @version $Revision: 1.6 $ $Date: 2002/08/10 01:37:12 $\n  */\n public class CoreFunction extends Operation {\n \n         if (set instanceof EvalContext){\n             EvalContext ctx = (EvalContext)set;\n             if (ctx.hasNext()){\n-                ctx.next();\n-                String str = ctx.getCurrentNodePointer().getNamespaceURI();\n+                NodePointer ptr = (NodePointer)ctx.next();\n+                String str = ptr.getNamespaceURI();\n                 return str == null ? \"\" : str;\n             }\n         }\n         if (set instanceof EvalContext){\n             EvalContext ctx = (EvalContext)set;\n             if (ctx.hasNext()){\n-                ctx.next();\n-                return ctx.getCurrentNodePointer().getName().getName();\n+                NodePointer ptr = (NodePointer)ctx.next();\n+                return ptr.getName().getName();\n             }\n         }\n         return \"\";\n         if (set instanceof EvalContext){\n             EvalContext ctx = (EvalContext)set;\n             if (ctx.hasNext()){\n-                ctx.next();\n-                return ctx.getCurrentNodePointer().getExpandedName().toString();\n+                NodePointer ptr = (NodePointer)ctx.next();\n+                return ptr.getExpandedName().toString();\n             }\n         }\n         return \"\";\n         else if (v instanceof EvalContext){\n             double sum = 0.0;\n             EvalContext ctx = (EvalContext)v;\n-            while (ctx.nextSet()){\n-                while (ctx.nextNode()){\n-                    sum += InfoSetUtil.doubleValue(ctx.getCurrentNodePointer());\n-                }\n+            while (ctx.hasNext()){\n+                NodePointer ptr = (NodePointer)ctx.next();\n+                sum += InfoSetUtil.doubleValue(ptr);\n             }\n             return new Double(sum);\n         }", "timestamp": 1028943432, "metainfo": ""}