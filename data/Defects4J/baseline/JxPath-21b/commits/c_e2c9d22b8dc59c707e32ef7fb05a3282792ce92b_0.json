{"sha": "e2c9d22b8dc59c707e32ef7fb05a3282792ce92b", "log": "refactoring to avoid constructing n intermediate strings  ", "commit": "\n--- a/src/java/org/apache/commons/jxpath/ri/model/dom/DOMNodePointer.java\n+++ b/src/java/org/apache/commons/jxpath/ri/model/dom/DOMNodePointer.java\n      * @return string with any necessary changes made.\n      */\n     private String escape(String string) {\n-        int index = string.indexOf('\\'');\n-        while (index != -1) {\n-            string =\n-                string.substring(0, index)\n-                    + \"&apos;\"\n-                    + string.substring(index + 1);\n-            index = string.indexOf('\\'');\n-        }\n-        index = string.indexOf('\\\"');\n-        while (index != -1) {\n-            string =\n-                string.substring(0, index)\n-                    + \"&quot;\"\n-                    + string.substring(index + 1);\n-            index = string.indexOf('\\\"');\n-        }\n-        return string;\n+        final char[] c = new char[] { '\\'', '\"' };\n+        final String[] esc = new String[] { \"&apos;\", \"&quot;\" };\n+        StringBuffer sb = null;\n+        for (int i = 0; sb == null && i < c.length; i++) {\n+            if (string.indexOf(c[i]) >= 0) {\n+                sb = new StringBuffer(string);\n+            }\n+        }\n+        if (sb == null) {\n+            return string;\n+        }\n+        for (int i = 0; i < c.length; i++) {\n+            if (string.indexOf(c[i]) < 0) {\n+                continue;\n+            }\n+            int pos = 0;\n+            while (pos < sb.length()) {\n+                if (sb.charAt(pos) == c[i]) {\n+                    sb.replace(pos, pos + 1, esc[i]);\n+                    pos += esc[i].length();\n+                } else {\n+                    pos++;\n+                }\n+            }\n+        }\n+        return sb.toString();\n     }\n \n     /**", "timestamp": 1201989760, "metainfo": ""}