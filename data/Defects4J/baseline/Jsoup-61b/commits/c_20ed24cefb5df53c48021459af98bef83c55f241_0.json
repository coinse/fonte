{"sha": "20ed24cefb5df53c48021459af98bef83c55f241", "log": "Fixed issue in Entities when unescaping &#36; (\"$\")  Fixes #34", "commit": "\n--- a/src/main/java/org/jsoup/nodes/Entities.java\n+++ b/src/main/java/org/jsoup/nodes/Entities.java\n \n         Matcher m = unescapePattern.matcher(string); // &(#(x|X)?([0-9a-fA-F]+)|[a-zA-Z]+);?\n         StringBuffer accum = new StringBuffer(string.length()); // pity matcher can't use stringbuilder, avoid syncs\n+        // todo: replace m.appendReplacement with own impl, so StringBuilder and quoteReplacement not required\n \n         while (m.find()) {\n             int charval = -1;\n \n             if (charval != -1 || charval > 0xFFFF) { // out of range\n                 String c = Character.toString((char) charval);\n-                m.appendReplacement(accum, c);\n+                m.appendReplacement(accum, Matcher.quoteReplacement(c));\n             } else {\n-                m.appendReplacement(accum, m.group(0)); // replace with original string\n+                m.appendReplacement(accum, Matcher.quoteReplacement(m.group(0))); // replace with original string\n             }\n         }\n         m.appendTail(accum);\n--- a/src/test/java/org/jsoup/integration/ParseTest.java\n+++ b/src/test/java/org/jsoup/integration/ParseTest.java\n         Element headline = doc.select(\"nyt_headline[version=1.0]\").first();\n         assertEquals(\"As BP Lays Out Future, It Will Not Include Hayward\", headline.text());\n     }\n+    \n+    @Test\n+    public void testYahooArticle() throws IOException {\n+        File in = getFile(\"/htmltests/yahoo-article-1.html\");\n+        Document doc = Jsoup.parse(in, \"UTF-8\", \"http://news.yahoo.com/s/nm/20100831/bs_nm/us_gm_china\");\n+        Element p = doc.select(\"p:contains(Volt will be sold in the United States\").first();\n+        assertEquals(\"In July, GM said its electric Chevrolet Volt will be sold in the United States at $41,000 -- $8,000 more than its nearest competitor, the Nissan Leaf.\", p.text());\n+    }\n \n     File getFile(String resourceName) {\n         try {\n--- a/src/test/java/org/jsoup/nodes/EntitiesTest.java\n+++ b/src/test/java/org/jsoup/nodes/EntitiesTest.java\n         String escaped = \"&Uuml; &uuml; &amp; &AMP\";\n         assertEquals(\"\u00dc \u00fc & &\", Entities.unescape(escaped));\n     }\n+    \n+    @Test public void quoteReplacements() {\n+        String escaped = \"&#92; &#36;\";\n+        String unescaped = \"\\\\ $\";\n+        \n+        assertEquals(unescaped, Entities.unescape(escaped));\n+    }\n }", "timestamp": 1309605121, "metainfo": ""}