{"sha": "20002f7f4e971349a1c95dd3b05846c5b824b65c", "log": "Restricted quote stripping to values containing exactly 2 quotes, one at the beginning and one at the end (CLI-185)  ", "commit": "\n--- a/src/java/org/apache/commons/cli/Util.java\n+++ b/src/java/org/apache/commons/cli/Util.java\n      */\n     static String stripLeadingAndTrailingQuotes(String str)\n     {\n-        if (str.startsWith(\"\\\"\"))\n+        int length = str.length();\n+        if (length > 1 && str.startsWith(\"\\\"\") && str.endsWith(\"\\\"\") && str.substring(1, length - 1).indexOf('\"') == -1)\n         {\n-            str = str.substring(1, str.length());\n+            str = str.substring(1, length - 1);\n         }\n-        if (str.endsWith(\"\\\"\"))\n-        {\n-            str = str.substring(0, str.length() - 1);\n-        }\n+        \n         return str;\n     }\n }\n--- a/src/test/org/apache/commons/cli/UtilTest.java\n+++ b/src/test/org/apache/commons/cli/UtilTest.java\n     public void testStripLeadingAndTrailingQuotes()\n     {\n         assertEquals(\"foo\", Util.stripLeadingAndTrailingQuotes(\"\\\"foo\\\"\"));\n+        assertEquals(\"foo \\\"bar\\\"\", Util.stripLeadingAndTrailingQuotes(\"foo \\\"bar\\\"\"));\n+        assertEquals(\"\\\"foo\\\" bar\", Util.stripLeadingAndTrailingQuotes(\"\\\"foo\\\" bar\"));\n+        assertEquals(\"\\\"foo\\\" and \\\"bar\\\"\", Util.stripLeadingAndTrailingQuotes(\"\\\"foo\\\" and \\\"bar\\\"\"));\n+        assertEquals(\"\\\"\", Util.stripLeadingAndTrailingQuotes(\"\\\"\"));\n     }\n }", "timestamp": 1276677318, "metainfo": ""}