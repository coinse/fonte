{"sha": "99aa05af2bfef3980ad8f94230cd077e8d30c5ea", "log": "Fixed PosixParser when an unrecognized long option is found (CLI-165)  ", "commit": "\n--- a/src/java/org/apache/commons/cli/PosixParser.java\n+++ b/src/java/org/apache/commons/cli/PosixParser.java\n             // get the next command line token\n             String token = (String) iter.next();\n \n-            // handle SPECIAL TOKEN\n+            // handle long option --foo or --foo=bar\n             if (token.startsWith(\"--\"))\n             {\n-                if (token.indexOf('=') != -1)\n-                {\n-                    tokens.add(token.substring(0, token.indexOf('=')));\n-                    tokens.add(token.substring(token.indexOf('=') + 1, token.length()));\n+                int pos = token.indexOf('=');\n+                String opt = pos == -1 ? token : token.substring(0, pos); // --foo\n+\n+                if (!options.hasOption(opt) && stopAtNonOption)\n+                {\n+                    process(token);\n                 }\n                 else\n                 {\n-                    tokens.add(token);\n+                    tokens.add(opt);\n+                    if (pos != -1) {\n+                        tokens.add(token.substring(pos + 1));\n+                    }\n                 }\n             }\n \n--- a/src/test/org/apache/commons/cli/PosixParserTest.java\n+++ b/src/test/org/apache/commons/cli/PosixParserTest.java\n         assertTrue(\"Confirm  3 extra args: \" + cl.getArgList().size(), cl.getArgList().size() == 3);\n     }\n \n+    public void testStop3() throws Exception\n+    {\n+        String[] args = new String[]{\"--zop==1\",\n+                                     \"-abtoast\",\n+                                     \"--b=bar\"};\n+\n+        CommandLine cl = parser.parse(options, args, true);\n+\n+        assertFalse(\"Confirm -a is not set\", cl.hasOption(\"a\"));\n+        assertFalse(\"Confirm -b is not set\", cl.hasOption(\"b\"));\n+        assertTrue(\"Confirm  3 extra args: \" + cl.getArgList().size(), cl.getArgList().size() == 3);\n+    }\n+\n     public void testStopBursting() throws Exception\n     {\n         String[] args = new String[] { \"-azc\" };", "timestamp": 1217238425, "metainfo": ""}