{"sha": "2e6b22fa2ef077b630edb36292e002823a54cfab", "log": "Test that GraphAdapterBuilder works with multiple entity types.", "commit": "\n--- a/extras/src/test/java/com/google/gson/graph/GraphAdapterBuilderTest.java\n+++ b/extras/src/test/java/com/google/gson/graph/GraphAdapterBuilderTest.java\n     assertEquals(Collections.emptyList(), listOfLists.get(1));\n   }\n \n+  public void testSerializationWithMultipleTypes() {\n+    Company google = new Company(\"Google\");\n+    new Employee(\"Jesse\", google);\n+    new Employee(\"Joel\", google);\n+\n+    GsonBuilder gsonBuilder = new GsonBuilder();\n+    new GraphAdapterBuilder()\n+        .addType(Company.class)\n+        .addType(Employee.class)\n+        .registerOn(gsonBuilder);\n+    Gson gson = gsonBuilder.create();\n+\n+    assertEquals(\"{'0x1':{'name':'Google','employees':['0x2','0x3']},\"\n+        + \"'0x2':{'name':'Jesse','company':'0x1'},\"\n+        + \"'0x3':{'name':'Joel','company':'0x1'}}\",\n+        gson.toJson(google).replace('\"', '\\''));\n+  }\n+\n+  public void testDeserializationWithMultipleTypes() {\n+    GsonBuilder gsonBuilder = new GsonBuilder();\n+    new GraphAdapterBuilder()\n+        .addType(Company.class)\n+        .addType(Employee.class)\n+        .registerOn(gsonBuilder);\n+    Gson gson = gsonBuilder.create();\n+\n+    String json = \"{'0x1':{'name':'Google','employees':['0x2','0x3']},\"\n+        + \"'0x2':{'name':'Jesse','company':'0x1'},\"\n+        + \"'0x3':{'name':'Joel','company':'0x1'}}\";\n+    Company company = gson.fromJson(json, Company.class);\n+    assertEquals(\"Google\", company.name);\n+    Employee jesse = company.employees.get(0);\n+    assertEquals(\"Jesse\", jesse.name);\n+    assertEquals(company, jesse.company);\n+    Employee joel = company.employees.get(1);\n+    assertEquals(\"Joel\", joel.name);\n+    assertEquals(company, joel.company);\n+  }\n+\n   static class Roshambo {\n     String name;\n     Roshambo beats;\n       this.name = name;\n     }\n   }\n+\n+  static class Employee {\n+    final String name;\n+    final Company company;\n+    Employee(String name, Company company) {\n+      this.name = name;\n+      this.company = company;\n+      this.company.employees.add(this);\n+    }\n+  }\n+\n+  static class Company {\n+    final String name;\n+    final List<Employee> employees = new ArrayList<Employee>();\n+    Company(String name) {\n+      this.name = name;\n+    }\n+  }\n }", "timestamp": 1325433449, "metainfo": ""}