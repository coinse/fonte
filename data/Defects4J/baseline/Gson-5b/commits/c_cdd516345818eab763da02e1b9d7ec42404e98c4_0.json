{"sha": "cdd516345818eab763da02e1b9d7ec42404e98c4", "log": "fix for bug 56 where Gson wasn't serialization null fields of type string, collection and arrays properly even when serializeNulls was set.", "commit": "\n--- a/gson/src/main/java/com/google/gson/JsonSerializationVisitor.java\n+++ b/gson/src/main/java/com/google/gson/JsonSerializationVisitor.java\n   }\n \n   public void visitArrayField(Field f, Type typeOfF, Object obj) {\n-    if (!isFieldNull(f, obj)) {\n+    if (isFieldNull(f, obj)) {\n+      if (serializeNulls) {\n+        addChildAsElement(f, new JsonNull());\n+      }\n+    } else {\n       Object array = getFieldValue(f, obj);\n       addAsChildOfObject(f, typeOfF, array);\n     }\n   }\n \n   public void visitCollectionField(Field f, Type typeOfF, Object obj) {\n-    if (!isFieldNull(f, obj)) {\n+    if (isFieldNull(f, obj)) {\n+      if (serializeNulls) {\n+        addChildAsElement(f, new JsonNull());\n+      }\n+    } else {\n       if (typeOfF == null) {\n         throw new RuntimeException(\"Can not handle non-generic collections\");\n       }\n     return childVisitor.getJsonElement();\n   }\n \n-  public void visitPrimitiveField(Field f, Type typeOfF, Object obj) {\n-    if (!isFieldNull(f, obj)) {\n+  public void visitPrimitiveField(Field f, Type typeOfF, Object obj) {    \n+    if (isFieldNull(f, obj)) {\n+      if (serializeNulls) {\n+        addChildAsElement(f, new JsonNull());\n+      }      \n+    } else {\n       TypeInfo typeInfo = new TypeInfo(typeOfF);\n       if (typeInfo.isPrimitiveOrStringAndNotAnArray()) {\n         Object fieldValue = getFieldValue(f, obj);", "timestamp": 1223678026, "metainfo": ""}