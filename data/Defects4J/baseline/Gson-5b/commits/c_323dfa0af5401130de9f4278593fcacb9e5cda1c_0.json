{"sha": "323dfa0af5401130de9f4278593fcacb9e5cda1c", "log": "Be strict in TypeAdapter's toJson/fromJson methods", "commit": "\n--- a/gson/src/main/java/com/google/gson/TypeAdapter.java\n+++ b/gson/src/main/java/com/google/gson/TypeAdapter.java\n   public final JsonElement toJsonTree(T value) {\n     try {\n       JsonTreeWriter jsonWriter = new JsonTreeWriter();\n-      jsonWriter.setLenient(true);\n       write(jsonWriter, value);\n       return jsonWriter.get();\n     } catch (IOException e) {\n    */\n   public final T fromJson(Reader in) throws IOException {\n     JsonReader reader = new JsonReader(in);\n-    reader.setLenient(true); // TODO: non-lenient?\n     return read(reader);\n   }\n \n   public final T fromJsonTree(JsonElement jsonTree) {\n     try {\n       JsonReader jsonReader = new JsonTreeReader(jsonTree);\n-      jsonReader.setLenient(true);\n       return read(jsonReader);\n     } catch (IOException e) {\n       throw new JsonIOException(e);\n--- a/gson/src/test/java/com/google/gson/ObjectTypeAdapterTest.java\n+++ b/gson/src/test/java/com/google/gson/ObjectTypeAdapterTest.java\n   private final TypeAdapter<Object> adapter = gson.getAdapter(Object.class);\n \n   public void testDeserialize() throws Exception {\n-    Map<?, ?> map = (Map<?, ?>) adapter.fromJson(\"{a: 5, b: [1, 2, null], c: {x: y}}\");\n+    Map<?, ?> map = (Map<?, ?>) adapter.fromJson(\"{\\\"a\\\":5,\\\"b\\\":[1,2,null],\\\"c\\\":{\\\"x\\\":\\\"y\\\"}}\");\n     assertEquals(5.0, map.get(\"a\"));\n     assertEquals(Arrays.asList(1.0, 2.0, null), map.get(\"b\"));\n     assertEquals(Collections.singletonMap(\"x\", \"y\"), map.get(\"c\"));", "timestamp": 1325421402, "metainfo": ""}