{"sha": "425a59043d2bbae074335436e830e3b59dfe9278", "log": "Added an example of a servlet class that uses Gson for web-service implementation.", "commit": "\n--- /dev/null\n+++ b/wsexample/server/src/main/java/com/google/gson/wsexample/server/MainServlet.java\n+// Copyright 2010 Google Inc. All Rights Reserved.\n+\n+package com.google.gson.wsexample.server;\n+\n+import com.google.gson.Gson;\n+import com.google.gson.GsonBuilder;\n+import com.google.gson.example.model.Cart;\n+import com.google.gson.example.model.Order;\n+import com.google.gson.example.model.TypedKeys;\n+import com.google.gson.example.service.SampleJsonService;\n+import com.google.gson.webservice.definition.HeaderMap;\n+import com.google.gson.webservice.definition.RequestBody;\n+import com.google.gson.webservice.definition.RequestSpec;\n+import com.google.gson.webservice.definition.ResponseBody;\n+import com.google.gson.webservice.definition.ResponseSpec;\n+import com.google.gson.webservice.definition.WebServiceCallSpec;\n+import com.google.gson.webservice.definition.WebServiceRequest;\n+import com.google.gson.webservice.definition.WebServiceResponse;\n+import com.google.gson.webservice.typeadapters.RequestBodyGsonConverter;\n+import com.google.gson.webservice.typeadapters.ResponseBodyGsonConverter;\n+import com.google.gson.wsf.server.RequestReceiver;\n+import com.google.gson.wsf.server.ResponseSender;\n+\n+import javax.servlet.http.HttpServlet;\n+import javax.servlet.http.HttpServletRequest;\n+import javax.servlet.http.HttpServletResponse;\n+\n+/**\n+ * An example servlet that receives JSON web-service requests\n+ *\n+ * @author inder\n+ */\n+public class MainServlet extends HttpServlet {\n+  @Override\n+  public void service(HttpServletRequest req, HttpServletResponse res) {\n+    // construct specs\n+    WebServiceCallSpec spec = SampleJsonService.PLACE_ORDER;\n+    RequestSpec requestSpec = spec.getRequestSpec();\n+    ResponseSpec responseSpec = spec.getResponseSpec();\n+    // construct gson instance\n+    Gson gson = new GsonBuilder()\n+        .registerTypeAdapter(RequestBody.class,\n+            new RequestBodyGsonConverter(requestSpec.getBodySpec()))\n+        .registerTypeAdapter(ResponseBody.class, \n+            new ResponseBodyGsonConverter(responseSpec.getBodySpec()))\n+        .create();\n+    RequestReceiver requestReceiver = new RequestReceiver(gson, requestSpec);\n+    WebServiceRequest webServiceRequest = requestReceiver.receive(req);\n+    RequestBody requestBody = webServiceRequest.getBody();\n+    Cart cart = requestBody.get(TypedKeys.RequestBody.CART);\n+    String authToken = webServiceRequest.getHeader(TypedKeys.Request.AUTH_TOKEN);\n+    Order order = placeOrder(cart, authToken);\n+\n+    HeaderMap responseHeaders = new HeaderMap.Builder(responseSpec.getHeadersSpec()).build();\n+    ResponseBody responseBody = new ResponseBody.Builder(responseSpec.getBodySpec())\n+        .put(TypedKeys.ResponseBody.ORDER, order)\n+        .build();\n+    WebServiceResponse response = new WebServiceResponse(responseHeaders, responseBody);\n+    ResponseSender responseSender = new ResponseSender(gson);\n+    responseSender.send(res, response);\n+  }\n+  \n+  private Order placeOrder(Cart cart, String authToken) {\n+    return new Order(cart, \"Order123\");\n+  }\n+}", "timestamp": 1279585893, "metainfo": ""}