{"sha": "c01af2290073af0ea42eb02dfe965b4cda58e112", "log": "Fix absolute URL resolution issue when a base tag has no href.", "commit": "\n--- a/src/main/java/org/jsoup/parser/Parser.java\n+++ b/src/main/java/org/jsoup/parser/Parser.java\n \n         // <base href>: update the base uri\n         if (child.tagName().equals(\"base\")) {\n-            baseUri = child.absUrl(\"href\");\n-            doc.setBaseUri(baseUri); // set on the doc so doc.createElement(Tag) will get updated base\n+            String href = child.absUrl(\"href\");\n+            if (!href.isEmpty()) { // ignore <base target> etc\n+                baseUri = href;\n+                doc.setBaseUri(href); // set on the doc so doc.createElement(Tag) will get updated base\n+            }\n         }\n \n         addChildToParent(child, isEmptyElement);\n--- a/src/test/java/org/jsoup/parser/ParserTest.java\n+++ b/src/test/java/org/jsoup/parser/ParserTest.java\n         assertEquals(\"b\", a.child(0).child(0).tagName());\n     }\n \n+    @Test public void handlesBaseWithoutHref() {\n+        String h = \"<head><base target='_blank'></head><body><a href=/foo>Test</a></body>\";\n+        Document doc = Jsoup.parse(h, \"http://example.com/\");\n+        Element a = doc.select(\"a\").first();\n+        assertEquals(\"/foo\", a.attr(\"href\"));\n+        assertEquals(\"http://example.com/foo\", a.attr(\"abs:href\"));\n+    }\n+\n \n }", "timestamp": 1309605109, "metainfo": ""}