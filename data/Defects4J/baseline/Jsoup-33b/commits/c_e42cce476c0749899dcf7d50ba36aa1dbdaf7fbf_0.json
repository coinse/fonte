{"sha": "e42cce476c0749899dcf7d50ba36aa1dbdaf7fbf", "log": "Allow <a> and <font> elements to be treated as flow/block elements, to match browser parse trees.", "commit": "\n--- a/src/main/java/org/jsoup/parser/Tag.java\n+++ b/src/main/java/org/jsoup/parser/Tag.java\n         createBlock(\"FOOTER\").setExcludes(\"HEADER\", \"FOOTER\");\n \n         // fontstyle\n-        createInline(\"FONT\");\n+        createInline(\"FONT\").setOptionalClosing().setCanContainBlock().setFormatAsInline();\n         createInline(\"TT\");\n         createInline(\"I\");\n         createInline(\"B\");\n         createInline(\"RP\").setParent(\"RUBY\").setExcludes(\"RT\", \"RP\");\n \n         // special\n-        createInline(\"A\").setOptionalClosing(); // cannot contain self\n+        createInline(\"A\").setOptionalClosing().setCanContainBlock().setFormatAsInline(); // cannot contain self\n         createInline(\"IMG\").setEmpty().setAncestor(\"BODY\", \"NOSCRIPT\"); // noscript so an image can be in html->head->noscript\n         createInline(\"BR\").setEmpty();\n         createInline(\"WBR\").setEmpty();\n--- a/src/test/java/org/jsoup/parser/ParserTest.java\n+++ b/src/test/java/org/jsoup/parser/ParserTest.java\n         Document doc = Jsoup.parse(\"<span>Hello <div>there</div> <span>now</span></span>\");\n         assertEquals(\"<span>Hello <div>there</div> <span>now</span></span>\", TextUtil.stripNewlines(doc.body().html()));\n     }\n+\n+    @Test public void testAllowsImageInNoScriptInHead() {\n+        // some sites use this pattern as an analytics mechanism\n+        Document doc = Jsoup.parse(\"<html><head><noscript><img src='foo'></noscript></head><body><p>Hello</p></body></html>\");\n+        assertEquals(\"<html><head><noscript><img src=\\\"foo\\\" /></noscript></head><body><p>Hello</p></body></html>\", TextUtil.stripNewlines(doc.html()));\n+    }\n+\n+    @Test public void testAFlowContents() {\n+        // html5 has <a> as either phrasing or block\n+        Document doc = Jsoup.parse(\"<a>Hello <div>there</div> <span>now</span></a>\");\n+        assertEquals(\"<a>Hello <div>there</div> <span>now</span></a>\", TextUtil.stripNewlines(doc.body().html()));\n+    }\n+\n+     @Test public void testFontFlowContents() {\n+        // html5 has no definition of <font>; often used as flow\n+        Document doc = Jsoup.parse(\"<font>Hello <div>there</div> <span>now</span></font>\");\n+        assertEquals(\"<font>Hello <div>there</div> <span>now</span></font>\", TextUtil.stripNewlines(doc.body().html()));\n+    }\n }", "timestamp": 1309605127, "metainfo": ""}