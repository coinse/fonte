{"sha": "ce4e72701b1ad4caabc3bd668bd058fff082f2b6", "log": "CSV-112: HeaderMap is inconsistent when it is parsed from an input with duplicate columns names. Reported by Romain Goss\u00e9  ", "commit": "\n--- a/src/main/java/org/apache/commons/csv/CSVParser.java\n+++ b/src/main/java/org/apache/commons/csv/CSVParser.java\n import java.net.URL;\n import java.nio.charset.Charset;\n import java.util.ArrayList;\n+import java.util.Arrays;\n import java.util.Collection;\n import java.util.Iterator;\n import java.util.LinkedHashMap;\n             // build the name to index mappings\n             if (header != null) {\n                 for (int i = 0; i < header.length; i++) {\n+                    if (hdrMap.containsKey(header[i])) {\n+                        throw new IllegalStateException(\"The header contains duplicate names: \" + Arrays.toString(header));\n+                    }\n                     hdrMap.put(header[i], Integer.valueOf(i));\n                 }\n             }\n--- a/src/test/java/org/apache/commons/csv/CSVParserTest.java\n+++ b/src/test/java/org/apache/commons/csv/CSVParserTest.java\n         parser.close();\n     }\n \n+    @Test(expected = IllegalStateException.class)\n+    public void testDuplicateHeaderEntries() throws Exception {\n+        CSVParser.parse(\"a,b,a\\n1,2,3\\nx,y,z\", CSVFormat.DEFAULT.withHeader(new String[]{}));\n+    }\n+\n     @Test\n     public void testGetLine() throws IOException {\n         final CSVParser parser = CSVParser.parse(CSV_INPUT, CSVFormat.DEFAULT.withIgnoreSurroundingSpaces(true));", "timestamp": 1399220554, "metainfo": ""}