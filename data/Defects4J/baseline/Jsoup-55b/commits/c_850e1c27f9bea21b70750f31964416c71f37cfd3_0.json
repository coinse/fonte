{"sha": "850e1c27f9bea21b70750f31964416c71f37cfd3", "log": "Test for Issue#478 (class names must not be cached)", "commit": "\n--- a/src/test/java/org/jsoup/nodes/ElementTest.java\n+++ b/src/test/java/org/jsoup/nodes/ElementTest.java\n import static org.junit.Assert.*;\n \n import java.util.ArrayList;\n+import java.util.LinkedHashSet;\n import java.util.List;\n import java.util.Set;\n import java.util.Map;\n         assertTrue(divC == doc.select(divC.cssSelector()).first());\n     }\n \n+\n+    @Test\n+    public void testClassNames() {\n+        Document doc = Jsoup.parse(\"<div class=\\\"c1 c2\\\">C</div>\");\n+        Element div = doc.select(\"div\").get(0);\n+\n+        assertEquals(\"c1 c2\", div.className());\n+\n+        final Set<String> set1 = div.classNames();\n+        final Object[] arr1 = set1.toArray();\n+        assertTrue(arr1.length==2);\n+        assertEquals(\"c1\", arr1[0]);\n+        assertEquals(\"c2\", arr1[1]);\n+\n+        // Changes to the set should not be reflected in the Elements getters\n+       \tset1.add(\"c3\");\n+        assertTrue(2==div.classNames().size());\n+        assertEquals(\"c1 c2\", div.className());\n+\n+        // Update the class names to a fresh set\n+        final Set<String> newSet = new LinkedHashSet<String>(3);\n+        newSet.addAll(set1);\n+        newSet.add(\"c3\");\n+        \n+        div.classNames(newSet);\n+\n+        \n+        assertEquals(\"c1 c2 c3\", div.className());\n+\n+        final Set<String> set2 = div.classNames();\n+        final Object[] arr2 = set2.toArray();\n+        assertTrue(arr2.length==3);\n+        assertEquals(\"c1\", arr2[0]);\n+        assertEquals(\"c2\", arr2[1]);\n+        assertEquals(\"c3\", arr2[2]);\n+    }\n }", "timestamp": 1413663477, "metainfo": ""}