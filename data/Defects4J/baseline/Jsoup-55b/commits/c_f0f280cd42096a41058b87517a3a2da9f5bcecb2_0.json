{"sha": "f0f280cd42096a41058b87517a3a2da9f5bcecb2", "log": "HTML5 tag support", "commit": "\n--- a/src/main/java/org/jsoup/parser/Tag.java\n+++ b/src/main/java/org/jsoup/parser/Tag.java\n         createBlock(\"FRAME\").setParent(\"FRAMESET\").setEmpty();\n         createBlock(\"NOFRAMES\").setParent(\"FRAMESET\").setContainDataOnly();\n \n-\n+        // html5 sections\n+        createBlock(\"SECTION\");\n+        createBlock(\"NAV\");\n+        createBlock(\"ASIDE\");\n+        createBlock(\"HGROUP\").setLimitChildren(); // limited to h1 - h6\n+        createBlock(\"HEADER\").setExcludes(\"HEADER\", \"FOOTER\");\n+        createBlock(\"FOOTER\").setExcludes(\"HEADER\", \"FOOTER\");\n \n         // fontstyle\n         createInline(\"FONT\");\n         // phrase\n         createInline(\"EM\");\n         createInline(\"STRONG\");\n-        createInline(\"DFN\");\n+        createInline(\"DFN\").setOptionalClosing();\n         createInline(\"CODE\");\n         createInline(\"SAMP\");\n         createInline(\"KBD\");\n         createInline(\"VAR\");\n         createInline(\"CITE\");\n         createInline(\"ABBR\");\n+        createInline(\"TIME\").setOptionalClosing();\n         createInline(\"ACRONYM\");\n+        createInline(\"MARK\");\n+        \n+        // ruby\n+        createInline(\"RUBY\");\n+        createInline(\"RT\").setParent(\"RUBY\").setExcludes(\"RT\", \"RP\");\n+        createInline(\"RP\").setParent(\"RUBY\").setExcludes(\"RT\", \"RP\");\n \n         // special\n         createInline(\"A\").setOptionalClosing(); // cannot contain self\n         createInline(\"IMG\").setEmpty();\n         createInline(\"BR\").setEmpty();\n+        createInline(\"WBR\").setEmpty();\n         createInline(\"MAP\"); // map is defined as inline, but can hold block (what?) or area. Seldom used so NBD.\n         createInline(\"Q\");\n         createInline(\"SUB\");\n         createInline(\"SUP\");\n         createInline(\"SPAN\");\n         createInline(\"BDO\");\n+        createInline(\"IFRAME\").setOptionalClosing();\n+        createInline(\"EMBED\").setEmpty();\n \n         // things past this point aren't really blocks or inline. I'm using them because they can hold block or inline,\n         // but per the spec, only specific elements can hold this. if this becomes a real-world parsing problem,\n \n         // block\n         createBlock(\"P\").setContainInlineOnly(); // emasculated block?\n-        createBlock(\"H1\").setContainInlineOnly();\n-        createBlock(\"H2\").setContainInlineOnly();\n-        createBlock(\"H3\").setContainInlineOnly();\n-        createBlock(\"H4\").setContainInlineOnly();\n-        createBlock(\"H5\").setContainInlineOnly();\n-        createBlock(\"H6\").setContainInlineOnly();\n+        createBlock(\"H1\").setAncestor(\"BODY\", \"HGROUP\").setContainInlineOnly();\n+        createBlock(\"H2\").setAncestor(\"BODY\", \"HGROUP\").setContainInlineOnly();\n+        createBlock(\"H3\").setAncestor(\"BODY\", \"HGROUP\").setContainInlineOnly();\n+        createBlock(\"H4\").setAncestor(\"BODY\", \"HGROUP\").setContainInlineOnly();\n+        createBlock(\"H5\").setAncestor(\"BODY\", \"HGROUP\").setContainInlineOnly();\n+        createBlock(\"H6\").setAncestor(\"BODY\", \"HGROUP\").setContainInlineOnly();\n         createBlock(\"UL\");\n         createBlock(\"OL\");\n         createBlock(\"PRE\").setContainInlineOnly().setPreserveWhitespace();\n         createBlock(\"BLOCKQUOTE\");\n         createBlock(\"HR\").setEmpty();\n         createBlock(\"ADDRESS\").setContainInlineOnly();\n-\n+        createBlock(\"FIGURE\");\n+        createBlock(\"FIGCAPTION\").setAncestor(\"FIGURE\");\n \n         // formctrl\n         createBlock(\"FORM\").setOptionalClosing(); // can't contain self\n         createInline(\"LABEL\").setAncestor(\"FORM\").setOptionalClosing(); // not self\n         createInline(\"BUTTON\").setAncestor(\"FORM\"); // bunch of excludes not defined\n         createInline(\"OPTGROUP\").setParent(\"SELECT\"); //  only contain option\n-        createInline(\"OPTION\").setParent(\"SELECT\", \"OPTGROUP\").setOptionalClosing();\n+        createInline(\"OPTION\").setParent(\"SELECT\", \"OPTGROUP\", \"DATALIST\").setOptionalClosing();\n         createBlock(\"FIELDSET\").setAncestor(\"FORM\");\n         createInline(\"LEGEND\").setAncestor(\"FIELDSET\");\n+        \n+        // html5 form ctrl, not specced to have to be in forms\n+        createInline(\"DATALIST\");\n+        createInline(\"KEYGEN\").setEmpty();\n+        createInline(\"OUTPUT\");\n+        createInline(\"PROGRESS\").setOptionalClosing();\n+        createInline(\"METER\").setOptionalClosing();\n \n         // other\n-        createInline(\"AREA\").setEmpty(); // not an inline per-se\n+        createInline(\"AREA\").setAncestor(\"MAP\").setEmpty(); // not an inline per-se\n         createInline(\"PARAM\").setParent(\"OBJECT\").setEmpty();\n         createBlock(\"INS\"); // only within body\n         createBlock(\"DEL\"); // only within body\n         createBlock(\"TR\").setParent(\"TBODY\", \"THEAD\", \"TFOOT\", \"TABLE\").setLimitChildren().setOptionalClosing(); // just TH, TD\n         createBlock(\"TH\").setParent(\"TR\").setExcludes(\"THEAD\", \"TFOOT\", \"TBODY\", \"COLGROUP\", \"COL\", \"TR\", \"TH\", \"TD\").setOptionalClosing();\n         createBlock(\"TD\").setParent(\"TR\").setExcludes(\"THEAD\", \"TFOOT\", \"TBODY\", \"COLGROUP\", \"COL\", \"TR\", \"TH\", \"TD\").setOptionalClosing();\n+        \n+        // html5 media\n+        createBlock(\"VIDEO\").setExcludes(\"VIDEO\", \"AUDIO\");\n+        createBlock(\"AUDIO\").setExcludes(\"VIDEO\", \"AUDIO\");\n+        createInline(\"SOURCE\").setParent(\"VIDEO\", \"AUDIO\").setEmpty();\n+        createInline(\"TRACK\").setParent(\"VIDEO\", \"AUDIO\").setEmpty();\n+        createBlock(\"CANVAS\");\n+        \n+        // html5 interactive\n+        createBlock(\"DETAILS\");\n+        createInline(\"SUMMARY\").setParent(\"DETAILS\");\n+        createInline(\"COMMAND\").setEmpty();\n+        createBlock(\"MENU\");\n+        createInline(\"DEVICE\").setEmpty();\n     }\n \n     private static Tag createBlock(String tagName) {\n--- a/src/test/java/org/jsoup/parser/ParserTest.java\n+++ b/src/test/java/org/jsoup/parser/ParserTest.java\n         Document doc = Jsoup.parse(h);\n         assertEquals(\"gb2312\", doc.select(\"meta\").attr(\"charset\"));\n     }\n-\n+    \n+    @Test public void testHgroup() {\n+        Document doc = Jsoup.parse(\"<h1>Hello <h2>There <hgroup><h1>Another<h2>headline</hgroup> <hgroup><h1>More</h1><p>stuff</p></hgroup>\");\n+        assertEquals(\"<h1>Hello </h1><h2>There </h2><hgroup><h1>Another</h1><h2>headline</h2></hgroup> <hgroup><h1>More</h1></hgroup><p>stuff</p>\", TextUtil.stripNewlines(doc.body().html()));\n+    }\n+    \n \n }", "timestamp": 1309605116, "metainfo": ""}