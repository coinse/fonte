{"sha": "ec48e0cc39d86f95f7b9184aeb1891d721109e55", "log": "Check bounds of document before fetching first child  Fixes #727, OOB on empty body XML load.", "commit": "\n--- a/src/main/java/org/jsoup/helper/DataUtil.java\n+++ b/src/main/java/org/jsoup/helper/DataUtil.java\n                 }\n             }\n             // look for <?xml encoding='ISO-8859-1'?>\n-            if (foundCharset == null && doc.childNode(0) instanceof XmlDeclaration) {\n+            if (foundCharset == null && doc.childNodeSize() > 0 && doc.childNode(0) instanceof XmlDeclaration) {\n                 XmlDeclaration prolog = (XmlDeclaration) doc.childNode(0);\n                 if (prolog.name().equals(\"xml\")) {\n                     foundCharset = prolog.attr(\"encoding\");\n--- a/src/test/java/org/jsoup/integration/UrlConnectTest.java\n+++ b/src/test/java/org/jsoup/integration/UrlConnectTest.java\n     }\n \n     @Test\n-    public void ignores500NoWithContentExceptionIfSoConfigured() throws IOException {\n+    public void ignores500WithNoContentExceptionIfSoConfigured() throws IOException {\n         Connection con = Jsoup.connect(\"http://direct.infohound.net/tools/500-no-content.pl\").ignoreHttpErrors(true);\n         Connection.Response res = con.execute();\n         Document doc = res.parse();\n     }\n \n     @Test\n-    public void ignores200NoWithContentExceptionIfSoConfigured() throws IOException {\n+    public void ignores200WithNoContentExceptionIfSoConfigured() throws IOException {\n         Connection con = Jsoup.connect(\"http://direct.infohound.net/tools/200-no-content.pl\").ignoreHttpErrors(true);\n         Connection.Response res = con.execute();\n         Document doc = res.parse();\n         assertEquals(200, res.statusCode());\n         assertEquals(\"All Good\", res.statusMessage());\n+    }\n+\n+    @Test\n+    public void handles200WithNoContent() throws IOException {\n+        Connection con = Jsoup\n+            .connect(\"http://direct.infohound.net/tools/200-no-content.pl\")\n+            .userAgent(browserUa);\n+        Connection.Response res = con.execute();\n+        Document doc = res.parse();\n+        assertEquals(200, res.statusCode());\n+\n+        con = Jsoup\n+            .connect(\"http://direct.infohound.net/tools/200-no-content.pl\")\n+            .parser(Parser.xmlParser())\n+            .userAgent(browserUa);\n+        res = con.execute();\n+        doc = res.parse();\n+        assertEquals(200, res.statusCode());\n     }\n \n     @Test", "timestamp": 1470945434, "metainfo": ""}