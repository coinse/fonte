{"sha": "1fe66196eb029b9e54afd42e8a2be7d09e38f9df", "log": "Minor fixes to name annotation handling", "commit": "\n--- a/src/main/java/com/fasterxml/jackson/databind/AnnotationIntrospector.java\n+++ b/src/main/java/com/fasterxml/jackson/databind/AnnotationIntrospector.java\n      */\n     public PropertyName findNameForSerialization(Annotated a)\n     {\n+        // [Issue#69], need bit of delegation \n+        // !!! TODO: in 2.2, remove old methods?\n+        String name;\n+        if (a instanceof AnnotatedField) {\n+            name = findSerializationName((AnnotatedField) a);\n+        } else if (a instanceof AnnotatedMethod) {\n+            name = findSerializationName((AnnotatedMethod) a);\n+        } else {\n+            name = null;\n+        }\n+        if (name != null) {\n+            if (name.length() == 0) { // empty String means 'default'\n+                return PropertyName.USE_DEFAULT;\n+            }\n+            return new PropertyName(name);\n+        }\n         return null;\n     }\n     \n      * \n      * @since 2.1\n      */\n-    public PropertyName findNameForDeserialization(Annotated a) {\n+    public PropertyName findNameForDeserialization(Annotated a)\n+    {\n+        // [Issue#69], need bit of delegation \n+        // !!! TODO: in 2.2, remove old methods?\n+        String name;\n+        if (a instanceof AnnotatedField) {\n+            name = findDeserializationName((AnnotatedField) a);\n+        } else if (a instanceof AnnotatedMethod) {\n+            name = findDeserializationName((AnnotatedMethod) a);\n+        } else if (a instanceof AnnotatedParameter) {\n+            name = findDeserializationName((AnnotatedParameter) a);\n+        } else {\n+            name = null;\n+        }\n+        if (name != null) {\n+            if (name.length() == 0) { // empty String means 'default'\n+                return PropertyName.USE_DEFAULT;\n+            }\n+            return new PropertyName(name);\n+        }\n         return null;\n     }\n     \n         @Override\n         public PropertyName findNameForSerialization(Annotated a) {\n             PropertyName n = _primary.findNameForSerialization(a);\n-            if (n != null) {\n+            // note: \"use default\" should not block explicit answer, so:\n+            if (n == null) {\n                 n = _secondary.findNameForSerialization(a);\n+            } else if (n == PropertyName.USE_DEFAULT) {\n+                PropertyName n2 = _secondary.findNameForSerialization(a);\n+                if (n2 != null) {\n+                    n = n2;\n+                }\n             }\n             return n;\n         }\n         @Override\n         public PropertyName findNameForDeserialization(Annotated a)\n         {\n+            // note: \"use default\" should not block explicit answer, so:\n             PropertyName n = _primary.findNameForDeserialization(a);\n             if (n != null) {\n                 n = _secondary.findNameForDeserialization(a);\n+            } else if (n == PropertyName.USE_DEFAULT) {\n+                PropertyName n2 = _secondary.findNameForDeserialization(a);\n+                if (n2 != null) {\n+                    n = n2;\n+                }\n             }\n             return n;\n         }\n-\n+        \n         @Override\n         public String findDeserializationName(AnnotatedMethod am)\n         {", "timestamp": 1346823541, "metainfo": ""}