{"sha": "3b041e3bad5968ade7f7519daeef6695a8f6b7f9", "log": "Fix #667", "commit": "\n--- a/src/main/java/com/fasterxml/jackson/databind/deser/impl/CreatorCollector.java\n+++ b/src/main/java/com/fasterxml/jackson/databind/deser/impl/CreatorCollector.java\n         AnnotatedWithParams oldOne = _creators[typeIndex];\n         // already had an explicitly marked one?\n         if (oldOne != null) {\n+            boolean verify;\n+\n             if ((_explicitCreators & mask) != 0) { // already had explicitly annotated, leave as-is\n                 // but skip, if new one not annotated\n                 if (!explicit) {\n                     return;\n                 }\n-            }\n+                // both explicit: verify\n+                verify = true;\n+            } else {\n+                // otherwise only verify if neither explicitly annotated.\n+                verify = !explicit;\n+            }\n+\n             // one more thing: ok to override in sub-class\n-            if (oldOne.getClass() == newOne.getClass()) {\n-                throw new IllegalArgumentException(\"Conflicting \"+TYPE_DESCS[typeIndex]\n-                        +\" creators: already had explicitly marked \"+oldOne+\", encountered \"+newOne);\n+            if (verify && (oldOne.getClass() == newOne.getClass())) {\n+                // [databind#667]: avoid one particular class of bogus problems\n+                Class<?> oldType = oldOne.getRawParameterType(0);\n+                Class<?> newType = newOne.getRawParameterType(0);\n+\n+                if (oldType == newType) {\n+                    throw new IllegalArgumentException(\"Conflicting \"+TYPE_DESCS[typeIndex]\n+                            +\" creators: already had explicitly marked \"+oldOne+\", encountered \"+newOne);\n+                }\n+                // otherwise, which one to choose?\n+                if (newType.isAssignableFrom(oldType)) {\n+                    // new type more generic, use old\n+                    return;\n+                }\n+                // new type more specific, use it\n             }\n         }\n         if (explicit) {\n--- a/src/test/java/com/fasterxml/jackson/databind/deser/TestJdkTypes.java\n+++ b/src/test/java/com/fasterxml/jackson/databind/deser/TestJdkTypes.java\n         assertEquals(0, result.remaining());\n     }\n \n+    public void testStringBuilder() throws Exception\n+    {\n+        StringBuilder sb = MAPPER.readValue(quote(\"abc\"), StringBuilder.class);\n+        assertEquals(\"abc\", sb.toString());\n+    }\n+    \n     // [Issue#429]\n     public void testStackTraceElementWithCustom() throws Exception\n     {", "timestamp": 1420241936, "metainfo": ""}