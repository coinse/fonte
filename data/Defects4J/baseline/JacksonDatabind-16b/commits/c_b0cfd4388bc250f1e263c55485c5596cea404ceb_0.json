{"sha": "b0cfd4388bc250f1e263c55485c5596cea404ceb", "log": "Fix deserialization of null values for collection/array type deserializers * All of these deserializers should ask the encapsulated valueDeserializer for its nullValue when `VALUE_NULL` is encountered, rather than assuming a return value of `null`. * This is a bug that affects the ser/deser of `Collection[Option[_]]` in scala, as `None` values are serialized to `null` and deserialized back to `null` rather than `None`, which is correctly overriden in `OptionDeserializer` * Note I am a first time committer and happy to sign any release. Thanks!", "commit": "\n--- a/src/main/java/com/fasterxml/jackson/databind/deser/std/ArrayBlockingQueueDeserializer.java\n+++ b/src/main/java/com/fasterxml/jackson/databind/deser/std/ArrayBlockingQueueDeserializer.java\n             Object value;\n             \n             if (t == JsonToken.VALUE_NULL) {\n-                value = null;\n+                value = valueDes.getNullValue();\n             } else if (typeDeser == null) {\n                 value = valueDes.deserialize(jp, ctxt);\n             } else {\n--- a/src/main/java/com/fasterxml/jackson/databind/deser/std/CollectionDeserializer.java\n+++ b/src/main/java/com/fasterxml/jackson/databind/deser/std/CollectionDeserializer.java\n             try {\n                 Object value;\n                 if (t == JsonToken.VALUE_NULL) {\n-                    value = null;\n+                    value = valueDes.getNullValue();\n                 } else if (typeDeser == null) {\n                     value = valueDes.deserialize(jp, ctxt);\n                 } else {\n         Object value;\n         \n         if (t == JsonToken.VALUE_NULL) {\n-            value = null;\n+            value = valueDes.getNullValue();\n         } else if (typeDeser == null) {\n             value = valueDes.deserialize(jp, ctxt);\n         } else {\n--- a/src/main/java/com/fasterxml/jackson/databind/deser/std/EnumMapDeserializer.java\n+++ b/src/main/java/com/fasterxml/jackson/databind/deser/std/EnumMapDeserializer.java\n             Object value;\n             \n             if (t == JsonToken.VALUE_NULL) {\n-                value = null;\n+                value = valueDes.getNullValue();\n             } else if (typeDeser == null) {\n                 value =  valueDes.deserialize(jp, ctxt);\n             } else {\n--- a/src/main/java/com/fasterxml/jackson/databind/deser/std/MapDeserializer.java\n+++ b/src/main/java/com/fasterxml/jackson/databind/deser/std/MapDeserializer.java\n                 // Note: must handle null explicitly here; value deserializers won't\n                 Object value;\n                 if (t == JsonToken.VALUE_NULL) {\n-                    value = null;\n+                    value = valueDes.getNullValue();\n                 } else if (typeDeser == null) {\n                     value = valueDes.deserialize(jp, ctxt);\n                 } else {\n                 // Note: must handle null explicitly here; value deserializers won't\n                 Object value;\n                 if (t == JsonToken.VALUE_NULL) {\n-                    value = null;\n+                    value = valueDes.getNullValue();\n                 } else if (typeDeser == null) {\n                     value = valueDes.deserialize(jp, ctxt);\n                 } else {\n             Object key = _keyDeserializer.deserializeKey(fieldName, ctxt);\n             Object value;            \n             if (t == JsonToken.VALUE_NULL) {\n-                value = null;\n+                value = valueDes.getNullValue();\n             } else if (typeDeser == null) {\n                 value = valueDes.deserialize(jp, ctxt);\n             } else {\n--- a/src/main/java/com/fasterxml/jackson/databind/deser/std/ObjectArrayDeserializer.java\n+++ b/src/main/java/com/fasterxml/jackson/databind/deser/std/ObjectArrayDeserializer.java\n             Object value;\n             \n             if (t == JsonToken.VALUE_NULL) {\n-                value = null;\n+                value = _elementDeserializer.getNullValue();\n             } else if (typeDeser == null) {\n                 value = _elementDeserializer.deserialize(jp, ctxt);\n             } else {\n         Object value;\n         \n         if (t == JsonToken.VALUE_NULL) {\n-            value = null;\n+            value = _elementDeserializer.getNullValue();\n         } else if (_elementTypeDeserializer == null) {\n             value = _elementDeserializer.deserialize(jp, ctxt);\n         } else {\n--- a/src/main/java/com/fasterxml/jackson/databind/deser/std/StringArrayDeserializer.java\n+++ b/src/main/java/com/fasterxml/jackson/databind/deser/std/StringArrayDeserializer.java\n             if (t == JsonToken.VALUE_STRING) {\n                 value = jp.getText();\n             } else if (t == JsonToken.VALUE_NULL) {\n-                value = null;\n+                value = _elementDeserializer.getNullValue();\n             } else {\n                 value = _parseString(jp, ctxt);\n             }\n--- a/src/main/java/com/fasterxml/jackson/databind/deser/std/StringCollectionDeserializer.java\n+++ b/src/main/java/com/fasterxml/jackson/databind/deser/std/StringCollectionDeserializer.java\n             String value;\n \n             if (t == JsonToken.VALUE_NULL) {\n-                value = null;\n+                value = deser.getNullValue();\n             } else {\n                 value = deser.deserialize(jp, ctxt);\n             }\n         String value;\n         \n         if (t == JsonToken.VALUE_NULL) {\n-            value = null;\n+            value = (valueDes == null) ? null : valueDes.getNullValue();\n         } else {\n             value = (valueDes == null) ? _parseString(jp, ctxt) : valueDes.deserialize(jp, ctxt);\n         }", "timestamp": 1392342522, "metainfo": ""}