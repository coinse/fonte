{"sha": "63b33fb2965b0fdcb73c41ea0e76b53ef23e0385", "log": "Fix #647", "commit": "\n--- a/src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerBase.java\n+++ b/src/main/java/com/fasterxml/jackson/databind/deser/BeanDeserializerBase.java\n                     unwrapped = new UnwrappedPropertyHandler();\n                 }\n                 unwrapped.addProperty(prop);\n-                // 10-Apr-2014, tatu: Looks like we should also do this? (no observed diff tho)\n-                if (prop != origProp) {\n-                    _beanProperties.replace(prop);\n-                }\n+                /* 12-Dec-2014, tatu: As per [databind#647], we will have problems if\n+                 *    the original property is left in place. So let's remove it now.\n+                 */\n+                _beanProperties.remove(prop);\n                 continue;\n             }\n             // [JACKSON-594]: non-static inner classes too:\n--- /dev/null\n+++ b/src/test/java/com/fasterxml/jackson/databind/struct/TestUnwrappedWithSameName647.java\n+package com.fasterxml.jackson.databind.struct;\n+\n+import com.fasterxml.jackson.annotation.JsonUnwrapped;\n+import com.fasterxml.jackson.databind.*;\n+\n+public class TestUnwrappedWithSameName647 extends BaseMapTest\n+{\n+    static class UnwrappedWithSamePropertyName {\n+        public MailHolder mail;\n+    }\n+\n+    static class MailHolder {\n+        @JsonUnwrapped\n+        public Mail mail;\n+    }\n+    \n+    static class Mail {\n+        public String mail;\n+    }\n+\n+    private final ObjectMapper MAPPER = new ObjectMapper();\n+\n+    public void testUnwrappedWithSamePropertyName() throws Exception {\n+        final String JSON = \"{'mail': {'mail': 'the mail text'}}\";\n+        UnwrappedWithSamePropertyName result = MAPPER.readValue(aposToQuotes(JSON), UnwrappedWithSamePropertyName.class);\n+        assertNotNull(result.mail);\n+        assertNotNull(result.mail.mail);\n+        assertEquals(\"the mail text\", result.mail.mail.mail);\n+    }\n+}", "timestamp": 1418422769, "metainfo": ""}