{"sha": "e707c8233405d1a2eda96649f0fbcb10b623386b", "log": "throw a special exception when there is no password for an encrpyted 7z archive - COMPRESS-298  ", "commit": "\n--- a/src/main/java/org/apache/commons/compress/archivers/sevenz/AES256SHA256Decoder.java\n+++ b/src/main/java/org/apache/commons/compress/archivers/sevenz/AES256SHA256Decoder.java\n                 System.arraycopy(coder.properties, 2 + saltSize, iv, 0, ivSize);\n \n                 if (passwordBytes == null) {\n-                    throw new IOException(\"Cannot read encrypted files without a password\");\n+                    throw new PasswordRequiredException();\n                 }\n                 final byte[] aesKeyBytes;\n                 if (numCyclesPower == 0x3f) {\n--- /dev/null\n+++ b/src/main/java/org/apache/commons/compress/archivers/sevenz/PasswordRequiredException.java\n+/*\n+ *  Licensed to the Apache Software Foundation (ASF) under one or more\n+ *  contributor license agreements.  See the NOTICE file distributed with\n+ *  this work for additional information regarding copyright ownership.\n+ *  The ASF licenses this file to You under the Apache License, Version 2.0\n+ *  (the \"License\"); you may not use this file except in compliance with\n+ *  the License.  You may obtain a copy of the License at\n+ *\n+ *      http://www.apache.org/licenses/LICENSE-2.0\n+ *\n+ *  Unless required by applicable law or agreed to in writing, software\n+ *  distributed under the License is distributed on an \"AS IS\" BASIS,\n+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n+ *  See the License for the specific language governing permissions and\n+ *  limitations under the License.\n+ *\n+ */\n+package org.apache.commons.compress.archivers.sevenz;\n+\n+import java.io.IOException;\n+\n+/**\n+ * Exception thrown when trying to read an encrypted entry without\n+ * configuring a password.\n+ * @since 1.10\n+ */\n+public class PasswordRequiredException extends IOException {\n+\n+    public PasswordRequiredException() {\n+        super(\"Cannot read encrypted files without a password\");\n+    }\n+}\n--- a/src/test/java/org/apache/commons/compress/archivers/sevenz/SevenZFileTest.java\n+++ b/src/test/java/org/apache/commons/compress/archivers/sevenz/SevenZFileTest.java\n         }\n     }\n \n+    public void test7zDecryptUnarchiveWithoutPassword() throws Exception {\n+        try {\n+            test7zUnarchive(getFile(\"bla.encrypted.7z\"), SevenZMethod.LZMA);\n+            fail(\"Expected a PasswordRequiredException\");\n+        } catch (PasswordRequiredException ex) {\n+            // expected\n+        }\n+    }\n+\n     private void test7zUnarchive(File f, SevenZMethod m) throws Exception {\n         test7zUnarchive(f, m, null);\n     }", "timestamp": 1421763874, "metainfo": ""}