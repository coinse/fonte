{"sha": "cdeae1e34bcc646c3bd07e7d74e7fc164a157bea", "log": "Extra Cleaner tests.", "commit": "\n--- a/src/main/java/org/jsoup/Jsoup.java\n+++ b/src/main/java/org/jsoup/Jsoup.java\n     }\n \n     public static String clean(String html, Whitelist whitelist) {\n-        Document dirty = Jsoup.parse(html);\n+        Document dirty = Jsoup.parse(\"<body>\" + html); // TODO: modify parser to El = Parser.parseBodyFragment\n         Cleaner cleaner = new Cleaner(whitelist);\n         Document clean = cleaner.clean(dirty);\n         return clean.getBody().html();\n--- a/src/test/java/org/jsoup/org/jsoup/safety/CleanerTest.java\n+++ b/src/test/java/org/jsoup/org/jsoup/safety/CleanerTest.java\n \n         assertEquals(\"Hello <b>there</b>!\", cleanHtml);\n     }\n+    \n+    @Test public void simpleBehaviourTest2() {\n+        String h = \"Hello <b>there</b>!\";\n+        String cleanHtml = Jsoup.clean(h, Whitelist.simpleText());\n+\n+        assertEquals(\"Hello <b>there</b>!\", cleanHtml);\n+    }\n \n     @Test public void basicBehaviourTest() {\n         String h = \"<div><p><a href='javascript:sendAllMoney()'>Dodgy</a> <A HREF='HTTP://nice.com'>Nice</p><blockquote>Hello</blockquote>\";\n \n         assertEquals(\"<p><a rel=\\\"nofollow\\\">Dodgy</a> <a href=\\\"HTTP://nice.com\\\" rel=\\\"nofollow\\\">Nice</a></p><blockquote>Hello</blockquote>\", cleanHtml);\n     }\n+    \n+    @Test public void basicWithImagesTest() {\n+        String h = \"<div><p><img src='http://example.com/' alt=Image></p><p><img src='ftp://ftp.example.com'></p></div>\";\n+        String cleanHtml = Jsoup.clean(h, Whitelist.basicWithImages());\n+        assertEquals(\"<p><img src=\\\"http://example.com/\\\" alt=\\\"Image\\\" /></p><p><img /></p>\", cleanHtml);\n+    }\n+    \n+    @Test public void testRelaxed() {\n+        String h = \"<h1>Head</h1><td>One<td>Two</td>\";\n+        String cleanHtml = Jsoup.clean(h, Whitelist.relaxed());\n+        assertEquals(\"<h1>Head</h1><table><tr><td>One</td><td>Two</td></tr></table>\", cleanHtml);\n+    }\n+    \n+    @Test public void testDropComments() {\n+        String h = \"<p>Hello<!-- no --></p>\";\n+        String cleanHtml = Jsoup.clean(h, Whitelist.relaxed());\n+        assertEquals(\"<p>Hello</p>\", cleanHtml);\n+    }\n+    \n+    @Test public void testDropXmlProc() {\n+        String h = \"<?import namespace=\\\"xss\\\"><p>Hello</p>\";\n+        String cleanHtml = Jsoup.clean(h, Whitelist.relaxed());\n+        assertEquals(\"<p>Hello</p>\", cleanHtml);\n+    }\n+    \n+    @Test public void testDropScript() {\n+        String h = \"<SCRIPT SRC=//ha.ckers.org/.j><SCRIPT>alert(/XSS/.source)</SCRIPT>\";\n+        String cleanHtml = Jsoup.clean(h, Whitelist.relaxed());\n+        assertEquals(\"\", cleanHtml);\n+    }\n+    \n+    @Test public void testDropImageScript() {\n+        String h = \"<IMG SRC=\\\"javascript:alert('XSS')\\\">\";\n+        String cleanHtml = Jsoup.clean(h, Whitelist.relaxed());\n+        assertEquals(\"<img />\", cleanHtml);\n+    }\n+    \n+    @Test public void testCleanJavascriptHref() {\n+        String h = \"<A HREF=\\\"javascript:document.location='http://www.google.com/'\\\">XSS</A>\";\n+        String cleanHtml = Jsoup.clean(h, Whitelist.relaxed());\n+        assertEquals(\"<a>XSS</a>\", cleanHtml);\n+    }\n }", "timestamp": 1309605105, "metainfo": ""}