{"sha": "975baeba6172fd711f2a13db791464e6b272a120", "log": "Applying my patch from COLLECTIONS-265. TreeBag no longer accepts non-Comparable classes when it naturally ordered (ie: no comparator has been set)  ", "commit": "\n--- a/src/java/org/apache/commons/collections/TreeBag.java\n+++ b/src/java/org/apache/commons/collections/TreeBag.java\n         addAll(coll);\n     }\n \n+    public boolean add(Object o) {\n+        if(comparator() == null && !(o instanceof Comparable)) {\n+            throw new IllegalArgumentException(\"Objects of type \" + o.getClass() + \" cannot be added to \" + \n+                                               \"a naturally ordered TreeBag as it does not implement Comparable\");\n+        }\n+        return super.add(o);\n+    }\n+\n     public Object first() {\n         return ((SortedMap) getMap()).firstKey();\n     }\n--- a/src/java/org/apache/commons/collections/bag/TreeBag.java\n+++ b/src/java/org/apache/commons/collections/bag/TreeBag.java\n     }\n \n     //-----------------------------------------------------------------------\n+    public boolean add(Object o) {\n+        if(comparator() == null && !(o instanceof Comparable)) {\n+            throw new IllegalArgumentException(\"Objects of type \" + o.getClass() + \" cannot be added to \" + \n+                                               \"a naturally ordered TreeBag as it does not implement Comparable\");\n+        }\n+        return super.add(o);\n+    }\n+\n+    //-----------------------------------------------------------------------\n     public Object first() {\n         return ((SortedMap) getMap()).firstKey();\n     }\n--- a/src/test/org/apache/commons/collections/TestTreeBag.java\n+++ b/src/test/org/apache/commons/collections/TestTreeBag.java\n       assertEquals(\"Should get last key\",\n                    \"D\", ((SortedBag)bag).last());\n    }\n+\n+   public void testCollections265() {\n+       Bag bag = new TreeBag();\n+       try {\n+           bag.add(new Object());\n+           fail(\"IllegalArgumentException expected\");\n+       } catch(IllegalArgumentException iae) {\n+           // expected;\n+       }\n+   }\n+   \n }\n--- a/src/test/org/apache/commons/collections/bag/TestTreeBag.java\n+++ b/src/test/org/apache/commons/collections/bag/TestTreeBag.java\n       assertEquals(\"Should get last key\",\n                    \"D\", ((SortedBag)bag).last());\n    }\n+\n+   public void testCollections265() {\n+       Bag bag = new TreeBag();\n+       try {\n+           bag.add(new Object());\n+           fail(\"IllegalArgumentException expected\");\n+       } catch(IllegalArgumentException iae) {\n+           // expected;\n+       }\n+   }\n    \n    public String getCompatibilityVersion() {\n        return \"3\";", "timestamp": 1206511732, "metainfo": ""}