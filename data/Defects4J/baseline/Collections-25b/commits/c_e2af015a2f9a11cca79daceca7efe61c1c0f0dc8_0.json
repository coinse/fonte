{"sha": "e2af015a2f9a11cca79daceca7efe61c1c0f0dc8", "log": "fix a bug in FilterListIterator and add a test for it   ", "commit": "\n--- a/src/java/org/apache/commons/collections/FilterListIterator.java\n+++ b/src/java/org/apache/commons/collections/FilterListIterator.java\n /*\n- * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//collections/src/java/org/apache/commons/collections/Attic/FilterListIterator.java,v 1.2 2002/02/26 17:28:55 rwaldhoff Exp $\n- * $Revision: 1.2 $\n- * $Date: 2002/02/26 17:28:55 $\n+ * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//collections/src/java/org/apache/commons/collections/Attic/FilterListIterator.java,v 1.3 2002/05/13 16:10:37 rwaldhoff Exp $\n+ * $Revision: 1.3 $\n+ * $Date: 2002/05/13 16:10:37 $\n  *\n  * ====================================================================\n  *\n   * <code>Predicate</code> evaluates to <code>true</code> are\n   * returned by the iterator.\n   * \n-  * @version $Revision: 1.2 $ $Date: 2002/02/26 17:28:55 $\n+  * @version $Revision: 1.3 $ $Date: 2002/05/13 16:10:37 $\n   * @author Rodney Waldhoff\n   */\n public class FilterListIterator extends ProxyListIterator {\n             clearPreviousObject();\n             if(!setNextObject()) {\n                 return false;\n+            } else {\n+                clearNextObject();\n             }\n         }\n \n             clearNextObject();\n             if(!setPreviousObject()) {\n                 return false;\n+            } else {\n+                clearPreviousObject();\n             }\n         }\n \n--- a/src/test/org/apache/commons/collections/TestFilterListIterator.java\n+++ b/src/test/org/apache/commons/collections/TestFilterListIterator.java\n /*\n- * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//collections/src/test/org/apache/commons/collections/Attic/TestFilterListIterator.java,v 1.2 2002/02/26 17:28:55 rwaldhoff Exp $\n- * $Revision: 1.2 $\n- * $Date: 2002/02/26 17:28:55 $\n+ * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//collections/src/test/org/apache/commons/collections/Attic/TestFilterListIterator.java,v 1.3 2002/05/13 16:10:37 rwaldhoff Exp $\n+ * $Revision: 1.3 $\n+ * $Date: 2002/05/13 16:10:37 $\n  *\n  * ====================================================================\n  *\n import java.util.Random;\n \n /**\n- * @version $Revision: 1.2 $ $Date: 2002/02/26 17:28:55 $\n+ * @version $Revision: 1.3 $ $Date: 2002/05/13 16:10:37 $\n  * @author Rodney Waldhoff\n  */\n public class TestFilterListIterator extends TestCase {\n             walkForward(expected,filtered);\n             previousPreviousNext(expected,filtered);\n         }\n+    }\n+\n+    public void testFailingHasNextBug() {\n+        FilterListIterator filtered = new FilterListIterator(list.listIterator(),fourPred);\n+        ListIterator expected = fours.listIterator();\n+        while(expected.hasNext()) {\n+            expected.next();\n+            filtered.next();\n+        }\n+        assertTrue(filtered.hasPrevious());\n+        assertTrue(!filtered.hasNext());\n+        assertEquals(expected.previous(),filtered.previous());\n     }\n \n     // Utilities", "timestamp": 1021306237, "metainfo": ""}