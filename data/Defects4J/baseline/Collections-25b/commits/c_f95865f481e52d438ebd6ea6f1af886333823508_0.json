{"sha": "f95865f481e52d438ebd6ea6f1af886333823508", "log": "Fix Flat3Map.equals to actually work bug 34917, from Stanislaw Osinski  ", "commit": "\n--- a/src/java/org/apache/commons/collections/map/Flat3Map.java\n+++ b/src/java/org/apache/commons/collections/map/Flat3Map.java\n             switch (size) {  // drop through\n                 case 3:\n                     if (other.containsKey(key3) == false) {\n-                        otherValue = other.get(key3);\n-                        if (value3 == null ? otherValue != null : !value3.equals(otherValue)) {\n-                            return false;\n-                        }\n+                        return false;\n+                    }\n+                    otherValue = other.get(key3);\n+                    if (value3 == null ? otherValue != null : !value3.equals(otherValue)) {\n+                        return false;\n                     }\n                 case 2:\n                     if (other.containsKey(key2) == false) {\n-                        otherValue = other.get(key2);\n-                        if (value2 == null ? otherValue != null : !value2.equals(otherValue)) {\n-                            return false;\n-                        }\n+                        return false;\n+                    }\n+                    otherValue = other.get(key2);\n+                    if (value2 == null ? otherValue != null : !value2.equals(otherValue)) {\n+                        return false;\n                     }\n                 case 1:\n                     if (other.containsKey(key1) == false) {\n-                        otherValue = other.get(key1);\n-                        if (value1 == null ? otherValue != null : !value1.equals(otherValue)) {\n-                            return false;\n-                        }\n+                        return false;\n+                    }\n+                    otherValue = other.get(key1);\n+                    if (value1 == null ? otherValue != null : !value1.equals(otherValue)) {\n+                        return false;\n                     }\n             }\n         }\n--- a/src/test/org/apache/commons/collections/map/TestFlat3Map.java\n+++ b/src/test/org/apache/commons/collections/map/TestFlat3Map.java\n     }\n \n     //-----------------------------------------------------------------------\n+    public void testEquals1() {\n+        Flat3Map map1 = new Flat3Map();\n+        map1.put(\"a\", \"testA\");\n+        map1.put(\"b\", \"testB\");\n+        Flat3Map map2 = new Flat3Map();\n+        map2.put(\"a\", \"testB\");\n+        map2.put(\"b\", \"testA\");\n+        assertEquals(false, map1.equals(map2));\n+    }\n+\n+    public void testEquals2() {\n+        Flat3Map map1 = new Flat3Map();\n+        map1.put(\"a\", \"testA\");\n+        map1.put(\"b\", \"testB\");\n+        Flat3Map map2 = new Flat3Map();\n+        map2.put(\"a\", \"testB\");\n+        map2.put(\"c\", \"testA\");\n+        assertEquals(false, map1.equals(map2));\n+    }\n+\n     public void testClone2() {\n         Flat3Map map = new Flat3Map();\n         assertEquals(0, map.size());", "timestamp": 1116148970, "metainfo": ""}