{"sha": "16cd754b197377103f0b9d6d4ed5b32f0c668f2c", "log": "BlockingBuffer - Fix internal locking code bug 37028, from Sebastian Bazley  ", "commit": "\n--- a/src/java/org/apache/commons/collections/buffer/BlockingBuffer.java\n+++ b/src/java/org/apache/commons/collections/buffer/BlockingBuffer.java\n  * @author Stephen Colebourne\n  * @author Janek Bogucki\n  * @author Phil Steitz\n+ * @author Sebastian Bazley\n  * @version $Revision$ $Date$\n  * @since Commons Collections 3.0\n  */\n     public boolean add(Object o) {\n         synchronized (lock) {\n             boolean result = collection.add(o);\n-            notifyAll();\n+            lock.notifyAll();\n             return result;\n         }\n     }\n     public boolean addAll(Collection c) {\n         synchronized (lock) {\n             boolean result = collection.addAll(c);\n-            notifyAll();\n+            lock.notifyAll();\n             return result;\n         }\n     }\n         synchronized (lock) {\n             while (collection.isEmpty()) {\n                 try {\n-                    wait();\n+                    lock.wait();\n                 } catch (InterruptedException e) {\n                     PrintWriter out = new PrintWriter(new StringWriter());\n                     e.printStackTrace(out);\n             long timeLeft = expiration - System.currentTimeMillis();\n             while (timeLeft > 0 && collection.isEmpty()) {\n                 try {\n-                    wait(timeLeft);\n+                    lock.wait(timeLeft);\n                     timeLeft = expiration - System.currentTimeMillis();\n                 } catch(InterruptedException e) {\n                     PrintWriter out = new PrintWriter(new StringWriter());\n         synchronized (lock) {\n             while (collection.isEmpty()) {\n                 try {\n-                    wait();\n+                    lock.wait();\n                 } catch (InterruptedException e) {\n                     PrintWriter out = new PrintWriter(new StringWriter());\n                     e.printStackTrace(out);\n             long timeLeft = expiration - System.currentTimeMillis();\n             while (timeLeft > 0 && collection.isEmpty()) {\n                 try {\n-                    wait(timeLeft);\n+                    lock.wait(timeLeft);\n                     timeLeft = expiration - System.currentTimeMillis();\n                 } catch(InterruptedException e) {\n                     PrintWriter out = new PrintWriter(new StringWriter());", "timestamp": 1129064955, "metainfo": ""}