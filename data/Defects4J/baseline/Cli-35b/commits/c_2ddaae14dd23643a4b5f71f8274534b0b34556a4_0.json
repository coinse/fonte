{"sha": "2ddaae14dd23643a4b5f71f8274534b0b34556a4", "log": "Applying my second attempt at a patch to CLI-162. This fixes Gary's reported bug (one of which was an example of CLI-162, and one a bug in my first attempt to patch). Open question is whether to output text that is too long, or try and break it up to fit the screen width.   ", "commit": "\n--- a/src/java/org/apache/commons/cli/HelpFormatter.java\n+++ b/src/java/org/apache/commons/cli/HelpFormatter.java\n \n         while (true)\n         {\n-            int lastPos = pos;\n             text = padding + text.substring(pos).trim();\n             pos = findWrapPos(text, width, 0);\n \n                 sb.append(text);\n \n                 return sb;\n-            } else\n-            if (pos == lastPos)\n-            {\n-                throw new RuntimeException(\"Text too long for line - throwing exception to avoid infinite loop [CLI-162]: \" + text);\n+            }\n+            \n+            if ( (text.length() > width) && (pos == nextLineTabStop - 1) ) {\n+                sb.append(text);\n+\n+                return sb;\n             }\n \n             sb.append(rtrim(text.substring(0, pos))).append(defaultNewLine);\n--- a/src/test/org/apache/commons/cli/bug/BugCLI162Test.java\n+++ b/src/test/org/apache/commons/cli/bug/BugCLI162Test.java\n     public void testInfiniteLoop() {\n         HelpFormatter formatter = new HelpFormatter();\n         formatter.setWidth(20);\n-        try {\n-            formatter.printHelp(\"app\", options); // hang & crash\n-        } catch(RuntimeException re) {\n-            assertTrue(re.getMessage().startsWith(\"Text too long for line - throwing exception to avoid infinite loop [CLI-162]: \"));\n-        }\n+        formatter.printHelp(\"app\", options); // used to hang & crash\n     }\n     \n     private void testPrintHelp(Options options) throws ParseException, IOException {", "timestamp": 1234935778, "metainfo": ""}