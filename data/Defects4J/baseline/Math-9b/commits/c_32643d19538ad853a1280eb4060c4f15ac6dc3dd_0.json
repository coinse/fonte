{"sha": "32643d19538ad853a1280eb4060c4f15ac6dc3dd", "log": "added an error detection for missing imaginary character while parsing complex string JIRA: MATH-198  ", "commit": "\n--- a/src/java/org/apache/commons/math/complex/ComplexFormat.java\n+++ b/src/java/org/apache/commons/math/complex/ComplexFormat.java\n         int n = getImaginaryCharacter().length();\n         startIndex = pos.getIndex();\n         int endIndex = startIndex + n;\n-        if (source.substring(startIndex, endIndex).compareTo(\n+        if ((startIndex >= source.length()) ||\n+            (endIndex > source.length()) ||\n+            source.substring(startIndex, endIndex).compareTo(\n             getImaginaryCharacter()) != 0) {\n             // set index back to initial, error index should be the start index\n             // character examined.\n--- a/src/test/org/apache/commons/math/complex/ComplexFormatAbstractTest.java\n+++ b/src/test/org/apache/commons/math/complex/ComplexFormatAbstractTest.java\n \n import java.text.NumberFormat;\n import java.text.ParseException;\n+import java.text.ParsePosition;\n import java.util.Locale;\n \n import junit.framework.TestCase;\n             // success\n         }\n     }\n+\n+    public void testForgottenImaginaryCharacter() {\n+        ParsePosition pos = new ParsePosition(0);\n+        assertNull(new ComplexFormat().parse(\"1 + 1\", pos));\n+        assertEquals(5, pos.getErrorIndex());\n+    }\n }", "timestamp": 1206274979, "metainfo": ""}