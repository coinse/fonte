{"sha": "7153fa9be229ee078c7026dba8c9b2be3d791ed2", "log": "Test cases and (temporary?) fix for BZ 35904.  ", "commit": "\n--- a/src/java/org/apache/commons/math/util/MathUtils.java\n+++ b/src/java/org/apache/commons/math/util/MathUtils.java\n     public static double round(\n         double x, int scale, int roundingMethod)\n     {\n-        return (new BigDecimal(x).setScale(scale, roundingMethod))\n+        return (new BigDecimal(new Double(x).toString()).setScale(scale, roundingMethod))\n             .doubleValue();\n     }\n     \n      * @since 1.1\n      */\n     public static float round(float x, int scale, int roundingMethod) {\n-        return (new BigDecimal(x).setScale(scale, roundingMethod)).floatValue();\n+        return (new BigDecimal(new Float(x).toString()).setScale(scale, roundingMethod)).floatValue();\n     }\n     \n     /**\n--- a/src/test/org/apache/commons/math/util/MathUtilsTest.java\n+++ b/src/test/org/apache/commons/math/util/MathUtilsTest.java\n         assertEquals(1.23f, MathUtils.round(x, 2), 0.0f);\n         assertEquals(1.235f, MathUtils.round(x, 3), 0.0f);\n         assertEquals(1.2346f, MathUtils.round(x, 4), 0.0f);\n+        \n+        \n+        // BZ 35904\n+        assertEquals(30.1f, MathUtils.round(30.095f, 2), 0.0f);\n+        assertEquals(30.1f, MathUtils.round(30.095f, 1), 0.0f);\n+        assertEquals(50.09f,  MathUtils.round(50.085f, 2), 0.0f);\n+        assertEquals(50.19f,  MathUtils.round(50.185f, 2), 0.0f);\n+        assertEquals(50.01f,  MathUtils.round(50.005f, 2), 0.0f);\n+        assertEquals(30.01f,  MathUtils.round(30.005f, 2), 0.0f);\n+        assertEquals(30.65f,  MathUtils.round(30.645f, 2), 0.0f);\n \n         assertEquals(1.23f, MathUtils.round(x, 2, BigDecimal.ROUND_DOWN), 0.0f);\n         assertEquals(1.234f, MathUtils.round(x, 3, BigDecimal.ROUND_DOWN), 0.0f);\n         assertEquals(1.23, MathUtils.round(x, 2), 0.0);\n         assertEquals(1.235, MathUtils.round(x, 3), 0.0);\n         assertEquals(1.2346, MathUtils.round(x, 4), 0.0);\n+        \n+        // BZ 35904\n+        assertEquals(30.1d, MathUtils.round(30.095d, 2), 0.0d);\n+        assertEquals(30.1d, MathUtils.round(30.095d, 1), 0.0d);\n+        assertEquals(50.09d,  MathUtils.round(50.085d, 2), 0.0d);\n+        assertEquals(50.19d,  MathUtils.round(50.185d, 2), 0.0d);\n+        assertEquals(50.01d,  MathUtils.round(50.005d, 2), 0.0d);\n+        assertEquals(30.01d,  MathUtils.round(30.005d, 2), 0.0d);\n+        assertEquals(30.65d,  MathUtils.round(30.645d, 2), 0.0d);\n \n         assertEquals(1.23, MathUtils.round(x, 2, BigDecimal.ROUND_DOWN), 0.0);\n         assertEquals(1.234, MathUtils.round(x, 3, BigDecimal.ROUND_DOWN), 0.0);", "timestamp": 1122708326, "metainfo": ""}