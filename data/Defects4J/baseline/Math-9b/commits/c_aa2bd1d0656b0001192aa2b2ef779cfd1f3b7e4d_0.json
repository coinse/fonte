{"sha": "aa2bd1d0656b0001192aa2b2ef779cfd1f3b7e4d", "log": "MATH-929 Fixed truncated value. Thanks to Piotr Wydrych. Added unit test: comparing density values with univariate normal distribution.   ", "commit": "\n--- a/src/main/java/org/apache/commons/math3/distribution/MultivariateNormalDistribution.java\n+++ b/src/main/java/org/apache/commons/math3/distribution/MultivariateNormalDistribution.java\n             throw new DimensionMismatchException(vals.length, dim);\n         }\n \n-        return FastMath.pow(2 * FastMath.PI, -dim / 2) *\n+        return FastMath.pow(2 * FastMath.PI, -0.5 * dim) *\n             FastMath.pow(covarianceMatrixDeterminant, -0.5) *\n             getExponentTerm(vals);\n     }\n--- a/src/test/java/org/apache/commons/math3/distribution/MultivariateNormalDistributionTest.java\n+++ b/src/test/java/org/apache/commons/math3/distribution/MultivariateNormalDistributionTest.java\n import org.apache.commons.math3.stat.correlation.Covariance;\n import org.apache.commons.math3.linear.RealMatrix;\n \n+import java.util.Random;\n import org.junit.After;\n import org.junit.Assert;\n import org.junit.Before;\n             Assert.assertEquals(correctDensities[i], densities[i], 1e-16);\n         }\n     }\n+\n+    /**\n+     * Test the accuracy of the distribution when calculating densities.\n+     */\n+    @Test\n+    public void testUnivariateDistribution() {\n+        final double[] mu = { -1.5 };\n+        final double[][] sigma = { { 1 } };\n+ \n+        final MultivariateNormalDistribution multi = new MultivariateNormalDistribution(mu, sigma);\n+\n+        final NormalDistribution uni = new NormalDistribution(mu[0], sigma[0][0]);\n+        final Random rng = new Random();\n+        final int numCases = 100;\n+        final double tol = Math.ulp(1d);\n+        for (int i = 0; i < numCases; i++) {\n+            final double v = rng.nextDouble() * 10 - 5;\n+            Assert.assertEquals(uni.density(v), multi.density(new double[] { v }), tol);\n+        }\n+    }\n }", "timestamp": 1358252150, "metainfo": ""}