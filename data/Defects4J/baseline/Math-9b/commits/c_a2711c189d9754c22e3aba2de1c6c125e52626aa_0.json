{"sha": "a2711c189d9754c22e3aba2de1c6c125e52626aa", "log": "Fixed loss of significance error in PersonsCorrelation p-value computation causing p-values smaller than the machine epsilon (~1E-16) to be reported as 0. JIRA: MATH-371 Reported and patched by Kevin Childs  ", "commit": "\n--- a/src/main/java/org/apache/commons/math/stat/correlation/PearsonsCorrelation.java\n+++ b/src/main/java/org/apache/commons/math/stat/correlation/PearsonsCorrelation.java\n                 } else {\n                     double r = correlationMatrix.getEntry(i, j);\n                     double t = Math.abs(r * Math.sqrt((nObs - 2)/(1 - r * r)));\n-                    out[i][j] = 2 * (1 - tDistribution.cumulativeProbability(t));\n+                    out[i][j] = 2 * tDistribution.cumulativeProbability(-t);\n                 }\n             }\n         }\n--- a/src/test/java/org/apache/commons/math/stat/correlation/PearsonsCorrelationTest.java\n+++ b/src/test/java/org/apache/commons/math/stat/correlation/PearsonsCorrelationTest.java\n          fillUpper(rPMatrix, 0d);\n          TestUtils.assertEquals(\"correlation p values\", rPMatrix, corrInstance.getCorrelationPValues(), 10E-15);\n     }\n+    \n+    /**\n+     * Test p-value near 0. JIRA: MATH-371\n+     */\n+    public void testPValueNearZero() throws Exception {\n+        /*\n+         * Create a dataset that has r -> 1, p -> 0 as dimension increases.\n+         * Prior to the fix for MATH-371, p vanished for dimension >= 14.\n+         * Post fix, p-values diminish smoothly, vanishing at dimension = 127.\n+         * Tested value is ~1E-303.\n+         */\n+        int dimension = 120; \n+        double[][] data = new double[dimension][2];\n+        for (int i = 0; i < dimension; i++) {\n+            data[i][0] = i;\n+            data[i][1] = i + 1/((double)i + 1);\n+        }\n+        PearsonsCorrelation corrInstance = new PearsonsCorrelation(data);\n+        assertTrue(corrInstance.getCorrelationPValues().getEntry(0, 1) > 0);\n+    }\n+    \n \n     /**\n      * Constant column", "timestamp": 1274053687, "metainfo": ""}