{"sha": "3b18c97188957a5c777e68e86b360526fa0d73f5", "log": "alternative root finding framework, and Brent-Drekker solver  Issue: 20844 Submitted by: J. Pietschmann Reviewed by: T. O'Brien   ", "commit": "\n--- /dev/null\n+++ b/src/java/org/apache/commons/math/BrentSolver.java\n+/* ====================================================================\n+ * The Apache Software License, Version 1.1\n+ *\n+ * Copyright (c) 2003 The Apache Software Foundation.  All rights\n+ * reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions\n+ * are met:\n+ *\n+ * 1. Redistributions of source code must retain the above copyright\n+ *    notice, this list of conditions and the following disclaimer.\n+ *\n+ * 2. Redistributions in binary form must reproduce the above copyright\n+ *    notice, this list of conditions and the following disclaimer in\n+ *    the documentation and/or other materials provided with the\n+ *    distribution.\n+ *\n+ * 3. The end-user documentation included with the redistribution, if\n+ *    any, must include the following acknowlegement:\n+ *       \"This product includes software developed by the\n+ *        Apache Software Foundation (http://www.apache.org/).\"\n+ *    Alternately, this acknowlegement may appear in the software itself,\n+ *    if and wherever such third-party acknowlegements normally appear.\n+ *\n+ * 4. The names \"The Jakarta Project\", \"Commons\", and \"Apache Software\n+ *    Foundation\" must not be used to endorse or promote products derived\n+ *    from this software without prior written permission. For written\n+ *    permission, please contact apache@apache.org.\n+ *\n+ * 5. Products derived from this software may not be called \"Apache\"\n+ *    nor may \"Apache\" appear in their names without prior written\n+ *    permission of the Apache Software Foundation.\n+ *\n+ * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED\n+ * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n+ * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED.  IN NO EVENT SHALL THE APACHE SOFTWARE FOUNDATION OR\n+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n+ * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF\n+ * USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n+ * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n+ * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n+ * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF\n+ * SUCH DAMAGE.\n+ * ====================================================================\n+ *\n+ * This software consists of voluntary contributions made by many\n+ * individuals on behalf of the Apache Software Foundation.  For more\n+ * information on the Apache Software Foundation, please see\n+ * <http://www.apache.org/>.\n+ */\n+package org.apache.commons.math;\n+\n+/**\n+ * Provide the Brent algorithm for solving for zeros of real univariate\n+ * functions.\n+ * It will only search for one zero in the given interval.\n+ * The function is supposed to be continuous but not necessarily smooth.\n+ *  \n+ * @author pietsch at apache.org\n+ */\n+public class BrentSolver extends UnivariateRealSolverImpl {\n+\n+    private UnivariateRealFunction f;\n+\n+    public BrentSolver(UnivariateRealFunction f) {\n+        super(100, 1E-6);\n+        this.f = f;\n+    }\n+\n+    /* (non-Javadoc)\n+     * @see org.apache.commons.math.UnivariateRealSolver#solve(double, double)\n+     */\n+    public double solve(double min, double max) throws MathException {\n+        clearResult();\n+        double x0 = min;\n+        double x1 = max;\n+        double y0 = f.value(x0);\n+        double y1 = f.value(x1);\n+        if ((y0 > 0) == (y1 > 0)) {\n+            throw new MathException(\"Interval doesn't bracket a zero.\");\n+        }\n+        double x2 = x0;\n+        double y2 = y0;\n+        double delta = x1 - x0;\n+        double oldDelta = delta;\n+\n+        int i = 0;\n+        while (i < maximalIterationCount) {\n+            if (Math.abs(y2) < Math.abs(y1)) {\n+                x0 = x1;\n+                x1 = x2;\n+                x2 = x0;\n+                y0 = y1;\n+                y1 = y2;\n+                y2 = y0;\n+            }\n+            double tolerance = Math.max(relativeAccuracy * Math.abs ( x1 ),\n+                                        absoluteAccuracy);\n+            if (Math.abs(y1) <= functionValueAccuracy) {\n+                // Avoid division by very small values. Assume\n+                // the iteration has converged (the problem may\n+                // still be ill conditioned\n+                setResult(x1,i);\n+                return result;\n+            }\n+            double dx = 0.5 * (x2 - x1);\n+            if (Math.abs(dx) <= tolerance) {\n+                setResult(x1,i);\n+                return result;\n+            }\n+            if (Math.abs(oldDelta) < tolerance || Math.abs(y0) <= Math.abs(y1)) {\n+                // Force bisection.\n+                delta = dx;\n+                oldDelta = delta;\n+            } else {\n+                double r3 = y1 / y0;\n+                double p;\n+                double p1;\n+                if (x0 == x2) {\n+                    // Linear interpolation.\n+                    p = 2.0 * dx * r3;\n+                    p1 = 1.0 - r3;\n+                } else {\n+                    // Inverse quadratic interpolation.\n+                    double r1 = y0 / y2;\n+                    double r2 = y1 / y2;\n+                    p = r3 * (2.0 * dx * r1 * (r1 - r2) - (x1 - x0) * (r2 - 1.0));\n+                    p1 = (r1 - 1.0) * (r2 - 1.0) * (r3 - 1.0);\n+                }\n+                if (p > 0.0) {\n+                    p1 = -p1;\n+                } else {\n+                    p = -p;\n+                }\n+                if (2.0 * p >= 3.0 * dx * p1 - Math.abs(tolerance * p1)\n+                    || p >= Math.abs(0.5 * oldDelta * p1)) {\n+                    // Inverse quadratic interpolation gives a value\n+                    // in the wrong direction, or progress is slow.\n+                    // Fall back to bisection.\n+                    delta = dx;\n+                    oldDelta = delta;\n+                } else {\n+                    oldDelta = delta;\n+                    delta = p / p1;\n+                }\n+            }\n+            // Save old X1, Y1 \n+            x0 = x1;\n+            y0 = y1;\n+            // Compute new X1, Y1\n+            if (Math.abs(delta) > tolerance) {\n+                x1 = x1 + delta;\n+            } else if (dx > 0.0) {\n+                x1 = x1 + tolerance;\n+            } else if (dx <= 0.0) {\n+                x1 = x1 - tolerance;\n+            }\n+            y1 = f.value(x1);\n+            if ((y1 > 0) == (y2 > 0)) {\n+                x2 = x0;\n+                y2 = y0;\n+                delta = x1 - x0;\n+                oldDelta = delta;\n+            }\n+            i++;\n+        }\n+        throw new MathException(\"Maximal iteration number exceeded.\");\n+    }\n+\n+}\n--- /dev/null\n+++ b/src/java/org/apache/commons/math/MathConfigurationException.java\n+/* ====================================================================\n+ * The Apache Software License, Version 1.1\n+ *\n+ * Copyright (c) 2003 The Apache Software Foundation.  All rights\n+ * reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions\n+ * are met:\n+ *\n+ * 1. Redistributions of source code must retain the above copyright\n+ *    notice, this list of conditions and the following disclaimer.\n+ *\n+ * 2. Redistributions in binary form must reproduce the above copyright\n+ *    notice, this list of conditions and the following disclaimer in\n+ *    the documentation and/or other materials provided with the\n+ *    distribution.\n+ *\n+ * 3. The end-user documentation included with the redistribution, if\n+ *    any, must include the following acknowlegement:\n+ *       \"This product includes software developed by the\n+ *        Apache Software Foundation (http://www.apache.org/).\"\n+ *    Alternately, this acknowlegement may appear in the software itself,\n+ *    if and wherever such third-party acknowlegements normally appear.\n+ *\n+ * 4. The names \"The Jakarta Project\", \"Commons\", and \"Apache Software\n+ *    Foundation\" must not be used to endorse or promote products derived\n+ *    from this software without prior written permission. For written\n+ *    permission, please contact apache@apache.org.\n+ *\n+ * 5. Products derived from this software may not be called \"Apache\"\n+ *    nor may \"Apache\" appear in their names without prior written\n+ *    permission of the Apache Software Foundation.\n+ *\n+ * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED\n+ * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n+ * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED.  IN NO EVENT SHALL THE APACHE SOFTWARE FOUNDATION OR\n+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n+ * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF\n+ * USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n+ * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n+ * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n+ * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF\n+ * SUCH DAMAGE.\n+ * ====================================================================\n+ *\n+ * This software consists of voluntary contributions made by many\n+ * individuals on behalf of the Apache Software Foundation.  For more\n+ * information on the Apache Software Foundation, please see\n+ * <http://www.apache.org/>.\n+ */\n+package org.apache.commons.math;\n+\n+/**\n+ * Signals a configuration problem with any of the factory methods.\n+ * \n+ * @author pietsch at apache.org\n+ *\n+ */\n+public class MathConfigurationException extends MathException {\n+\n+    /**\n+     * \n+     */\n+    public MathConfigurationException() {\n+        super();\n+    }\n+\n+    /**\n+     * @param message message describing the problem\n+     */\n+    public MathConfigurationException(String message) {\n+        super(message);\n+    }\n+\n+    /**\n+     * @param message message describing the problem\n+     * @param throwable caught exception causing this problem\n+     */\n+    public MathConfigurationException(String message, Throwable throwable) {\n+        super(message, throwable);\n+    }\n+\n+    /**\n+     * @param throwable caught exception causing this problem\n+     */\n+    public MathConfigurationException(Throwable throwable) {\n+        super(throwable);\n+    }\n+\n+}\n--- /dev/null\n+++ b/src/java/org/apache/commons/math/MathException.java\n+/* ====================================================================\n+ * The Apache Software License, Version 1.1\n+ *\n+ * Copyright (c) 2003 The Apache Software Foundation.  All rights\n+ * reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions\n+ * are met:\n+ *\n+ * 1. Redistributions of source code must retain the above copyright\n+ *    notice, this list of conditions and the following disclaimer.\n+ *\n+ * 2. Redistributions in binary form must reproduce the above copyright\n+ *    notice, this list of conditions and the following disclaimer in\n+ *    the documentation and/or other materials provided with the\n+ *    distribution.\n+ *\n+ * 3. The end-user documentation included with the redistribution, if\n+ *    any, must include the following acknowlegement:\n+ *       \"This product includes software developed by the\n+ *        Apache Software Foundation (http://www.apache.org/).\"\n+ *    Alternately, this acknowlegement may appear in the software itself,\n+ *    if and wherever such third-party acknowlegements normally appear.\n+ *\n+ * 4. The names \"The Jakarta Project\", \"Commons\", and \"Apache Software\n+ *    Foundation\" must not be used to endorse or promote products derived\n+ *    from this software without prior written permission. For written\n+ *    permission, please contact apache@apache.org.\n+ *\n+ * 5. Products derived from this software may not be called \"Apache\"\n+ *    nor may \"Apache\" appear in their names without prior written\n+ *    permission of the Apache Software Foundation.\n+ *\n+ * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED\n+ * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n+ * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED.  IN NO EVENT SHALL THE APACHE SOFTWARE FOUNDATION OR\n+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n+ * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF\n+ * USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n+ * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n+ * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n+ * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF\n+ * SUCH DAMAGE.\n+ * ====================================================================\n+ *\n+ * This software consists of voluntary contributions made by many\n+ * individuals on behalf of the Apache Software Foundation.  For more\n+ * information on the Apache Software Foundation, please see\n+ * <http://www.apache.org/>.\n+ */\n+package org.apache.commons.math;\n+\n+/**\n+ * A generic exception indicating problems in the math package.\n+ *  \n+ * @author pietsch at apache.org\n+ */\n+public class MathException extends Exception {\n+\n+    /**\n+     * \n+     */\n+    public MathException() {\n+        super();\n+    }\n+\n+    /**\n+     * @param message message describing the problem\n+     */\n+    public MathException(String message) {\n+        super(message);\n+    }\n+\n+    /**\n+     * @param message message describing the problem\n+     * @param throwable caught exception causing this problem\n+     */\n+    public MathException(String message, Throwable throwable) {\n+        super(message, throwable);\n+    }\n+\n+    /**\n+     * @param throwable caught exception causing this problem\n+     */\n+    public MathException(Throwable throwable) {\n+        super(throwable);\n+    }\n+\n+}\n--- /dev/null\n+++ b/src/java/org/apache/commons/math/SecantSolver.java\n+/* ====================================================================\n+ * The Apache Software License, Version 1.1\n+ *\n+ * Copyright (c) 2003 The Apache Software Foundation.  All rights\n+ * reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions\n+ * are met:\n+ *\n+ * 1. Redistributions of source code must retain the above copyright\n+ *    notice, this list of conditions and the following disclaimer.\n+ *\n+ * 2. Redistributions in binary form must reproduce the above copyright\n+ *    notice, this list of conditions and the following disclaimer in\n+ *    the documentation and/or other materials provided with the\n+ *    distribution.\n+ *\n+ * 3. The end-user documentation included with the redistribution, if\n+ *    any, must include the following acknowlegement:\n+ *       \"This product includes software developed by the\n+ *        Apache Software Foundation (http://www.apache.org/).\"\n+ *    Alternately, this acknowlegement may appear in the software itself,\n+ *    if and wherever such third-party acknowlegements normally appear.\n+ *\n+ * 4. The names \"The Jakarta Project\", \"Commons\", and \"Apache Software\n+ *    Foundation\" must not be used to endorse or promote products derived\n+ *    from this software without prior written permission. For written\n+ *    permission, please contact apache@apache.org.\n+ *\n+ * 5. Products derived from this software may not be called \"Apache\"\n+ *    nor may \"Apache\" appear in their names without prior written\n+ *    permission of the Apache Software Foundation.\n+ *\n+ * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED\n+ * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n+ * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED.  IN NO EVENT SHALL THE APACHE SOFTWARE FOUNDATION OR\n+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n+ * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF\n+ * USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n+ * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n+ * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n+ * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF\n+ * SUCH DAMAGE.\n+ * ====================================================================\n+ *\n+ * This software consists of voluntary contributions made by many\n+ * individuals on behalf of the Apache Software Foundation.  For more\n+ * information on the Apache Software Foundation, please see\n+ * <http://www.apache.org/>.\n+ */\n+package org.apache.commons.math;\n+\n+/**\n+ * Provide the Regula Falsi algorithm for solving for zeros of real univariate\n+ * functions. This is the same as the secant algorithm with mandatory bracketing,\n+ * hence the name. The real secant algorithm has a higher theoretical order of\n+ * convergence, but may easer run awry.\n+ * It will only search for one zero in the given interval.\n+ * The function is supposed to be continuous but not necessarily smooth.\n+ *  \n+ * @author pietsch at apache.org\n+ */\n+public class SecantSolver extends UnivariateRealSolverImpl {\n+\n+    private UnivariateRealFunction f;\n+\n+    public SecantSolver(UnivariateRealFunction f) {\n+        super(100, 1E-6);\n+        this.f = f;\n+    }\n+\n+    /* (non-Javadoc)\n+     * @see org.apache.commons.math.UnivariateRealSolver#solve(double, double)\n+     */\n+    public double solve(double min, double max) throws MathException {\n+        clearResult();\n+        double x0 = min;\n+        double x1 = max;\n+        double y0 = f.value(x0);\n+        double y1 = f.value(x1);\n+        boolean y0positive = y0 > 0;\n+        boolean y1positive = y1 > 0;\n+        if (y0positive == y1positive) {\n+            throw new MathException(\"Interval doesn't bracket a zero.\");\n+        }\n+        int i = 0;\n+        while (i < maximalIterationCount) {\n+            double x2 = x0 + (x0 - x1) / (y1 / y0 - 1);\n+            double y2 = f.value(x2);\n+            if (Math.abs(y2) <= functionValueAccuracy) {\n+                setResult(x2,i);\n+                return result;\n+            }\n+            boolean y2positive = y2 > 0;\n+            if (y0positive == y2positive) {\n+                // New bracket is (x2,x1).                    \n+                if (Math.abs(x1 - x2) < Math.max(relativeAccuracy * Math.abs ( x2 ), absoluteAccuracy)) {\n+                    setResult((x2 + (x2 - x1) / (y1 / y2 - 1) ), i);\n+                    return result;\n+                }\n+                x0 = x2;\n+                y0 = y2;\n+            } else {\n+                // New bracket is (x0,x2).                    \n+                if (Math.abs(x2 - x0) < Math.max(relativeAccuracy * Math.abs ( x2 ),\n+                    absoluteAccuracy)) {\n+                    setResult(x0 + (x0 - x2) / (y2 / y0 - 1), i);\n+                    return result;\n+                }\n+                x1 = x2;\n+                y1 = y2;\n+            }\n+            i++;\n+        }\n+        throw new MathException(\"Maximal iteration number exceeded\");\n+    }\n+        \n+}\n--- /dev/null\n+++ b/src/java/org/apache/commons/math/UnivariateRealFunction.java\n+/* ====================================================================\n+ * The Apache Software License, Version 1.1\n+ *\n+ * Copyright (c) 2003 The Apache Software Foundation.  All rights\n+ * reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions\n+ * are met:\n+ *\n+ * 1. Redistributions of source code must retain the above copyright\n+ *    notice, this list of conditions and the following disclaimer.\n+ *\n+ * 2. Redistributions in binary form must reproduce the above copyright\n+ *    notice, this list of conditions and the following disclaimer in\n+ *    the documentation and/or other materials provided with the\n+ *    distribution.\n+ *\n+ * 3. The end-user documentation included with the redistribution, if\n+ *    any, must include the following acknowlegement:\n+ *       \"This product includes software developed by the\n+ *        Apache Software Foundation (http://www.apache.org/).\"\n+ *    Alternately, this acknowlegement may appear in the software itself,\n+ *    if and wherever such third-party acknowlegements normally appear.\n+ *\n+ * 4. The names \"The Jakarta Project\", \"Commons\", and \"Apache Software\n+ *    Foundation\" must not be used to endorse or promote products derived\n+ *    from this software without prior written permission. For written\n+ *    permission, please contact apache@apache.org.\n+ *\n+ * 5. Products derived from this software may not be called \"Apache\"\n+ *    nor may \"Apache\" appear in their names without prior written\n+ *    permission of the Apache Software Foundation.\n+ *\n+ * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED\n+ * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n+ * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED.  IN NO EVENT SHALL THE APACHE SOFTWARE FOUNDATION OR\n+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n+ * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF\n+ * USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n+ * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n+ * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n+ * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF\n+ * SUCH DAMAGE.\n+ * ====================================================================\n+ *\n+ * This software consists of voluntary contributions made by many\n+ * individuals on behalf of the Apache Software Foundation.  For more\n+ * information on the Apache Software Foundation, please see\n+ * <http://www.apache.org/>.\n+ */\n+package org.apache.commons.math;\n+\n+/**\n+ * Provide an interface univariate real functions.\n+ * The object may held temporary data which is shared between calculations\n+ * of the value and the derivatives for the same argument. It is not guaranteed\n+ * that derivatives are evaluated after the value, the evaluation algorithm\n+ * should throw an InvalidStateException if it can't cope with this.\n+ *  \n+ * @author pietsch at apache.org\n+ */\n+public interface UnivariateRealFunction {\n+\n+    /**\n+     * Compute the value for the function.\n+     * @param x the point for which the function value should be computed\n+     * @return the value\n+     * @throws MathException if the function couldn't be computed due to\n+     *  missing additional data or other environmental problems.\n+     * @throws RuntimeException if the operation isn't supported, the argument\n+     *  was outside the supported domain or any other problem.\n+     * \n+     */\n+    public double value(double x) throws MathException;\n+\n+    /**\n+     * Compute the value for the first derivative of the function.\n+     * It is recommended to provide this method only if the first derivative is\n+     * analytical. Numerical derivatives may be acceptable in some cases.\n+     * An implementation should throw an UnsupportedOperationException if\n+     * this method is not implemented.\n+     * @param x the point for which the first derivative should be computed\n+     * @return the value\n+     * @throws MathException if the derivative couldn't be computed.\n+     * @throws RuntimeException if the operation isn't supported, the argument\n+     *  was outside the supported domain or any other problem.\n+     * \n+     */\n+    public double firstDerivative(double x) throws MathException;\n+\n+    /**\n+     * Compute the value for the second derivative of the function.\n+     * It is recommended to provide this method only if the second derivative is\n+     * analytical. Numerical derivatives may be acceptable in some cases.\n+     * An implementation should throw an UnsupportedOperationException if\n+     * this method is not implemented.\n+     * @param x the point for which the first derivative should be computed\n+     * @return the value\n+     * @throws MathException if the second derivative couldn't be computed.\n+     * @throws RuntimeException if the operation isn't supported, the argument\n+     *  was outside the supported domain or any other problem.\n+     * \n+     */\n+    public double secondDerivative(double x) throws MathException;\n+}\n--- /dev/null\n+++ b/src/java/org/apache/commons/math/UnivariateRealSolver.java\n+/* ====================================================================\n+ * The Apache Software License, Version 1.1\n+ *\n+ * Copyright (c) 2003 The Apache Software Foundation.  All rights\n+ * reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions\n+ * are met:\n+ *\n+ * 1. Redistributions of source code must retain the above copyright\n+ *    notice, this list of conditions and the following disclaimer.\n+ *\n+ * 2. Redistributions in binary form must reproduce the above copyright\n+ *    notice, this list of conditions and the following disclaimer in\n+ *    the documentation and/or other materials provided with the\n+ *    distribution.\n+ *\n+ * 3. The end-user documentation included with the redistribution, if\n+ *    any, must include the following acknowlegement:\n+ *       \"This product includes software developed by the\n+ *        Apache Software Foundation (http://www.apache.org/).\"\n+ *    Alternately, this acknowlegement may appear in the software itself,\n+ *    if and wherever such third-party acknowlegements normally appear.\n+ *\n+ * 4. The names \"The Jakarta Project\", \"Commons\", and \"Apache Software\n+ *    Foundation\" must not be used to endorse or promote products derived\n+ *    from this software without prior written permission. For written\n+ *    permission, please contact apache@apache.org.\n+ *\n+ * 5. Products derived from this software may not be called \"Apache\"\n+ *    nor may \"Apache\" appear in their names without prior written\n+ *    permission of the Apache Software Foundation.\n+ *\n+ * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED\n+ * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n+ * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED.  IN NO EVENT SHALL THE APACHE SOFTWARE FOUNDATION OR\n+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n+ * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF\n+ * USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n+ * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n+ * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n+ * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF\n+ * SUCH DAMAGE.\n+ * ====================================================================\n+ *\n+ * This software consists of voluntary contributions made by many\n+ * individuals on behalf of the Apache Software Foundation.  For more\n+ * information on the Apache Software Foundation, please see\n+ * <http://www.apache.org/>.\n+ */\n+package org.apache.commons.math;\n+\n+/**\n+ * Provide an interface to algorithms for solving for zeros of real univariate\n+ * functions.\n+ * An implementation will only search for one zero in the given interval.\n+ *  \n+ * @author pietsch at apache.org\n+ */\n+public interface UnivariateRealSolver {\n+\n+    /**\n+     * Set the upper limit for the number of iterations.\n+     * Usually a high iteration count indicates convergence problems. However,\n+     * the \"reasonable value\" varies widely for different solvers, users are\n+     * advised to use the default value supplied by the solver. \n+     * An exception will be thrown if the number is exceeded.\n+     *  \n+     * @param count\n+     */\n+    public void setMaximalIterationCount(int count);\n+\n+    /**\n+     * Get the upper limit for the number of iterations.\n+     * @return the actual upper limit\n+     */\n+    public int getMaximalIterationCount();\n+\n+    /**\n+     * Reset the upper limit for the number of iterations to the default.\n+     * The default value is supplied by the solver implementation.\n+     * \n+     * @see #setMaximalIterationCount(int)\n+     */\n+    public void resetMaximalIterationCount();\n+\n+    /**\n+     * Set the absolute accuracy.\n+     * The default is usually choosen so taht roots in the interval\n+     * -10..-0.1 and +0.1..+10 can be found wit a reasonable accuracy. If the expected\n+     * absolute value of your roots is of much smaller magnitude, set this to a smaller\n+     * value.\n+     * Solvers are advised to do a plausibility check with the relative accuracy, but\n+     * clients should not rely on this. \n+     * @param accuracy the accuracy.\n+     * @throws MathException if the accuracy can't be achieved by the solver or is\n+     * otherwise deemed unreasonable. \n+     */\n+    public void setAbsoluteAccuracy(double accuracy) throws MathException;\n+\n+    /**\n+     * Get the actual absolute accuracy.\n+     * @return the accuracy\n+     */\n+    public double getAbsoluteAccuracy();\n+\n+    /**\n+     * Reset the absolute accuracy to the default.\n+     * The default value is provided by the solver implementation.\n+     */\n+    public void resetAbsoluteAccuracy();\n+\n+    /**\n+     * Set the relative accuracy.\n+     * This is used to stop iterations if the absolute accuracy can't be achieved\n+     * due to large values or short mantissa length.\n+     * If this should be the primary criterium for convergence rather then a safety\n+     * measure, set the absolute accuracy to a ridiculously small value, like 1E-1000.\n+     * @param accuracy the relative accuracy.\n+     * @throws MathException if the accuracy can't be achieved by the solver or is\n+     * otherwise deemed unreasonable. \n+     */\n+    public void setRelativeAccuracy(double Accuracy) throws MathException;\n+\n+    /**\n+     * Get the actual relative accuracy.\n+     * @return the accuracy\n+     */\n+    public double getRelativeAccuracy();\n+\n+    /**\n+     * Reset the relative accuracy to the default.\n+     * The default value is provided by the solver implementation.\n+     */\n+    public void resetRelativeAccuracy();\n+\n+    /**\n+     * Set the function value accuracy.\n+     * This is used to determine whan an evaluated function value or some other\n+     * value which is used as divisor is zero.\n+     * This is a safety guard and it shouldn't be necesary to change this in general.\n+     * @param accuracy the accuracy.\n+     * @throws MathException if the accuracy can't be achieved by the solver or is\n+     * otherwise deemed unreasonable. \n+     */\n+    public void setFunctionValueAccuracy(double Accuracy) throws MathException;\n+\n+    /**\n+     * Get the actual function value accuracy.\n+     * @return the accuracy\n+     */\n+    public double getFunctionValueAccuracy();\n+\n+    /**\n+     * Reset the actual function accuracy to the default.\n+     * The default value is provided by the solver implementation.\n+     */\n+    public void resetFunctionValueAccuracy();\n+\n+    /**\n+     * Solve for a zero root in the given interval.\n+     * A solver may require that the interval brackets a single zero root.\n+     * @param min the lower bound for the interval.\n+     * @param max the upper bound for the interval.\n+     * @return the value where the function is zero\n+     * @throws MathException if the iteration count was exceeded or the\n+     *  solver detects convergence problems otherwise.\n+     */\n+    public double solve(double min, double max) throws MathException;\n+\n+    /**\n+     * Solve for a zero in the given interval, start at startValue.\n+     * A solver may require that the interval brackets a single zero root.\n+     * @param min the lower bound for the interval.\n+     * @param max the upper bound for the interval.\n+     * @param startValue the start value to use\n+     * @return the value where the function is zero\n+     * @throws MathException if the iteration count was exceeded or the\n+     *  solver detects convergence problems otherwise.\n+     */\n+    public double solve(double min, double max, double startValue)\n+        throws MathException;\n+\n+    /**\n+     * Get the result of the last run of the solver.\n+     * @return the last result.\n+     * @throws MathException if there is no result available, either\n+     * because no result was yet computed or the last attempt failed.\n+     */\n+    public double getResult() throws MathException;\n+\n+    /**\n+     * Get the number of iterations in the last run of the solver.\n+     * This is mainly meant for testing purposes. It may occasionally\n+     * help track down performance problems: if the iteration count\n+     * is notoriously high, check whether the function is evaluated\n+     * properly, and whether another solver is more amenable to the\n+     * problem.\n+     * @return the last iteration count.\n+     * @throws MathException if there is no result available, either\n+     * because no result was yet computed or the last attempt failed.\n+     */\n+    public double getIterationCount() throws MathException;\n+}\n--- /dev/null\n+++ b/src/java/org/apache/commons/math/UnivariateRealSolverFactory.java\n+/* ====================================================================\n+ * The Apache Software License, Version 1.1\n+ *\n+ * Copyright (c) 2003 The Apache Software Foundation.  All rights\n+ * reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions\n+ * are met:\n+ *\n+ * 1. Redistributions of source code must retain the above copyright\n+ *    notice, this list of conditions and the following disclaimer.\n+ *\n+ * 2. Redistributions in binary form must reproduce the above copyright\n+ *    notice, this list of conditions and the following disclaimer in\n+ *    the documentation and/or other materials provided with the\n+ *    distribution.\n+ *\n+ * 3. The end-user documentation included with the redistribution, if\n+ *    any, must include the following acknowlegement:\n+ *       \"This product includes software developed by the\n+ *        Apache Software Foundation (http://www.apache.org/).\"\n+ *    Alternately, this acknowlegement may appear in the software itself,\n+ *    if and wherever such third-party acknowlegements normally appear.\n+ *\n+ * 4. The names \"The Jakarta Project\", \"Commons\", and \"Apache Software\n+ *    Foundation\" must not be used to endorse or promote products derived\n+ *    from this software without prior written permission. For written\n+ *    permission, please contact apache@apache.org.\n+ *\n+ * 5. Products derived from this software may not be called \"Apache\"\n+ *    nor may \"Apache\" appear in their names without prior written\n+ *    permission of the Apache Software Foundation.\n+ *\n+ * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED\n+ * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n+ * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED.  IN NO EVENT SHALL THE APACHE SOFTWARE FOUNDATION OR\n+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n+ * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF\n+ * USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n+ * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n+ * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n+ * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF\n+ * SUCH DAMAGE.\n+ * ====================================================================\n+ *\n+ * This software consists of voluntary contributions made by many\n+ * individuals on behalf of the Apache Software Foundation.  For more\n+ * information on the Apache Software Foundation, please see\n+ * <http://www.apache.org/>.\n+ */\n+package org.apache.commons.math;\n+\n+import java.lang.reflect.InvocationTargetException;\n+\n+/**\n+ * @author pietsch at apache.org\n+ *\n+ * A factory to easily get a default solver and some convenience\n+ * functions.\n+ * Because solvers are easily reusable, the factory does not\n+ * store configuration data and creates preconfigured solvers\n+ * (this may be controversial, because the configuration data\n+ * may also be used for the default solver used by the static\n+ * solve() method).\n+ * \n+ */\n+public class UnivariateRealSolverFactory {\n+    protected UnivariateRealSolverFactory() {\n+    }\n+\n+    public static UnivariateRealSolver newSolver(UnivariateRealFunction f)\n+        throws MathConfigurationException {\n+        String solverClassName =\n+            System.getProperty(\n+                \"org.apache.commons.math.UnivariateRealSolver\",\n+                \"org.apache.commons.math.BrentSolver\");\n+        try {\n+            Class clazz = Class.forName(solverClassName);\n+            Class paramClass[] = new Class[1];\n+            paramClass[1] =\n+                Class.forName(\"org.apache.commons.math.UnivariateRealFunction\");\n+            Object param[] = new Object[1];\n+            param[1] = f;\n+            return (UnivariateRealSolver)clazz.getConstructor(\n+                paramClass).newInstance(\n+                param);\n+        } catch (IllegalArgumentException e) {\n+            throw new MathConfigurationException(e);\n+        } catch (SecurityException e) {\n+            throw new MathConfigurationException(\n+                \"Can't access \" + solverClassName,\n+                e);\n+        } catch (ClassNotFoundException e) {\n+            throw new MathConfigurationException(\n+                \"Class not found: \" + solverClassName,\n+                e);\n+        } catch (InstantiationException e) {\n+            throw new MathConfigurationException(\n+                \"Can't instantiate \" + solverClassName,\n+                e);\n+        } catch (IllegalAccessException e) {\n+            throw new MathConfigurationException(\n+                \"Can't access \" + solverClassName,\n+                e);\n+        } catch (InvocationTargetException e) {\n+            throw new MathConfigurationException(e);\n+        } catch (NoSuchMethodException e) {\n+            throw new MathConfigurationException(\n+                \"No constructor with UnivariateRealFunction in \"\n+                    + solverClassName,\n+                e);\n+        }\n+    }\n+\n+    public static double solve(UnivariateRealFunction f, double x0, double x1)\n+        throws MathException {\n+        return newSolver(f).solve(x0, x1);\n+    }\n+\n+    public static double solve(\n+        UnivariateRealFunction f,\n+        double x0,\n+        double x1,\n+        double absoluteAccuracy)\n+        throws MathException {\n+        UnivariateRealSolver solver = newSolver(f);\n+        solver.setAbsoluteAccuracy(absoluteAccuracy);\n+        return solver.solve(x0, x1);\n+    }\n+}\n--- /dev/null\n+++ b/src/java/org/apache/commons/math/UnivariateRealSolverImpl.java\n+/* ====================================================================\n+ * The Apache Software License, Version 1.1\n+ *\n+ * Copyright (c) 2003 The Apache Software Foundation.  All rights\n+ * reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions\n+ * are met:\n+ *\n+ * 1. Redistributions of source code must retain the above copyright\n+ *    notice, this list of conditions and the following disclaimer.\n+ *\n+ * 2. Redistributions in binary form must reproduce the above copyright\n+ *    notice, this list of conditions and the following disclaimer in\n+ *    the documentation and/or other materials provided with the\n+ *    distribution.\n+ *\n+ * 3. The end-user documentation included with the redistribution, if\n+ *    any, must include the following acknowlegement:\n+ *       \"This product includes software developed by the\n+ *        Apache Software Foundation (http://www.apache.org/).\"\n+ *    Alternately, this acknowlegement may appear in the software itself,\n+ *    if and wherever such third-party acknowlegements normally appear.\n+ *\n+ * 4. The names \"The Jakarta Project\", \"Commons\", and \"Apache Software\n+ *    Foundation\" must not be used to endorse or promote products derived\n+ *    from this software without prior written permission. For written\n+ *    permission, please contact apache@apache.org.\n+ *\n+ * 5. Products derived from this software may not be called \"Apache\"\n+ *    nor may \"Apache\" appear in their names without prior written\n+ *    permission of the Apache Software Foundation.\n+ *\n+ * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED\n+ * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n+ * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED.  IN NO EVENT SHALL THE APACHE SOFTWARE FOUNDATION OR\n+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n+ * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF\n+ * USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n+ * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n+ * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n+ * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF\n+ * SUCH DAMAGE.\n+ * ====================================================================\n+ *\n+ * This software consists of voluntary contributions made by many\n+ * individuals on behalf of the Apache Software Foundation.  For more\n+ * information on the Apache Software Foundation, please see\n+ * <http://www.apache.org/>.\n+ */\n+\n+package org.apache.commons.math;\n+\n+/**\n+ * Provide a default implementation for several functions useful to generic\n+ * solvers.\n+ *  \n+ * @author pietsch at apache.org\n+ */\n+public abstract class UnivariateRealSolverImpl\n+    implements UnivariateRealSolver {\n+\n+    protected double absoluteAccuracy;\n+    protected double relativeAccuracy;\n+    protected double functionValueAccuracy;\n+    protected int maximalIterationCount;\n+\n+    protected double defaultAbsoluteAccuracy;\n+    protected double defaultRelativeAccuracy;\n+    protected double defaultFunctionValueAccuracy;\n+    protected int defaultMaximalIterationCount;\n+\n+    protected boolean resultComputed = false;\n+    protected double result;\n+    // Mainly for test framework.\n+    protected int iterationCount;\n+\n+    protected UnivariateRealSolverImpl(\n+        int defaultMaximalIterationCount,\n+        double defaultAbsoluteAccuracy) {\n+        this.defaultAbsoluteAccuracy = defaultAbsoluteAccuracy;\n+        this.defaultRelativeAccuracy = 1E-14;\n+        this.defaultFunctionValueAccuracy = 1E-15;\n+        this.absoluteAccuracy = defaultAbsoluteAccuracy;\n+        this.relativeAccuracy = defaultRelativeAccuracy;\n+        this.functionValueAccuracy = defaultFunctionValueAccuracy;\n+        this.defaultMaximalIterationCount = defaultMaximalIterationCount;\n+        this.maximalIterationCount = defaultMaximalIterationCount;\n+    }\n+\n+    /* (non-Javadoc)\n+     * @see org.apache.commons.math.UnivariateRealSolver#solve(double, double)\n+     */\n+    public double solve(double min, double max) throws MathException {\n+        throw new UnsupportedOperationException();\n+    }\n+\n+    /* (non-Javadoc)\n+     * @see org.apache.commons.math.UnivariateRealSolver#solve(double, double, double)\n+     */\n+    public double solve(double min, double max, double startValue)\n+        throws MathException {\n+        throw new UnsupportedOperationException();\n+    }\n+\n+    /*\n+     * Get result of last solver run.\n+     * @see org.apache.commons.math.UnivariateRealSolver#getResult()\n+     */\n+    public double getResult() throws MathException {\n+        if (resultComputed) {\n+            return result;\n+        } else {\n+            throw new MathException(\"No result available\");\n+        }\n+    }\n+\n+    /* (non-Javadoc)\n+     * @see org.apache.commons.math.UnivariateRealSolver#getIterationCount()\n+     */\n+    public double getIterationCount() throws MathException {\n+        if (resultComputed) {\n+            return iterationCount;\n+        } else {\n+            throw new MathException(\"No result available\");\n+        }\n+    }\n+\n+    /*\n+     * Convenience function for implementations.\n+     * @param result the result to set\n+     * @param iteratinCount the iteration count to set\n+     */\n+    protected final void setResult(double result, int iterationCount) {\n+        this.result = result;\n+        this.iterationCount = iterationCount;\n+        this.resultComputed = true;\n+    }\n+\n+    /*\n+     * Convenience function for implementations.\n+     */\n+    protected final void clearResult() {\n+        this.resultComputed = false;\n+    }\n+\n+    /* (non-Javadoc)\n+     * @see org.apache.commons.math.UnivariateRealSolver#setAccuracy(double)\n+     */\n+    public void setAbsoluteAccuracy(double accuracy)\n+        throws MathException {\n+        absoluteAccuracy = accuracy;\n+    }\n+\n+    /* (non-Javadoc)\n+     * @see org.apache.commons.math.UnivariateRealSolver#getAccuracy()\n+     */\n+    public double getAbsoluteAccuracy() {\n+        return absoluteAccuracy;\n+    }\n+\n+    /* (non-Javadoc)\n+     * @see org.apache.commons.math.UnivariateRealSolver#resetAbsoluteAccuracy()\n+     */\n+    public void resetAbsoluteAccuracy() {\n+        absoluteAccuracy = defaultAbsoluteAccuracy;\n+    }\n+\n+    /* Set maximum iteration count.\n+     * @see org.apache.commons.math.UnivariateRealSolver#setMaximalIterationCount(int)\n+     */\n+    public void setMaximalIterationCount(int count) {\n+        maximalIterationCount = count;\n+    }\n+\n+    /* (non-Javadoc)\n+     * @see org.apache.commons.math.UnivariateRealSolver#getMaximalIterationCount()\n+     */\n+    public int getMaximalIterationCount() {\n+        return maximalIterationCount;\n+    }\n+\n+    /* (non-Javadoc)\n+     * @see org.apache.commons.math.UnivariateRealSolver#resetMaximalIterationCount()\n+     */\n+    public void resetMaximalIterationCount() {\n+        maximalIterationCount = defaultMaximalIterationCount;\n+    }\n+\n+    /* (non-Javadoc)\n+     * @see org.apache.commons.math.UnivariateRealSolver#setRelativeAccuracy(double)\n+     */\n+    public void setRelativeAccuracy(double accuracy) throws MathException {\n+        relativeAccuracy = accuracy;\n+    }\n+\n+    /* (non-Javadoc)\n+     * @see org.apache.commons.math.UnivariateRealSolver#getRelativeAccuracy()\n+     */\n+    public double getRelativeAccuracy() {\n+        return relativeAccuracy;\n+    }\n+\n+    /* (non-Javadoc)\n+     * @see org.apache.commons.math.UnivariateRealSolver#resetRelativeAccuracy()\n+     */\n+    public void resetRelativeAccuracy() {\n+        relativeAccuracy = defaultRelativeAccuracy;\n+    }\n+\n+    /* (non-Javadoc)\n+     * @see org.apache.commons.math.UnivariateRealSolver#setFunctionValueAccuracy(double)\n+     */\n+    public void setFunctionValueAccuracy(double accuracy)\n+        throws MathException {\n+        functionValueAccuracy = accuracy;\n+    }\n+\n+    /* (non-Javadoc)\n+     * @see org.apache.commons.math.UnivariateRealSolver#getFunctionValueAccuracy()\n+     */\n+    public double getFunctionValueAccuracy() {\n+        return functionValueAccuracy;\n+    }\n+\n+    /* (non-Javadoc)\n+     * @see org.apache.commons.math.UnivariateRealSolver#resetFunctionValueAccuracy()\n+     */\n+    public void resetFunctionValueAccuracy() {\n+        functionValueAccuracy = defaultFunctionValueAccuracy;\n+    }\n+\n+}\n--- /dev/null\n+++ b/src/test/org/apache/commons/math/QuinticFunction.java\n+/* ====================================================================\n+ * The Apache Software License, Version 1.1\n+ *\n+ * Copyright (c) 2003 The Apache Software Foundation.  All rights\n+ * reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions\n+ * are met:\n+ *\n+ * 1. Redistributions of source code must retain the above copyright\n+ *    notice, this list of conditions and the following disclaimer.\n+ *\n+ * 2. Redistributions in binary form must reproduce the above copyright\n+ *    notice, this list of conditions and the following disclaimer in\n+ *    the documentation and/or other materials provided with the\n+ *    distribution.\n+ *\n+ * 3. The end-user documentation included with the redistribution, if\n+ *    any, must include the following acknowlegement:\n+ *       \"This product includes software developed by the\n+ *        Apache Software Foundation (http://www.apache.org/).\"\n+ *    Alternately, this acknowlegement may appear in the software itself,\n+ *    if and wherever such third-party acknowlegements normally appear.\n+ *\n+ * 4. The names \"The Jakarta Project\", \"Commons\", and \"Apache Software\n+ *    Foundation\" must not be used to endorse or promote products derived\n+ *    from this software without prior written permission. For written\n+ *    permission, please contact apache@apache.org.\n+ *\n+ * 5. Products derived from this software may not be called \"Apache\"\n+ *    nor may \"Apache\" appear in their names without prior written\n+ *    permission of the Apache Software Foundation.\n+ *\n+ * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED\n+ * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n+ * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED.  IN NO EVENT SHALL THE APACHE SOFTWARE FOUNDATION OR\n+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n+ * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF\n+ * USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n+ * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n+ * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n+ * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF\n+ * SUCH DAMAGE.\n+ * ====================================================================\n+ *\n+ * This software consists of voluntary contributions made by many\n+ * individuals on behalf of the Apache Software Foundation.  For more\n+ * information on the Apache Software Foundation, please see\n+ * <http://www.apache.org/>.\n+ */\n+package org.apache.commons.math;\n+\n+/**\n+ * Auxillary class for testing solvers.\n+ * \n+ * @author pietsch at apache.org\n+ *\n+ */\n+public class QuinticFunction implements UnivariateRealFunction {\n+\n+    /* Evaluate quintic.\n+     * @see org.apache.commons.math.UnivariateRealFunction#value(double)\n+     */\n+    public double value(double x) throws MathException {\n+        return (x-1)*(x-0.5)*x*(x+0.5)*(x+1);\n+    }\n+\n+    /* First derivative of quintic.\n+     * @see org.apache.commons.math.UnivariateRealFunction#firstDerivative(double)\n+     */\n+    public double firstDerivative(double x) throws MathException {\n+        return (5*x*x-3.75)*x*x+0.25;\n+    }\n+\n+    /* Second order derivative of quintic.\n+     * Unsupported.\n+     * @see org.apache.commons.math.UnivariateRealFunction#secondDerivative(double)\n+     */\n+    public double secondDerivative(double x) throws MathException {\n+        throw new UnsupportedOperationException();\n+    }\n+\n+}\n--- /dev/null\n+++ b/src/test/org/apache/commons/math/RealSolverTest.java\n+/* ====================================================================\n+ * The Apache Software License, Version 1.1\n+ *\n+ * Copyright (c) 2003 The Apache Software Foundation.  All rights\n+ * reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions\n+ * are met:\n+ *\n+ * 1. Redistributions of source code must retain the above copyright\n+ *    notice, this list of conditions and the following disclaimer.\n+ *\n+ * 2. Redistributions in binary form must reproduce the above copyright\n+ *    notice, this list of conditions and the following disclaimer in\n+ *    the documentation and/or other materials provided with the\n+ *    distribution.\n+ *\n+ * 3. The end-user documentation included with the redistribution, if\n+ *    any, must include the following acknowlegement:\n+ *       \"This product includes software developed by the\n+ *        Apache Software Foundation (http://www.apache.org/).\"\n+ *    Alternately, this acknowlegement may appear in the software itself,\n+ *    if and wherever such third-party acknowlegements normally appear.\n+ *\n+ * 4. The names \"The Jakarta Project\", \"Commons\", and \"Apache Software\n+ *    Foundation\" must not be used to endorse or promote products derived\n+ *    from this software without prior written permission. For written\n+ *    permission, please contact apache@apache.org.\n+ *\n+ * 5. Products derived from this software may not be called \"Apache\"\n+ *    nor may \"Apache\" appear in their names without prior written\n+ *    permission of the Apache Software Foundation.\n+ *\n+ * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED\n+ * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n+ * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED.  IN NO EVENT SHALL THE APACHE SOFTWARE FOUNDATION OR\n+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n+ * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF\n+ * USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n+ * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n+ * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n+ * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF\n+ * SUCH DAMAGE.\n+ * ====================================================================\n+ *\n+ * This software consists of voluntary contributions made by many\n+ * individuals on behalf of the Apache Software Foundation.  For more\n+ * information on the Apache Software Foundation, please see\n+ * <http://www.apache.org/>.\n+ */\n+package org.apache.commons.math;\n+\n+import junit.framework.Assert;\n+import junit.framework.Test;\n+import junit.framework.TestCase;\n+import junit.framework.TestSuite;\n+\n+/**\n+ * @author pietsch at apache.org\n+ *\n+ * Testcase for UnivariateRealSolver.\n+ * \n+ */\n+public final class RealSolverTest extends TestCase {\n+\n+    public RealSolverTest(String name) {\n+        super(name);\n+    }\n+\n+    public static Test suite() {\n+        TestSuite suite = new TestSuite(RealSolverTest.class);\n+        suite.setName(\"UnivariateRealSolver Tests\");\n+        return suite;\n+    }\n+\n+    public void testSinZero() throws MathException {\n+        UnivariateRealFunction f = new SinFunction();\n+        double result;\n+        UnivariateRealSolver solver = new BrentSolver(f);\n+        result = solver.solve(3, 4);\n+        Assert.assertEquals(result, Math.PI, solver.getAbsoluteAccuracy());\n+        solver = new SecantSolver(f);\n+        result = solver.solve(3, 4);\n+        Assert.assertEquals(result, Math.PI, solver.getAbsoluteAccuracy());\n+    }\n+\n+    public void testQuinticZero() throws MathException {\n+        UnivariateRealFunction f = new QuinticFunction();\n+        double result;\n+        UnivariateRealSolver solver = new BrentSolver(f);\n+        // symmetric bracket around 0\n+        result = solver.solve(-0.2, 0.2);\n+        Assert.assertEquals(result, 0, solver.getAbsoluteAccuracy());\n+        // asymmetric bracket around 0\n+        result = solver.solve(-0.2, 0.4);\n+        Assert.assertEquals(result, 0, solver.getAbsoluteAccuracy());\n+        // symmetric bracket around 0.5\n+        result = solver.solve(0.2, 0.8);\n+        Assert.assertEquals(result, 0.5, solver.getAbsoluteAccuracy());\n+        // asymmetric bracket around 0.5\n+        result = solver.solve(0.2, 0.6);\n+        Assert.assertEquals(result, 0.5, solver.getAbsoluteAccuracy());\n+        // symmetric bracket around 1\n+        result = solver.solve(0.6, 1.4);\n+        Assert.assertEquals(result, 1.0, solver.getAbsoluteAccuracy());\n+        // asymmetric bracket around 1\n+        result = solver.solve(0.7, 2.4);\n+        Assert.assertEquals(result, 1.0, solver.getAbsoluteAccuracy());\n+        solver = new SecantSolver(f);\n+        // symmetric bracket around 0\n+        result = solver.solve(-0.2, 0.2);\n+        Assert.assertEquals(result, 0, solver.getAbsoluteAccuracy());\n+        // asymmetric bracket around 0\n+        result = solver.solve(-0.2, 0.4);\n+        Assert.assertEquals(result, 0, solver.getAbsoluteAccuracy());\n+        // symmetric bracket around 0.5\n+        result = solver.solve(0.2, 0.8);\n+        Assert.assertEquals(result, 0.5, solver.getAbsoluteAccuracy());\n+        // asymmetric bracket around 0.5\n+        result = solver.solve(0.2, 0.6);\n+        Assert.assertEquals(result, 0.5, solver.getAbsoluteAccuracy());\n+        // symmetric bracket around 1\n+        result = solver.solve(0.6, 1.4);\n+        Assert.assertEquals(result, 1.0, solver.getAbsoluteAccuracy());\n+        // asymmetric bracket around 1\n+        result = solver.solve(0.7, 2.4);\n+        Assert.assertEquals(result, 1.0, solver.getAbsoluteAccuracy());\n+        // Static solve method\n+        // symmetric bracket around 0\n+        result = UnivariateRealSolverFactory.solve(f,-0.2, 0.2);\n+        Assert.assertEquals(result, 0, solver.getAbsoluteAccuracy());\n+        // asymmetric bracket around 0\n+        result = UnivariateRealSolverFactory.solve(f,-0.2, 0.4);\n+        Assert.assertEquals(result, 0, solver.getAbsoluteAccuracy());\n+        // symmetric bracket around 0.5\n+        result = UnivariateRealSolverFactory.solve(f,0.2, 0.8);\n+        Assert.assertEquals(result, 0.5, solver.getAbsoluteAccuracy());\n+        // asymmetric bracket around 0.5\n+        result = UnivariateRealSolverFactory.solve(f,0.2, 0.6);\n+        Assert.assertEquals(result, 0.5, solver.getAbsoluteAccuracy());\n+        // symmetric bracket around 1\n+        result = UnivariateRealSolverFactory.solve(f,0.6, 1.4);\n+        Assert.assertEquals(result, 1.0, solver.getAbsoluteAccuracy());\n+        // asymmetric bracket around 1\n+        result = UnivariateRealSolverFactory.solve(f,0.7, 2.4);\n+        Assert.assertEquals(result, 1.0, solver.getAbsoluteAccuracy());\n+    }\n+}\n--- /dev/null\n+++ b/src/test/org/apache/commons/math/SinFunction.java\n+/* ====================================================================\n+ * The Apache Software License, Version 1.1\n+ *\n+ * Copyright (c) 2003 The Apache Software Foundation.  All rights\n+ * reserved.\n+ *\n+ * Redistribution and use in source and binary forms, with or without\n+ * modification, are permitted provided that the following conditions\n+ * are met:\n+ *\n+ * 1. Redistributions of source code must retain the above copyright\n+ *    notice, this list of conditions and the following disclaimer.\n+ *\n+ * 2. Redistributions in binary form must reproduce the above copyright\n+ *    notice, this list of conditions and the following disclaimer in\n+ *    the documentation and/or other materials provided with the\n+ *    distribution.\n+ *\n+ * 3. The end-user documentation included with the redistribution, if\n+ *    any, must include the following acknowlegement:\n+ *       \"This product includes software developed by the\n+ *        Apache Software Foundation (http://www.apache.org/).\"\n+ *    Alternately, this acknowlegement may appear in the software itself,\n+ *    if and wherever such third-party acknowlegements normally appear.\n+ *\n+ * 4. The names \"The Jakarta Project\", \"Commons\", and \"Apache Software\n+ *    Foundation\" must not be used to endorse or promote products derived\n+ *    from this software without prior written permission. For written\n+ *    permission, please contact apache@apache.org.\n+ *\n+ * 5. Products derived from this software may not be called \"Apache\"\n+ *    nor may \"Apache\" appear in their names without prior written\n+ *    permission of the Apache Software Foundation.\n+ *\n+ * THIS SOFTWARE IS PROVIDED ``AS IS'' AND ANY EXPRESSED OR IMPLIED\n+ * WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES\n+ * OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n+ * DISCLAIMED.  IN NO EVENT SHALL THE APACHE SOFTWARE FOUNDATION OR\n+ * ITS CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,\n+ * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT\n+ * LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF\n+ * USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n+ * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n+ * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT\n+ * OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF\n+ * SUCH DAMAGE.\n+ * ====================================================================\n+ *\n+ * This software consists of voluntary contributions made by many\n+ * individuals on behalf of the Apache Software Foundation.  For more\n+ * information on the Apache Software Foundation, please see\n+ * <http://www.apache.org/>.\n+ */\n+package org.apache.commons.math;\n+\n+/**\n+ * Auxillary class for testing solvers.\n+ *\n+ * The function is extraordinarily well behaved around zero roots: it\n+ * has an inflection point there (second order derivative is zero),\n+ * which means linear approximation (Regula Falsi) will converge\n+ * quadratically.\n+ * \n+ * @author pietsch at apache.org\n+ *\n+ */\n+public class SinFunction implements UnivariateRealFunction {\n+\n+    /* Evaluate sinus fuction.\n+     * @see org.apache.commons.math.UnivariateRealFunction#value(double)\n+     */\n+    public double value(double x) throws MathException {\n+        return Math.sin(x);\n+    }\n+\n+    /* First derivative of sinus function\n+     * @see org.apache.commons.math.UnivariateRealFunction#firstDerivative(double)\n+     */\n+    public double firstDerivative(double x) throws MathException {\n+        return Math.cos(x);\n+    }\n+\n+    /* Second derivative of sinus function.\n+     * Unsupported.\n+     * @see org.apache.commons.math.UnivariateRealFunction#secondDerivative(double)\n+     */\n+    public double secondDerivative(double x) throws MathException {\n+        throw new UnsupportedOperationException();\n+    }\n+\n+}", "timestamp": 1055884568, "metainfo": ""}