{"sha": "8dadbe008fda795fd622128d764b151e82a603f2", "log": "fixed a problem preventing integration stop when end time was exactly 0  ", "commit": "\n--- a/src/java/org/apache/commons/math/ode/AbstractIntegrator.java\n+++ b/src/java/org/apache/commons/math/ode/AbstractIntegrator.java\n      * <p>This method can be used to simplify handling of integration end time.\n      * It leverages the nominal stop condition with the exceptional stop\n      * conditions.</p>\n+     * @param startTime integration start time\n      * @param endTime desired end time\n      * @param manager manager containing the user-defined handlers\n      * @return a new manager containing all the user-defined handlers plus a\n      * dedicated manager triggering a stop event at entTime\n      */\n-    protected CombinedEventsManager addEndTimeChecker(final double endTime,\n+    protected CombinedEventsManager addEndTimeChecker(final double startTime,\n+                                                      final double endTime,\n                                                       final CombinedEventsManager manager) {\n         CombinedEventsManager newManager = new CombinedEventsManager();\n         for (final EventState state : manager.getEventsStates()) {\n                                        state.getMaxIterationCount());\n         }\n         newManager.addEventHandler(new EndTimeChecker(endTime),\n-                                   Double.POSITIVE_INFINITY, Math.ulp(endTime), 10);\n+                                   Double.POSITIVE_INFINITY,\n+                                   Math.ulp(Math.max(Math.abs(startTime), Math.abs(endTime))),\n+                                   100);\n         return newManager;\n     }\n \n--- a/src/java/org/apache/commons/math/ode/nonstiff/EmbeddedRungeKuttaIntegrator.java\n+++ b/src/java/org/apache/commons/math/ode/nonstiff/EmbeddedRungeKuttaIntegrator.java\n     for (StepHandler handler : stepHandlers) {\n         handler.reset();\n     }\n-    CombinedEventsManager manager = addEndTimeChecker(t, eventsHandlersManager);\n+    CombinedEventsManager manager = addEndTimeChecker(t0, t, eventsHandlersManager);\n     boolean lastStep = false;\n \n     // main integration loop\n--- a/src/java/org/apache/commons/math/ode/nonstiff/RungeKuttaIntegrator.java\n+++ b/src/java/org/apache/commons/math/ode/nonstiff/RungeKuttaIntegrator.java\n     for (StepHandler handler : stepHandlers) {\n         handler.reset();\n     }\n-    CombinedEventsManager manager = addEndTimeChecker(t, eventsHandlersManager);\n+    CombinedEventsManager manager = addEndTimeChecker(t0, t, eventsHandlersManager);\n     boolean lastStep = false;\n \n     // main integration loop", "timestamp": 1216048356, "metainfo": ""}