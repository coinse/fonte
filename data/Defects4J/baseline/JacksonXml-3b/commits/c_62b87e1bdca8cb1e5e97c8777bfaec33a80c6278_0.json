{"sha": "62b87e1bdca8cb1e5e97c8777bfaec33a80c6278", "log": "Fixes #81. Requires FasterXML/jackson-databind#394 to compile.", "commit": "\n--- a/src/main/java/com/fasterxml/jackson/dataformat/xml/ser/XmlBeanSerializer.java\n+++ b/src/main/java/com/fasterxml/jackson/dataformat/xml/ser/XmlBeanSerializer.java\n import com.fasterxml.jackson.databind.ser.BeanSerializer;\n import com.fasterxml.jackson.databind.ser.PropertyFilter;\n import com.fasterxml.jackson.databind.ser.impl.ObjectIdWriter;\n+import com.fasterxml.jackson.databind.ser.impl.WritableObjectId;\n import com.fasterxml.jackson.databind.ser.std.BeanSerializerBase;\n import com.fasterxml.jackson.databind.util.NameTransformer;\n import com.fasterxml.jackson.dataformat.xml.util.XmlInfo;\n             TypeSerializer typeSer)\n         throws IOException, JsonGenerationException\n     {\n+        if (_objectIdWriter != null) {\n+            _serializeWithObjectId(bean, jgen, provider, typeSer);\n+            return;\n+        }\n+\n         /* Ok: let's serialize type id as attribute, but if (and only if!)\n          * we are using AS_PROPERTY\n          */\n         }\n     }\n     \n+    @Override\n+    protected void _serializeObjectId(Object bean,\n+                                      JsonGenerator jgen,\n+                                      SerializerProvider provider,\n+                                      TypeSerializer typeSer,\n+                                      WritableObjectId objectId) throws IOException, JsonProcessingException,\n+            JsonGenerationException {\n+        /* Ok: let's serialize type id as attribute, but if (and only if!)\n+         * we are using AS_PROPERTY\n+         */\n+        if (typeSer.getTypeInclusion() == JsonTypeInfo.As.PROPERTY) {\n+            ToXmlGenerator xgen = (ToXmlGenerator)jgen;\n+            xgen.setNextIsAttribute(true);\n+            super._serializeObjectId(bean, jgen, provider, typeSer, objectId);\n+            if (_attributeCount == 0) { // if no attributes, need to reset\n+                xgen.setNextIsAttribute(false);\n+            }\n+        } else {\n+            super._serializeObjectId(bean, jgen, provider, typeSer, objectId);\n+        }\n+    }\n+\n     /*\n     /**********************************************************\n     /* Helper methods", "timestamp": 1390924295, "metainfo": ""}