{"sha": "c8606251c904dfaf5303f71b788e12f7fff15fab", "log": "Fixed the handling of unrecognized options starting with '-' by PosixParser (CLI-164)  ", "commit": "\n--- a/src/java/org/apache/commons/cli/PosixParser.java\n+++ b/src/java/org/apache/commons/cli/PosixParser.java\n             // single hyphen\n             else if (\"-\".equals(token))\n             {\n-                processSingleHyphen(token);\n+                tokens.add(token);\n             }\n             else if (token.startsWith(\"-\"))\n             {\n-                int tokenLength = token.length();\n-\n-                if (tokenLength == 2)\n+                if (token.length() == 2)\n                 {\n                     processOptionToken(token, stopAtNonOption);\n                 }\n                     burstToken(token, stopAtNonOption);\n                 }\n             }\n+            else if (stopAtNonOption)\n+            {\n+                process(token);\n+            }\n             else\n             {\n-                if (stopAtNonOption)\n-                {\n-                    process(token);\n-                }\n-                else\n-                {\n-                    tokens.add(token);\n-                }\n+                tokens.add(token);\n             }\n \n             gobble(iter);\n     }\n \n     /**\n-     * If it is a hyphen then add the hyphen directly to\n-     * the processed tokens list.\n-     *\n-     * @param hyphen The hyphen token\n-     */\n-    private void processSingleHyphen(String hyphen)\n-    {\n-        tokens.add(hyphen);\n-    }\n-\n-    /**\n      * <p>If an {@link Option} exists for <code>token</code> then\n      * set the current option and add the token to the processed \n      * list.</p>\n      */\n     private void processOptionToken(String token, boolean stopAtNonOption)\n     {\n-        if (this.options.hasOption(token))\n-        {\n-            currentOption = this.options.getOption(token);\n+        if (options.hasOption(token))\n+        {\n+            currentOption = options.getOption(token);\n             tokens.add(token);\n         }\n         else if (stopAtNonOption)\n         {\n             eatTheRest = true;\n+            tokens.add(token);\n         }\n     }\n \n--- a/src/test/org/apache/commons/cli/PosixParserTest.java\n+++ b/src/test/org/apache/commons/cli/PosixParserTest.java\n         assertTrue( \"Confirm  2 extra args: \" + cl.getArgList().size(), cl.getArgList().size() == 2);\n     }\n \n+    public void testStop2() throws Exception\n+    {\n+        String[] args = new String[]{\"-z\",\n+                                     \"-a\",\n+                                     \"-btoast\"};\n+\n+        CommandLine cl = parser.parse(options, args, true);\n+        assertFalse(\"Confirm -a is not set\", cl.hasOption(\"a\"));\n+        assertTrue(\"Confirm  3 extra args: \" + cl.getArgList().size(), cl.getArgList().size() == 3);\n+    }\n+\n     public void testStopBursting() throws Exception\n     {\n         String[] args = new String[] { \"-azc\" };", "timestamp": 1217233666, "metainfo": ""}