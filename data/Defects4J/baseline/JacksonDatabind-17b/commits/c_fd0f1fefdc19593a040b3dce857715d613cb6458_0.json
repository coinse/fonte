{"sha": "fd0f1fefdc19593a040b3dce857715d613cb6458", "log": "Fix #515", "commit": "\n--- a/src/main/java/com/fasterxml/jackson/databind/introspect/AnnotatedClass.java\n+++ b/src/main/java/com/fasterxml/jackson/databind/introspect/AnnotatedClass.java\n     extends Annotated\n {\n     private final static AnnotationMap[] NO_ANNOTATION_MAPS = new AnnotationMap[0];\n-    \n+\n     /*\n     /**********************************************************\n     /* Configuration\n                      * just placeholder, can't be called)\n                      */\n                 } else {\n-                    mixIns.add(_constructMethod(m));\n+                    // Well, or, as per [Issue#515], multi-level merge within mixins...\n+                    am = mixIns.find(m);\n+                    if (am != null) {\n+                        _addMixUnders(m, am);\n+                    } else {\n+                        mixIns.add(_constructMethod(m));\n+                    }\n                 }\n             }\n         }\n--- /dev/null\n+++ b/src/test/java/com/fasterxml/jackson/databind/introspect/TestMixinMerging.java\n+package com.fasterxml.jackson.databind.introspect;\n+\n+import com.fasterxml.jackson.annotation.JsonProperty;\n+\n+import com.fasterxml.jackson.databind.*;\n+import com.fasterxml.jackson.databind.module.SimpleModule;\n+\n+public class TestMixinMerging extends BaseMapTest\n+{\n+    public interface Contact {\n+        String getCity();\n+    }\n+\n+    static class ContactImpl implements Contact {\n+        public String getCity() { return \"Seattle\"; }\n+    }\n+\n+    static class ContactMixin implements Contact {\n+        @JsonProperty\n+        public String getCity() { return null; }\n+    }\n+\n+    public interface Person extends Contact {}\n+\n+    static class PersonImpl extends ContactImpl implements Person {}\n+\n+    static class PersonMixin extends ContactMixin implements Person {}\n+\n+    /*\n+    /**********************************************************\n+    /* Unit tests\n+    /**********************************************************\n+     */\n+    \n+    // for [Issue#515]\n+    public void testDisappearingMixins515() throws Exception\n+    {\n+        ObjectMapper mapper = new ObjectMapper();\n+        mapper.disable(MapperFeature.ALLOW_FINAL_FIELDS_AS_MUTATORS)\n+            .disable(MapperFeature.AUTO_DETECT_FIELDS)\n+            .disable(MapperFeature.AUTO_DETECT_GETTERS)\n+            .disable(MapperFeature.AUTO_DETECT_IS_GETTERS)\n+            .disable(MapperFeature.INFER_PROPERTY_MUTATORS);\n+        SimpleModule module = new SimpleModule(\"Test\");\n+        module.setMixInAnnotation(Person.class, PersonMixin.class);        \n+        mapper.registerModule(module);\n+\n+        assertEquals(\"{\\\"city\\\":\\\"Seattle\\\"}\", mapper.writeValueAsString(new PersonImpl()));\n+    }\n+}", "timestamp": 1407971044, "metainfo": ""}