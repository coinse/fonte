{"sha": "00734226f07e57a2d13f82a4b395b4bb7b9ee20b", "log": "Output HTML correctly for <! ... > and <? ... ?> xml tags.", "commit": "\n--- a/src/main/java/org/jsoup/nodes/XmlDeclaration.java\n+++ b/src/main/java/org/jsoup/nodes/XmlDeclaration.java\n  @author Jonathan Hedley, jonathan@hedley.net */\n public class XmlDeclaration extends Node {\n     private static final String DECL_KEY = \"declaration\";\n+    private final boolean isProcessingInstruction; // <! if true, <? if false, declaration (and last data char should be ?)\n \n-    public XmlDeclaration(String data, String baseUri) {\n+    public XmlDeclaration(String data, String baseUri, boolean isProcessingInstruction) {\n         super(baseUri);\n         attributes.put(DECL_KEY, data);\n+        this.isProcessingInstruction = isProcessingInstruction;\n     }\n \n     public String nodeName() {\n         return attributes.get(DECL_KEY);\n     }\n \n-    // TODO: this munged <! and <? -- not really correct or useful\n     public String outerHtml() {\n-        return String.format(\"<? %s >\", getWholeDeclaration());\n+        return String.format(\"<%s%s>\", isProcessingInstruction ? \"!\" : \"?\", getWholeDeclaration());\n     }\n \n     public String toString() {\n--- a/src/main/java/org/jsoup/parser/Parser.java\n+++ b/src/main/java/org/jsoup/parser/Parser.java\n     }\n \n     private void parseXmlDecl() {\n-        tq.consume(\"<\"); tq.consume(); // <? or <!, from initial match.\n+        tq.consume(\"<\");\n+        Character firstChar = tq.consume(); // <? or <!, from initial match.\n+        boolean procInstr = firstChar.toString().equals(\"!\");\n         String data = tq.chompTo(\">\");\n \n-        XmlDeclaration decl = new XmlDeclaration(data, baseUri);\n+        XmlDeclaration decl = new XmlDeclaration(data, baseUri, procInstr);\n         last().addChild(decl);\n     }\n \n             return;\n         }\n \n-\n         Attributes attributes = new Attributes();\n-\n-\n         while (!tq.matchesAny(\"<\", \"/>\", \">\") && !tq.isEmpty()) {\n             Attribute attribute = parseAttribute();\n             if (attribute != null)", "timestamp": 1309605103, "metainfo": ""}