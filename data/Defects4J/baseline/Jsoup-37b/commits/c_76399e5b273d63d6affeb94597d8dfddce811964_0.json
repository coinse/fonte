{"sha": "76399e5b273d63d6affeb94597d8dfddce811964", "log": "Fixed an issue where elements added via the adoption agency algorithm did not preserve their attributes.  Fixes #313", "commit": "\n--- a/src/main/java/org/jsoup/parser/HtmlTreeBuilderState.java\n+++ b/src/main/java/org/jsoup/parser/HtmlTreeBuilderState.java\n                                 commonAncestor.appendChild(lastNode);\n                             }\n \n-                            Element adopter = new Element(Tag.valueOf(name), tb.getBaseUri());\n+                            Element adopter = new Element(formatEl.tag(), tb.getBaseUri());\n+                            adopter.attributes().addAll(formatEl.attributes());\n                             Node[] childNodes = furthestBlock.childNodes().toArray(new Node[furthestBlock.childNodeSize()]);\n                             for (Node childNode : childNodes) {\n                                 adopter.appendChild(childNode); // append will reparent. thus the clone to avoid concurrent mod.\n--- a/src/test/java/org/jsoup/parser/HtmlParserTest.java\n+++ b/src/test/java/org/jsoup/parser/HtmlParserTest.java\n                 \"</body>\\n\" +\n                 \"</html>\";\n         assertEquals(want, doc.html());\n+    }\n+\n+    @Test public void handlesUnclosedAnchors() {\n+        String h = \"<a href='http://example.com/'>Link<p>Error link</a>\";\n+        Document doc = Jsoup.parse(h);\n+        String want = \"<a href=\\\"http://example.com/\\\">Link</a>\\n<p><a href=\\\"http://example.com/\\\">Error link</a></p>\";\n+        assertEquals(want, doc.body().html());\n     }\n \n     @Test public void reconstructFormattingElements() {", "timestamp": 1381101652, "metainfo": ""}