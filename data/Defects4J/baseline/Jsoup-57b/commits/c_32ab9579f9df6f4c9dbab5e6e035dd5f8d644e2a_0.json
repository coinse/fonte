{"sha": "32ab9579f9df6f4c9dbab5e6e035dd5f8d644e2a", "log": "Fix issue with invalid document when script tag is whitelisted", "commit": "\n--- a/src/main/java/org/jsoup/safety/Cleaner.java\n+++ b/src/main/java/org/jsoup/safety/Cleaner.java\n                 TextNode sourceText = (TextNode) source;\n                 TextNode destText = new TextNode(sourceText.getWholeText(), source.baseUri());\n                 destination.appendChild(destText);\n+            } else if (source instanceof DataNode && whitelist.isSafeTag(source.parent().nodeName())) {\n+              DataNode sourceData = (DataNode) source;\n+              DataNode destData = new DataNode(sourceData.getWholeData(), source.baseUri());\n+              destination.appendChild(destData);\n             } else { // else, we don't care about comments, xml proc instructions, etc\n                 numDiscarded++;\n             }\n--- a/src/test/java/org/jsoup/safety/CleanerTest.java\n+++ b/src/test/java/org/jsoup/safety/CleanerTest.java\n     @Test public void cleansInternationalText() {\n         assertEquals(\"\u043f\u0440\u0438\u0432\u0435\u0442\", Jsoup.clean(\"\u043f\u0440\u0438\u0432\u0435\u0442\", Whitelist.none()));\n     }\n+\n+    @Test\n+    public void testScriptTagInWhiteList() {\n+        Whitelist whitelist = Whitelist.relaxed();\n+        whitelist.addTags( \"script\" );\n+        assertTrue( Jsoup.isValid(\"Hello<script>alert('Doh')</script>World !\", whitelist ) );\n+    }\n }", "timestamp": 1389895023, "metainfo": ""}