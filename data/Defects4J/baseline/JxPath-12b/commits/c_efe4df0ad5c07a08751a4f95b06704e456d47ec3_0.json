{"sha": "efe4df0ad5c07a08751a4f95b06704e456d47ec3", "log": "Incorporated test case from bug report 13380   ", "commit": "\n--- a/src/test/org/apache/commons/jxpath/JXPathTest.java\n+++ b/src/test/org/apache/commons/jxpath/JXPathTest.java\n /*\n- * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//jxpath/src/test/org/apache/commons/jxpath/Attic/JXPathTest.java,v 1.1 2002/10/13 03:01:03 dmitri Exp $\n- * $Revision: 1.1 $\n- * $Date: 2002/10/13 03:01:03 $\n+ * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//jxpath/src/test/org/apache/commons/jxpath/Attic/JXPathTest.java,v 1.2 2002/10/13 03:25:48 dmitri Exp $\n+ * $Revision: 1.2 $\n+ * $Date: 2002/10/13 03:25:48 $\n  *\n  * ====================================================================\n  * The Apache Software License, Version 1.1\n  * </p>\n  *\n  * @author Dmitri Plotnikov\n- * @version $Revision: 1.1 $ $Date: 2002/10/13 03:01:03 $\n+ * @version $Revision: 1.2 $ $Date: 2002/10/13 03:25:48 $\n  */\n \n public class JXPathTest extends TestCase\n             actual.add(((Pointer)it.next()).getValue());\n         }\n         assertEquals(\"Iterating <\" + \"beans/int\" + \">\", list(new Integer(5), new Integer(6)), actual);\n+    }\n+\n+    public void testIteratePointerSetValue() {\n+        JXPathContext context = JXPathContext.newContext(bean);\n+\n+        testGetValue(context, \"/beans[1]/name\", \"Name 1\");\n+        testGetValue(context, \"/beans[2]/name\", \"Name 2\");\n+\n+        // Test setting via context\n+        context.setValue(\"/beans[2]/name\", \"Name 2 set\");\n+        testGetValue(context, \"/beans[2]/name\", \"Name 2 set\");\n+\n+        // Restore original value\n+        context.setValue(\"/beans[2]/name\", \"Name 2\");\n+        testGetValue(context, \"/beans[2]/name\", \"Name 2\");\n+\n+        int iter_count = 0;\n+        Iterator iter = context.iteratePointers(\"/beans/name\");\n+        while (iter.hasNext()) {\n+            iter_count++;\n+            Pointer pointer = (Pointer) iter.next();\n+            String s = (String) pointer.getValue();\n+            s = s + \"suffix\";\n+            pointer.setValue(s);\n+            assertEquals(\"pointer.getValue\", s, pointer.getValue());\n+            // fails right here, the value isn't getting set in the bean.\n+            assertEquals(\"context.getValue\", s, context.getValue(pointer.asPath()));\n+        }\n+        assertEquals(\"Iteration count\", 2, iter_count);\n+\n+        testGetValue(context, \"/beans[1]/name\", \"Name 1suffix\");\n+        testGetValue(context, \"/beans[2]/name\", \"Name 2suffix\");\n     }\n \n     /**\n--- a/src/test/org/apache/commons/jxpath/NestedTestBean.java\n+++ b/src/test/org/apache/commons/jxpath/NestedTestBean.java\n /*\n- * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//jxpath/src/test/org/apache/commons/jxpath/NestedTestBean.java,v 1.3 2002/04/12 02:28:06 dmitri Exp $\n- * $Revision: 1.3 $\n- * $Date: 2002/04/12 02:28:06 $\n+ * $Header: /home/jerenkrantz/tmp/commons/commons-convert/cvs/home/cvs/jakarta-commons//jxpath/src/test/org/apache/commons/jxpath/NestedTestBean.java,v 1.4 2002/10/13 03:25:48 dmitri Exp $\n+ * $Revision: 1.4 $\n+ * $Date: 2002/10/13 03:25:48 $\n  *\n  * ====================================================================\n  * The Apache Software License, Version 1.1\n  * A general purpose JavaBean for JUnit tests for the \"jxpath\" component.\n  *\n  * @author Dmitri Plotnikov\n- * @version $Revision: 1.3 $ $Date: 2002/04/12 02:28:06 $\n+ * @version $Revision: 1.4 $ $Date: 2002/10/13 03:25:48 $\n  */\n public class NestedTestBean {\n     private String name = \"Name 0\";\n     }\n \n     public NestedTestBean(String name){\n+        this.name = name;\n+    }\n+\n+    public void setName(String name){\n         this.name = name;\n     }\n ", "timestamp": 1034479548, "metainfo": ""}