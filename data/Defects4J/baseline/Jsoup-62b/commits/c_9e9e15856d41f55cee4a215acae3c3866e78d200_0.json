{"sha": "9e9e15856d41f55cee4a215acae3c3866e78d200", "log": "Don't parse <img> as <image> when in <svg>  Fixes #364", "commit": "\n--- a/src/main/java/org/jsoup/parser/HtmlTreeBuilderState.java\n+++ b/src/main/java/org/jsoup/parser/HtmlTreeBuilderState.java\n                         tb.insertEmpty(startTag);\n                         tb.framesetOk(false);\n                     } else if (name.equals(\"image\")) {\n-                        // we're not supposed to ask.\n-                        startTag.name(\"img\");\n-                        return tb.process(startTag);\n+                        if (tb.getFromStack(\"svg\") == null)\n+                            return tb.process(startTag.name(\"img\")); // change <image> to <img>, unless in svg\n+                        else\n+                            tb.insert(startTag);\n                     } else if (name.equals(\"isindex\")) {\n                         // how much do we care about the early 90s?\n                         tb.error(this);\n--- a/src/test/java/org/jsoup/parser/HtmlParserTest.java\n+++ b/src/test/java/org/jsoup/parser/HtmlParserTest.java\n         assertEquals(1, doc.select(\"table input\").size());\n         assertEquals(2, doc.select(\"input\").size());\n     }\n+\n+    @Test public void convertsImageToImg() {\n+        // image to img, unless in a svg. old html cruft.\n+        String h = \"<body><image><svg><image /></svg></body>\";\n+        Document doc = Jsoup.parse(h);\n+        assertEquals(\"<img />\\n<svg>\\n <image />\\n</svg>\", doc.body().html());\n+    }\n }", "timestamp": 1384650751, "metainfo": ""}