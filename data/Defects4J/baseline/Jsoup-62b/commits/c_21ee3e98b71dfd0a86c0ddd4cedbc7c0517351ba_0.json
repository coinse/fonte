{"sha": "21ee3e98b71dfd0a86c0ddd4cedbc7c0517351ba", "log": "Reset base URI on parse start  Fixes #440", "commit": "\n--- a/src/main/java/org/jsoup/parser/HtmlTreeBuilder.java\n+++ b/src/main/java/org/jsoup/parser/HtmlTreeBuilder.java\n     @Override\n     Document parse(String input, String baseUri, ParseErrorList errors) {\n         state = HtmlTreeBuilderState.Initial;\n+        baseUriSetFromDoc = false;\n         return super.parse(input, baseUri, errors);\n     }\n \n--- a/src/test/java/org/jsoup/integration/UrlConnectTest.java\n+++ b/src/test/java/org/jsoup/integration/UrlConnectTest.java\n         assertEquals(\"ISO-8859-1\", res.charset());\n     }\n \n+    @Test\n+    public void baseHrefCorrectAfterHttpEquiv() throws IOException {\n+        // https://github.com/jhy/jsoup/issues/440\n+        Connection.Response res = Jsoup.connect(\"http://direct.infohound.net/tools/charset-base.html\").execute();\n+        Document doc = res.parse();\n+        assertEquals(\"http://example.com/foo.jpg\", doc.select(\"img\").first().absUrl(\"src\"));\n+    }\n+\n }", "timestamp": 1411860075, "metainfo": ""}